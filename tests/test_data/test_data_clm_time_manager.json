{
  "function_name": "clm_time_manager",
  "test_cases": [
    {
      "name": "test_nominal_gregorian_midyear",
      "inputs": {
        "state": {
          "dtstep": 1800,
          "itim": 240,
          "start_date_ymd": 20000101,
          "start_date_tod": 0,
          "curr_date_ymd": 20000106,
          "curr_date_tod": 0,
          "calkindflag": "GREGORIAN"
        },
        "year": 2000,
        "calendar": "GREGORIAN",
        "offset": 0
      },
      "metadata": {
        "type": "nominal",
        "description": "Typical mid-simulation state with 30-minute timestep, leap year 2000, 5 days elapsed",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_noleap_calendar",
      "inputs": {
        "state": {
          "dtstep": 3600,
          "itim": 100,
          "start_date_ymd": 19790315,
          "start_date_tod": 43200,
          "curr_date_ymd": 19790319,
          "curr_date_tod": 7200,
          "calkindflag": "NOLEAP"
        },
        "year": 1979,
        "calendar": "NOLEAP",
        "offset": -7200
      },
      "metadata": {
        "type": "nominal",
        "description": "NOLEAP calendar with 1-hour timestep, mid-March, noon start time, negative offset",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_end_of_day",
      "inputs": {
        "state": {
          "dtstep": 900,
          "itim": 96,
          "start_date_ymd": 20240701,
          "start_date_tod": 0,
          "curr_date_ymd": 20240701,
          "curr_date_tod": 86400,
          "calkindflag": "GREGORIAN"
        },
        "year": 2024,
        "calendar": "GREGORIAN",
        "offset": null
      },
      "metadata": {
        "type": "nominal",
        "description": "15-minute timestep ending exactly at midnight (86400 seconds), tests day boundary",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_end_of_month",
      "inputs": {
        "state": {
          "dtstep": 1800,
          "itim": 1488,
          "start_date_ymd": 20001201,
          "start_date_tod": 0,
          "curr_date_ymd": 20001231,
          "curr_date_tod": 86400,
          "calkindflag": "GREGORIAN"
        },
        "year": 2000,
        "calendar": "GREGORIAN",
        "offset": 0
      },
      "metadata": {
        "type": "nominal",
        "description": "End of December (month and year boundary), leap year",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_february_leap",
      "inputs": {
        "state": {
          "dtstep": 600,
          "itim": 4176,
          "start_date_ymd": 20000201,
          "start_date_tod": 0,
          "curr_date_ymd": 20000229,
          "curr_date_tod": 0,
          "calkindflag": "GREGORIAN"
        },
        "year": 2000,
        "calendar": "GREGORIAN",
        "offset": -600
      },
      "metadata": {
        "type": "nominal",
        "description": "February 29th in leap year 2000, 10-minute timestep",
        "edge_cases": []
      }
    },
    {
      "name": "test_edge_first_timestep",
      "inputs": {
        "state": {
          "dtstep": 1800,
          "itim": 0,
          "start_date_ymd": 19000101,
          "start_date_tod": 0,
          "curr_date_ymd": 19000101,
          "curr_date_tod": 0,
          "calkindflag": "GREGORIAN"
        },
        "year": 1900,
        "calendar": "GREGORIAN",
        "offset": 0
      },
      "metadata": {
        "type": "edge",
        "description": "Initial timestep (itim=0), year 1900 (not leap despite divisible by 4), start of simulation",
        "edge_cases": [
          "zero_timestep",
          "century_year_not_leap"
        ]
      }
    },
    {
      "name": "test_edge_minimum_timestep",
      "inputs": {
        "state": {
          "dtstep": 1,
          "itim": 86400,
          "start_date_ymd": 20200101,
          "start_date_tod": 0,
          "curr_date_ymd": 20200102,
          "curr_date_tod": 0,
          "calkindflag": "GREGORIAN"
        },
        "year": 2020,
        "calendar": "GREGORIAN",
        "offset": 0
      },
      "metadata": {
        "type": "edge",
        "description": "Minimum timestep of 1 second, exactly one day elapsed (86400 steps)",
        "edge_cases": [
          "minimum_timestep",
          "exact_day_boundary"
        ]
      }
    },
    {
      "name": "test_edge_year_boundaries",
      "inputs": {
        "state": {
          "dtstep": 3600,
          "itim": 8760,
          "start_date_ymd": 19990101,
          "start_date_tod": 0,
          "curr_date_ymd": 20000101,
          "curr_date_tod": 0,
          "calkindflag": "GREGORIAN"
        },
        "year": 1999,
        "calendar": "GREGORIAN",
        "offset": 0
      },
      "metadata": {
        "type": "edge",
        "description": "Year boundary transition from 1999 to 2000, exactly 365 days elapsed",
        "edge_cases": [
          "year_boundary",
          "millennium_transition"
        ]
      }
    },
    {
      "name": "test_edge_maximum_tod",
      "inputs": {
        "state": {
          "dtstep": 1800,
          "itim": 48,
          "start_date_ymd": 20150815,
          "start_date_tod": 86399,
          "curr_date_ymd": 20150816,
          "curr_date_tod": 86399,
          "calkindflag": "NOLEAP"
        },
        "year": 2015,
        "calendar": "NOLEAP",
        "offset": 0
      },
      "metadata": {
        "type": "edge",
        "description": "Maximum time-of-day value (86399 seconds = 23:59:59), NOLEAP calendar",
        "edge_cases": [
          "maximum_tod",
          "day_boundary_minus_one"
        ]
      }
    },
    {
      "name": "test_special_jax_array_years",
      "inputs": {
        "years_array": [
          1900,
          2000,
          2004,
          2100,
          2400,
          1999,
          2001,
          1600,
          1700,
          1800
        ],
        "calendar": "GREGORIAN",
        "state": {
          "dtstep": 21600,
          "itim": 1460,
          "start_date_ymd": 20160101,
          "start_date_tod": 0,
          "curr_date_ymd": 20161231,
          "curr_date_tod": 86400,
          "calkindflag": "GREGORIAN"
        },
        "offset": -21600
      },
      "metadata": {
        "type": "special",
        "description": "JAX array of diverse years testing leap year logic: century years (1900, 2000, 2100), 400-divisible (2400), regular leap (2004), non-leap (1999, 2001), historical centuries",
        "edge_cases": [
          "century_years",
          "400_divisible",
          "array_input"
        ]
      }
    }
  ],
  "notes": "Test data generation assumptions:\n\n1. **TimeManagerState consistency**: curr_date_ymd and curr_date_tod are calculated based on start_date + (itim * dtstep), ensuring internal consistency.\n\n2. **Physical realism**: \n   - dtstep ranges from 1 second (minimum) to 21600 seconds (6 hours, typical for climate models)\n   - All dates are valid calendar dates\n   - tod values are in [0, 86400] range\n   - Years span from 1600 to 2400 to test various leap year rules\n\n3. **Leap year logic tested**:\n   - Regular leap years (divisible by 4): 2000, 2004, 2020, 2024\n   - Century non-leap years (divisible by 100 but not 400): 1900, 2100, 1700, 1800\n   - 400-divisible leap years: 2000, 1600, 2400\n   - Non-leap years: 1979, 1999, 2001, 2015\n\n4. **Calendar types**: Both GREGORIAN and NOLEAP calendars tested\n\n5. **Boundary conditions**:\n   - First timestep (itim=0)\n   - End of day (tod=86400)\n   - End of month (December 31, February 29)\n   - Year transitions\n   - Maximum tod value (86399)\n\n6. **Offset values**: Tested with null (current time), 0 (current time), and negative values (past time) as per constraints\n\n7. **Array dimensions**: Test case 10 includes a 1D array of 10 years for testing isleap_jax function\n\n8. **Timestep calculations**: itim values calculated to produce specific elapsed times:\n   - Test 1: 240 steps * 1800s = 5 days\n   - Test 6: 0 steps (initial)\n   - Test 7: 86400 steps * 1s = 1 day\n   - Test 8: 8760 steps * 3600s = 365 days\n\n9. **Date format**: start_date_ymd and curr_date_ymd use yyyymmdd integer format (e.g., 20000101 for Jan 1, 2000)\n\n10. **Coverage**: Tests cover all function signatures including state-based queries, leap year checks (scalar and array), date/time retrieval, and state creation/advancement."
}
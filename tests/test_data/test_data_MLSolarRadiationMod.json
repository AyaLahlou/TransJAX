{
  "function_name": "solar_radiation",
  "test_cases": [
    {
      "name": "test_nominal_single_patch_midday",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "patch_state": {
          "itype": [
            5
          ],
          "cosz": [
            0.866
          ],
          "swskyb": [
            [
              800.0,
              600.0
            ]
          ],
          "swskyd": [
            [
              200.0,
              150.0
            ]
          ],
          "albsoib": [
            [
              0.15,
              0.25
            ]
          ],
          "albsoid": [
            [
              0.2,
              0.3
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              0.5,
              0.8,
              1.2,
              0.9,
              0.6
            ]
          ],
          "dsai_profile": [
            [
              0.1,
              0.15,
              0.2,
              0.15,
              0.1
            ]
          ],
          "dpai_profile": [
            [
              0.6,
              0.95,
              1.4,
              1.05,
              0.7
            ]
          ],
          "ntop_canopy": [
            0
          ],
          "nbot_canopy": [
            4
          ],
          "ncan_canopy": [
            5
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.08,
              0.4
            ],
            [
              0.12,
              0.5
            ],
            [
              0.09,
              0.42
            ],
            [
              0.11,
              0.48
            ],
            [
              0.1,
              0.45
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.04,
              0.22
            ],
            [
              0.06,
              0.28
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.26
            ],
            [
              0.05,
              0.25
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.15,
              0.38
            ],
            [
              0.17,
              0.4
            ],
            [
              0.16,
              0.39
            ],
            [
              0.16,
              0.39
            ],
            [
              0.16,
              0.39
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            -0.1,
            0.1,
            0.0,
            0.05,
            0.01
          ],
          "clump_fac": [
            0.85,
            0.8,
            0.9,
            0.85,
            0.87,
            0.85
          ]
        },
        "nlevmlcan": 5,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "nominal",
        "description": "Typical midday conditions with moderate LAI, single patch, Norman radiation transfer",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_multiple_patches_varied_lai",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 3,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 3,
        "filter_indices": [
          0,
          1,
          2
        ],
        "patch_state": {
          "itype": [
            2,
            5,
            8
          ],
          "cosz": [
            0.707,
            0.866,
            0.5
          ],
          "swskyb": [
            [
              700.0,
              550.0
            ],
            [
              850.0,
              650.0
            ],
            [
              600.0,
              450.0
            ]
          ],
          "swskyd": [
            [
              180.0,
              140.0
            ],
            [
              220.0,
              170.0
            ],
            [
              160.0,
              120.0
            ]
          ],
          "albsoib": [
            [
              0.12,
              0.22
            ],
            [
              0.18,
              0.28
            ],
            [
              0.14,
              0.24
            ]
          ],
          "albsoid": [
            [
              0.17,
              0.27
            ],
            [
              0.23,
              0.33
            ],
            [
              0.19,
              0.29
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              0.3,
              0.5,
              0.7,
              0.5,
              0.3
            ],
            [
              0.8,
              1.2,
              1.5,
              1.0,
              0.6
            ],
            [
              0.2,
              0.3,
              0.4,
              0.3,
              0.2
            ]
          ],
          "dsai_profile": [
            [
              0.05,
              0.08,
              0.12,
              0.08,
              0.05
            ],
            [
              0.15,
              0.22,
              0.28,
              0.18,
              0.12
            ],
            [
              0.03,
              0.05,
              0.07,
              0.05,
              0.03
            ]
          ],
          "dpai_profile": [
            [
              0.35,
              0.58,
              0.82,
              0.58,
              0.35
            ],
            [
              0.95,
              1.42,
              1.78,
              1.18,
              0.72
            ],
            [
              0.23,
              0.35,
              0.47,
              0.35,
              0.23
            ]
          ],
          "ntop_canopy": [
            0,
            0,
            0
          ],
          "nbot_canopy": [
            4,
            4,
            4
          ],
          "ncan_canopy": [
            5,
            5,
            5
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.08,
              0.4
            ],
            [
              0.1,
              0.45
            ],
            [
              0.12,
              0.5
            ],
            [
              0.09,
              0.42
            ],
            [
              0.11,
              0.48
            ],
            [
              0.1,
              0.45
            ],
            [
              0.07,
              0.38
            ],
            [
              0.13,
              0.52
            ],
            [
              0.09,
              0.43
            ]
          ],
          "taul": [
            [
              0.04,
              0.22
            ],
            [
              0.05,
              0.25
            ],
            [
              0.06,
              0.28
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.26
            ],
            [
              0.05,
              0.25
            ],
            [
              0.04,
              0.2
            ],
            [
              0.07,
              0.3
            ],
            [
              0.05,
              0.23
            ]
          ],
          "rhos": [
            [
              0.15,
              0.38
            ],
            [
              0.16,
              0.39
            ],
            [
              0.17,
              0.4
            ],
            [
              0.16,
              0.39
            ],
            [
              0.16,
              0.39
            ],
            [
              0.16,
              0.39
            ],
            [
              0.14,
              0.37
            ],
            [
              0.18,
              0.41
            ],
            [
              0.15,
              0.38
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            -0.1,
            0.01,
            0.1,
            0.0,
            0.05,
            0.01,
            -0.15,
            0.15,
            0.02
          ],
          "clump_fac": [
            0.8,
            0.85,
            0.9,
            0.85,
            0.87,
            0.85,
            0.75,
            0.92,
            0.83
          ]
        },
        "nlevmlcan": 5,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "nominal",
        "description": "Multiple patches with varying LAI (sparse, moderate, dense canopies) and different PFT types",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_twostream_method",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 2,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "patch_state": {
          "itype": [
            3,
            7
          ],
          "cosz": [
            0.8,
            0.6
          ],
          "swskyb": [
            [
              750.0,
              580.0
            ],
            [
              680.0,
              520.0
            ]
          ],
          "swskyd": [
            [
              190.0,
              145.0
            ],
            [
              175.0,
              135.0
            ]
          ],
          "albsoib": [
            [
              0.16,
              0.26
            ],
            [
              0.14,
              0.24
            ]
          ],
          "albsoid": [
            [
              0.21,
              0.31
            ],
            [
              0.19,
              0.29
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              0.6,
              0.9,
              1.3,
              0.9,
              0.5
            ],
            [
              0.4,
              0.7,
              1.0,
              0.7,
              0.4
            ]
          ],
          "dsai_profile": [
            [
              0.12,
              0.18,
              0.25,
              0.18,
              0.1
            ],
            [
              0.08,
              0.14,
              0.2,
              0.14,
              0.08
            ]
          ],
          "dpai_profile": [
            [
              0.72,
              1.08,
              1.55,
              1.08,
              0.6
            ],
            [
              0.48,
              0.84,
              1.2,
              0.84,
              0.48
            ]
          ],
          "ntop_canopy": [
            0,
            0
          ],
          "nbot_canopy": [
            4,
            4
          ],
          "ncan_canopy": [
            5,
            5
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.09,
              0.43
            ],
            [
              0.11,
              0.47
            ],
            [
              0.1,
              0.45
            ],
            [
              0.08,
              0.41
            ],
            [
              0.12,
              0.49
            ],
            [
              0.1,
              0.44
            ],
            [
              0.09,
              0.42
            ],
            [
              0.11,
              0.46
            ]
          ],
          "taul": [
            [
              0.045,
              0.23
            ],
            [
              0.055,
              0.27
            ],
            [
              0.05,
              0.25
            ],
            [
              0.04,
              0.21
            ],
            [
              0.06,
              0.29
            ],
            [
              0.05,
              0.24
            ],
            [
              0.045,
              0.22
            ],
            [
              0.055,
              0.26
            ]
          ],
          "rhos": [
            [
              0.155,
              0.385
            ],
            [
              0.165,
              0.395
            ],
            [
              0.16,
              0.39
            ],
            [
              0.15,
              0.38
            ],
            [
              0.17,
              0.4
            ],
            [
              0.16,
              0.39
            ],
            [
              0.155,
              0.385
            ],
            [
              0.165,
              0.395
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            -0.05,
            0.08,
            0.01,
            -0.12,
            0.12,
            0.03,
            -0.08,
            0.1
          ],
          "clump_fac": [
            0.82,
            0.88,
            0.85,
            0.78,
            0.91,
            0.86,
            0.81,
            0.89
          ]
        },
        "nlevmlcan": 5,
        "light_type": 2,
        "numrad": 2
      },
      "metadata": {
        "type": "nominal",
        "description": "Testing TwoStream radiation transfer method with moderate canopy conditions",
        "edge_cases": []
      }
    },
    {
      "name": "test_edge_zero_solar_zenith_angle",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 2,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "patch_state": {
          "itype": [
            4,
            6
          ],
          "cosz": [
            0.0,
            0.001
          ],
          "swskyb": [
            [
              0.0,
              0.0
            ],
            [
              5.0,
              3.0
            ]
          ],
          "swskyd": [
            [
              50.0,
              40.0
            ],
            [
              55.0,
              42.0
            ]
          ],
          "albsoib": [
            [
              0.15,
              0.25
            ],
            [
              0.16,
              0.26
            ]
          ],
          "albsoid": [
            [
              0.2,
              0.3
            ],
            [
              0.21,
              0.31
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              0.5,
              0.8,
              1.1,
              0.8,
              0.5
            ],
            [
              0.6,
              0.9,
              1.2,
              0.9,
              0.6
            ]
          ],
          "dsai_profile": [
            [
              0.1,
              0.15,
              0.2,
              0.15,
              0.1
            ],
            [
              0.12,
              0.17,
              0.22,
              0.17,
              0.12
            ]
          ],
          "dpai_profile": [
            [
              0.6,
              0.95,
              1.3,
              0.95,
              0.6
            ],
            [
              0.72,
              1.07,
              1.42,
              1.07,
              0.72
            ]
          ],
          "ntop_canopy": [
            0,
            0
          ],
          "nbot_canopy": [
            4,
            4
          ],
          "ncan_canopy": [
            5,
            5
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.09,
              0.43
            ],
            [
              0.11,
              0.47
            ],
            [
              0.1,
              0.44
            ],
            [
              0.1,
              0.46
            ],
            [
              0.09,
              0.44
            ],
            [
              0.11,
              0.46
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.045,
              0.23
            ],
            [
              0.055,
              0.27
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.26
            ],
            [
              0.045,
              0.24
            ],
            [
              0.055,
              0.26
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.155,
              0.385
            ],
            [
              0.165,
              0.395
            ],
            [
              0.16,
              0.39
            ],
            [
              0.16,
              0.39
            ],
            [
              0.155,
              0.385
            ],
            [
              0.165,
              0.395
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            -0.05,
            0.08,
            0.02,
            0.04,
            -0.03,
            0.06
          ],
          "clump_fac": [
            0.85,
            0.82,
            0.88,
            0.86,
            0.87,
            0.83,
            0.89
          ]
        },
        "nlevmlcan": 5,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "edge",
        "description": "Near-horizon sun (dawn/dusk) with zero or near-zero cosine of solar zenith angle",
        "edge_cases": [
          "zero_cosz",
          "minimal_direct_beam"
        ]
      }
    },
    {
      "name": "test_edge_maximum_solar_zenith",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "patch_state": {
          "itype": [
            5
          ],
          "cosz": [
            1.0
          ],
          "swskyb": [
            [
              1000.0,
              750.0
            ]
          ],
          "swskyd": [
            [
              100.0,
              75.0
            ]
          ],
          "albsoib": [
            [
              0.1,
              0.2
            ]
          ],
          "albsoid": [
            [
              0.15,
              0.25
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              0.7,
              1.0,
              1.4,
              1.0,
              0.7
            ]
          ],
          "dsai_profile": [
            [
              0.14,
              0.2,
              0.28,
              0.2,
              0.14
            ]
          ],
          "dpai_profile": [
            [
              0.84,
              1.2,
              1.68,
              1.2,
              0.84
            ]
          ],
          "ntop_canopy": [
            0
          ],
          "nbot_canopy": [
            4
          ],
          "ncan_canopy": [
            5
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.09,
              0.43
            ],
            [
              0.11,
              0.47
            ],
            [
              0.1,
              0.44
            ],
            [
              0.1,
              0.46
            ],
            [
              0.09,
              0.44
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.045,
              0.23
            ],
            [
              0.055,
              0.27
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.26
            ],
            [
              0.045,
              0.24
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.155,
              0.385
            ],
            [
              0.165,
              0.395
            ],
            [
              0.16,
              0.39
            ],
            [
              0.16,
              0.39
            ],
            [
              0.155,
              0.385
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            -0.05,
            0.08,
            0.02,
            0.04,
            -0.03
          ],
          "clump_fac": [
            0.85,
            0.82,
            0.88,
            0.86,
            0.87,
            0.83
          ]
        },
        "nlevmlcan": 5,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "edge",
        "description": "Solar noon with sun directly overhead (cosz = 1.0), maximum direct beam radiation",
        "edge_cases": [
          "maximum_cosz",
          "maximum_direct_beam"
        ]
      }
    },
    {
      "name": "test_edge_zero_lai_bare_ground",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "patch_state": {
          "itype": [
            0
          ],
          "cosz": [
            0.7
          ],
          "swskyb": [
            [
              650.0,
              500.0
            ]
          ],
          "swskyd": [
            [
              170.0,
              130.0
            ]
          ],
          "albsoib": [
            [
              0.25,
              0.35
            ]
          ],
          "albsoid": [
            [
              0.3,
              0.4
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "dsai_profile": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "dpai_profile": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "ntop_canopy": [
            0
          ],
          "nbot_canopy": [
            0
          ],
          "ncan_canopy": [
            0
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.0
          ],
          "clump_fac": [
            1.0
          ]
        },
        "nlevmlcan": 5,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "edge",
        "description": "Bare ground with zero LAI/SAI/PAI - all radiation reaches soil directly",
        "edge_cases": [
          "zero_lai",
          "bare_ground",
          "no_canopy"
        ]
      }
    },
    {
      "name": "test_edge_very_dense_canopy",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "patch_state": {
          "itype": [
            5
          ],
          "cosz": [
            0.75
          ],
          "swskyb": [
            [
              800.0,
              600.0
            ]
          ],
          "swskyd": [
            [
              200.0,
              150.0
            ]
          ],
          "albsoib": [
            [
              0.12,
              0.22
            ]
          ],
          "albsoid": [
            [
              0.17,
              0.27
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              2.0,
              2.5,
              3.0,
              2.5,
              2.0
            ]
          ],
          "dsai_profile": [
            [
              0.4,
              0.5,
              0.6,
              0.5,
              0.4
            ]
          ],
          "dpai_profile": [
            [
              2.4,
              3.0,
              3.6,
              3.0,
              2.4
            ]
          ],
          "ntop_canopy": [
            0
          ],
          "nbot_canopy": [
            4
          ],
          "ncan_canopy": [
            5
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.09,
              0.43
            ],
            [
              0.11,
              0.47
            ],
            [
              0.1,
              0.44
            ],
            [
              0.1,
              0.46
            ],
            [
              0.09,
              0.44
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.045,
              0.23
            ],
            [
              0.055,
              0.27
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.26
            ],
            [
              0.045,
              0.24
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.155,
              0.385
            ],
            [
              0.165,
              0.395
            ],
            [
              0.16,
              0.39
            ],
            [
              0.16,
              0.39
            ],
            [
              0.155,
              0.385
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            -0.05,
            0.08,
            0.02,
            0.04,
            -0.03
          ],
          "clump_fac": [
            0.7,
            0.68,
            0.72,
            0.71,
            0.69,
            0.7
          ]
        },
        "nlevmlcan": 5,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "edge",
        "description": "Very dense canopy with high LAI - minimal radiation reaches soil, strong attenuation",
        "edge_cases": [
          "high_lai",
          "dense_canopy",
          "strong_attenuation"
        ]
      }
    },
    {
      "name": "test_edge_extreme_albedo_boundaries",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 3,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 3,
        "filter_indices": [
          0,
          1,
          2
        ],
        "patch_state": {
          "itype": [
            1,
            3,
            7
          ],
          "cosz": [
            0.6,
            0.7,
            0.8
          ],
          "swskyb": [
            [
              700.0,
              550.0
            ],
            [
              750.0,
              580.0
            ],
            [
              800.0,
              620.0
            ]
          ],
          "swskyd": [
            [
              180.0,
              140.0
            ],
            [
              190.0,
              145.0
            ],
            [
              200.0,
              155.0
            ]
          ],
          "albsoib": [
            [
              0.0,
              0.0
            ],
            [
              0.5,
              0.6
            ],
            [
              1.0,
              1.0
            ]
          ],
          "albsoid": [
            [
              0.0,
              0.0
            ],
            [
              0.55,
              0.65
            ],
            [
              1.0,
              1.0
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              0.5,
              0.8,
              1.0,
              0.8,
              0.5
            ],
            [
              0.6,
              0.9,
              1.2,
              0.9,
              0.6
            ],
            [
              0.4,
              0.7,
              0.9,
              0.7,
              0.4
            ]
          ],
          "dsai_profile": [
            [
              0.1,
              0.15,
              0.2,
              0.15,
              0.1
            ],
            [
              0.12,
              0.18,
              0.24,
              0.18,
              0.12
            ],
            [
              0.08,
              0.14,
              0.18,
              0.14,
              0.08
            ]
          ],
          "dpai_profile": [
            [
              0.6,
              0.95,
              1.2,
              0.95,
              0.6
            ],
            [
              0.72,
              1.08,
              1.44,
              1.08,
              0.72
            ],
            [
              0.48,
              0.84,
              1.08,
              0.84,
              0.48
            ]
          ],
          "ntop_canopy": [
            0,
            0,
            0
          ],
          "nbot_canopy": [
            4,
            4,
            4
          ],
          "ncan_canopy": [
            5,
            5,
            5
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.0,
              0.0
            ],
            [
              0.1,
              0.45
            ],
            [
              0.5,
              0.95
            ],
            [
              0.05,
              0.4
            ],
            [
              0.15,
              0.5
            ],
            [
              0.1,
              0.45
            ],
            [
              0.08,
              0.42
            ],
            [
              0.12,
              0.48
            ]
          ],
          "taul": [
            [
              0.0,
              0.0
            ],
            [
              0.05,
              0.25
            ],
            [
              0.5,
              0.05
            ],
            [
              0.04,
              0.22
            ],
            [
              0.06,
              0.28
            ],
            [
              0.05,
              0.25
            ],
            [
              0.04,
              0.23
            ],
            [
              0.06,
              0.27
            ]
          ],
          "rhos": [
            [
              0.0,
              0.0
            ],
            [
              0.16,
              0.39
            ],
            [
              1.0,
              1.0
            ],
            [
              0.15,
              0.38
            ],
            [
              0.17,
              0.4
            ],
            [
              0.16,
              0.39
            ],
            [
              0.15,
              0.38
            ],
            [
              0.17,
              0.4
            ]
          ],
          "taus": [
            [
              0.0,
              0.0
            ],
            [
              0.001,
              0.001
            ],
            [
              0.0,
              0.0
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.0,
            0.01,
            0.0,
            -0.05,
            0.08,
            0.02,
            -0.03,
            0.06
          ],
          "clump_fac": [
            1.0,
            0.85,
            0.5,
            0.82,
            0.88,
            0.86,
            0.83,
            0.89
          ]
        },
        "nlevmlcan": 5,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "edge",
        "description": "Testing boundary albedo values (0.0, 0.5, 1.0) for soil and vegetation optical properties",
        "edge_cases": [
          "zero_albedo",
          "maximum_albedo",
          "boundary_reflectance"
        ]
      }
    },
    {
      "name": "test_special_single_canopy_layer",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "patch_state": {
          "itype": [
            4
          ],
          "cosz": [
            0.65
          ],
          "swskyb": [
            [
              720.0,
              560.0
            ]
          ],
          "swskyd": [
            [
              185.0,
              142.0
            ]
          ],
          "albsoib": [
            [
              0.14,
              0.24
            ]
          ],
          "albsoid": [
            [
              0.19,
              0.29
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              2.5
            ]
          ],
          "dsai_profile": [
            [
              0.5
            ]
          ],
          "dpai_profile": [
            [
              3.0
            ]
          ],
          "ntop_canopy": [
            0
          ],
          "nbot_canopy": [
            0
          ],
          "ncan_canopy": [
            1
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.09,
              0.43
            ],
            [
              0.11,
              0.47
            ],
            [
              0.1,
              0.44
            ],
            [
              0.09,
              0.42
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.045,
              0.23
            ],
            [
              0.055,
              0.27
            ],
            [
              0.05,
              0.24
            ],
            [
              0.045,
              0.22
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.155,
              0.385
            ],
            [
              0.165,
              0.395
            ],
            [
              0.16,
              0.39
            ],
            [
              0.155,
              0.385
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            -0.05,
            0.08,
            0.02,
            -0.03
          ],
          "clump_fac": [
            0.85,
            0.82,
            0.88,
            0.86,
            0.83
          ]
        },
        "nlevmlcan": 1,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "special",
        "description": "Minimum canopy layers (nlevmlcan=1) with all LAI concentrated in single layer",
        "edge_cases": [
          "single_layer"
        ]
      }
    },
    {
      "name": "test_special_many_canopy_layers",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "patch_state": {
          "itype": [
            6
          ],
          "cosz": [
            0.72
          ],
          "swskyb": [
            [
              780.0,
              590.0
            ]
          ],
          "swskyd": [
            [
              195.0,
              148.0
            ]
          ],
          "albsoib": [
            [
              0.13,
              0.23
            ]
          ],
          "albsoid": [
            [
              0.18,
              0.28
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              0.2,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8,
              0.7,
              0.6,
              0.5
            ]
          ],
          "dsai_profile": [
            [
              0.04,
              0.06,
              0.08,
              0.1,
              0.12,
              0.14,
              0.16,
              0.14,
              0.12,
              0.1
            ]
          ],
          "dpai_profile": [
            [
              0.24,
              0.36,
              0.48,
              0.6,
              0.72,
              0.84,
              0.96,
              0.84,
              0.72,
              0.6
            ]
          ],
          "ntop_canopy": [
            0
          ],
          "nbot_canopy": [
            9
          ],
          "ncan_canopy": [
            10
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.09,
              0.43
            ],
            [
              0.11,
              0.47
            ],
            [
              0.1,
              0.44
            ],
            [
              0.1,
              0.46
            ],
            [
              0.09,
              0.44
            ],
            [
              0.11,
              0.46
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.045,
              0.23
            ],
            [
              0.055,
              0.27
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.26
            ],
            [
              0.045,
              0.24
            ],
            [
              0.055,
              0.26
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.155,
              0.385
            ],
            [
              0.165,
              0.395
            ],
            [
              0.16,
              0.39
            ],
            [
              0.16,
              0.39
            ],
            [
              0.155,
              0.385
            ],
            [
              0.165,
              0.395
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            -0.05,
            0.08,
            0.02,
            0.04,
            -0.03,
            0.06
          ],
          "clump_fac": [
            0.85,
            0.82,
            0.88,
            0.86,
            0.87,
            0.83,
            0.89
          ]
        },
        "nlevmlcan": 10,
        "light_type": 2,
        "numrad": 2
      },
      "metadata": {
        "type": "special",
        "description": "Many canopy layers (10) with gradual LAI distribution, testing vertical resolution",
        "edge_cases": [
          "many_layers"
        ]
      }
    }
  ],
  "notes": "Test data generation assumptions and methodology:\n\n1. **Physical Realism**: All values respect physical constraints:\n   - Albedos and optical properties in [0,1]\n   - Solar radiation >= 0 W/m\u00b2\n   - cosz in [0,1] (cosine of zenith angle)\n   - LAI/SAI/PAI >= 0 m\u00b2/m\u00b2\n   - Leaf angle distribution (xl) in [-0.4, 0.6]\n   - Clumping factor in [0,1]\n\n2. **Radiation Bands**: numrad=2 represents visible and near-infrared bands, typical for land surface models\n\n3. **PFT Indexing**: itype values represent different plant functional types (0=bare ground, 1-N=vegetation types)\n\n4. **Canopy Structure**:\n   - ntop_canopy: typically 0 (top layer index)\n   - nbot_canopy: typically nlevmlcan-1 (bottom layer index)\n   - ncan_canopy: number of active canopy layers\n   - dpai_profile = dlai_profile + dsai_profile\n\n5. **Optical Properties**:\n   - Visible band (index 0): lower reflectance/transmittance due to chlorophyll absorption\n   - NIR band (index 1): higher reflectance/transmittance\n   - Stems have minimal transmittance (0.001)\n\n6. **Test Coverage**:\n   - Nominal cases (5): typical midday conditions, multiple patches, different methods\n   - Edge cases (3): zero/maximum cosz, zero LAI, dense canopy, extreme albedos\n   - Special cases (2): single layer, many layers\n\n7. **Array Dimensions**: All arrays properly sized:\n   - patch_state arrays: (n_patches,) or (n_patches, numrad)\n   - mlcanopy_state arrays: (n_patches, nlevmlcan)\n   - pft_params arrays: (n_pfts, numrad) or (n_pfts,)\n   - filter_indices: (num_filter,)\n\n8. **Consistency**: Within each test case:\n   - num_filter matches length of filter_indices\n   - filter_indices values < endp\n   - itype values used to index into pft_params\n   - All patch-level arrays have consistent first dimension"
}
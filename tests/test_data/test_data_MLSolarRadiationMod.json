{
  "function_name": "solar_radiation",
  "test_cases": [
    {
      "name": "test_nominal_single_patch_two_layers",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "patch_state": {
          "itype": [
            5
          ],
          "cosz": [
            0.7
          ],
          "swskyb": [
            [
              800.0,
              600.0
            ]
          ],
          "swskyd": [
            [
              200.0,
              150.0
            ]
          ],
          "albsoib": [
            [
              0.15,
              0.25
            ]
          ],
          "albsoid": [
            [
              0.2,
              0.3
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              2.5,
              1.8
            ]
          ],
          "dsai_profile": [
            [
              0.3,
              0.2
            ]
          ],
          "dpai_profile": [
            [
              2.8,
              2.0
            ]
          ],
          "ntop_canopy": [
            0
          ],
          "nbot_canopy": [
            1
          ],
          "ncan_canopy": [
            2
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.12,
              0.5
            ],
            [
              0.08,
              0.4
            ],
            [
              0.11,
              0.48
            ],
            [
              0.09,
              0.43
            ],
            [
              0.1,
              0.45
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.06,
              0.28
            ],
            [
              0.04,
              0.22
            ],
            [
              0.05,
              0.26
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.25
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.18,
              0.42
            ],
            [
              0.14,
              0.36
            ],
            [
              0.17,
              0.4
            ],
            [
              0.15,
              0.38
            ],
            [
              0.16,
              0.39
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            0.1,
            -0.1,
            0.05,
            -0.05,
            0.01
          ],
          "clump_fac": [
            0.85,
            0.8,
            0.9,
            0.82,
            0.88,
            0.85
          ]
        },
        "nlevmlcan": 2,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "nominal",
        "description": "Typical midday conditions with moderate LAI, single patch, Norman radiation scheme",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_multiple_patches_five_layers",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 3,
          "begg": 0,
          "endg": 2
        },
        "num_filter": 3,
        "filter_indices": [
          0,
          1,
          2
        ],
        "patch_state": {
          "itype": [
            2,
            4,
            5
          ],
          "cosz": [
            0.85,
            0.65,
            0.5
          ],
          "swskyb": [
            [
              900.0,
              700.0
            ],
            [
              750.0,
              550.0
            ],
            [
              600.0,
              450.0
            ]
          ],
          "swskyd": [
            [
              150.0,
              100.0
            ],
            [
              180.0,
              120.0
            ],
            [
              220.0,
              160.0
            ]
          ],
          "albsoib": [
            [
              0.12,
              0.22
            ],
            [
              0.18,
              0.28
            ],
            [
              0.14,
              0.24
            ]
          ],
          "albsoid": [
            [
              0.17,
              0.27
            ],
            [
              0.23,
              0.33
            ],
            [
              0.19,
              0.29
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              1.2,
              1.5,
              1.8,
              1.3,
              0.8
            ],
            [
              0.9,
              1.1,
              1.4,
              1.2,
              0.7
            ],
            [
              1.5,
              1.8,
              2.1,
              1.6,
              1.0
            ]
          ],
          "dsai_profile": [
            [
              0.15,
              0.18,
              0.22,
              0.16,
              0.1
            ],
            [
              0.12,
              0.14,
              0.17,
              0.15,
              0.09
            ],
            [
              0.18,
              0.22,
              0.25,
              0.19,
              0.12
            ]
          ],
          "dpai_profile": [
            [
              1.35,
              1.68,
              2.02,
              1.46,
              0.9
            ],
            [
              1.02,
              1.24,
              1.57,
              1.35,
              0.79
            ],
            [
              1.68,
              2.02,
              2.35,
              1.79,
              1.12
            ]
          ],
          "ntop_canopy": [
            0,
            0,
            0
          ],
          "nbot_canopy": [
            4,
            4,
            4
          ],
          "ncan_canopy": [
            5,
            5,
            5
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.12,
              0.5
            ],
            [
              0.08,
              0.4
            ],
            [
              0.11,
              0.48
            ],
            [
              0.09,
              0.43
            ],
            [
              0.1,
              0.45
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.06,
              0.28
            ],
            [
              0.04,
              0.22
            ],
            [
              0.05,
              0.26
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.25
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.18,
              0.42
            ],
            [
              0.14,
              0.36
            ],
            [
              0.17,
              0.4
            ],
            [
              0.15,
              0.38
            ],
            [
              0.16,
              0.39
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            0.1,
            -0.1,
            0.05,
            -0.05,
            0.01
          ],
          "clump_fac": [
            0.85,
            0.8,
            0.9,
            0.82,
            0.88,
            0.85
          ]
        },
        "nlevmlcan": 5,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "nominal",
        "description": "Multiple patches with varying solar angles and LAI profiles, 5-layer canopy",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_twostream_method",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 2,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "patch_state": {
          "itype": [
            3,
            5
          ],
          "cosz": [
            0.75,
            0.6
          ],
          "swskyb": [
            [
              850.0,
              650.0
            ],
            [
              700.0,
              500.0
            ]
          ],
          "swskyd": [
            [
              180.0,
              130.0
            ],
            [
              210.0,
              155.0
            ]
          ],
          "albsoib": [
            [
              0.13,
              0.23
            ],
            [
              0.16,
              0.26
            ]
          ],
          "albsoid": [
            [
              0.18,
              0.28
            ],
            [
              0.21,
              0.31
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              1.8,
              2.2,
              1.5
            ],
            [
              2.1,
              2.5,
              1.8
            ]
          ],
          "dsai_profile": [
            [
              0.2,
              0.25,
              0.18
            ],
            [
              0.24,
              0.28,
              0.2
            ]
          ],
          "dpai_profile": [
            [
              2.0,
              2.45,
              1.68
            ],
            [
              2.34,
              2.78,
              2.0
            ]
          ],
          "ntop_canopy": [
            0,
            0
          ],
          "nbot_canopy": [
            2,
            2
          ],
          "ncan_canopy": [
            3,
            3
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.12,
              0.5
            ],
            [
              0.08,
              0.4
            ],
            [
              0.11,
              0.48
            ],
            [
              0.09,
              0.43
            ],
            [
              0.1,
              0.45
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.06,
              0.28
            ],
            [
              0.04,
              0.22
            ],
            [
              0.05,
              0.26
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.25
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.18,
              0.42
            ],
            [
              0.14,
              0.36
            ],
            [
              0.17,
              0.4
            ],
            [
              0.15,
              0.38
            ],
            [
              0.16,
              0.39
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            0.1,
            -0.1,
            0.05,
            -0.05,
            0.01
          ],
          "clump_fac": [
            0.85,
            0.8,
            0.9,
            0.82,
            0.88,
            0.85
          ]
        },
        "nlevmlcan": 3,
        "light_type": 2,
        "numrad": 2
      },
      "metadata": {
        "type": "nominal",
        "description": "Testing TwoStream radiation transfer method with moderate canopy",
        "edge_cases": []
      }
    },
    {
      "name": "test_edge_zero_solar_zenith_angle",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 2,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "patch_state": {
          "itype": [
            1,
            3
          ],
          "cosz": [
            0.0,
            0.001
          ],
          "swskyb": [
            [
              0.0,
              0.0
            ],
            [
              5.0,
              3.0
            ]
          ],
          "swskyd": [
            [
              50.0,
              30.0
            ],
            [
              80.0,
              50.0
            ]
          ],
          "albsoib": [
            [
              0.2,
              0.3
            ],
            [
              0.18,
              0.28
            ]
          ],
          "albsoid": [
            [
              0.25,
              0.35
            ],
            [
              0.23,
              0.33
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              1.0,
              0.8,
              0.5
            ],
            [
              1.2,
              1.0,
              0.7
            ]
          ],
          "dsai_profile": [
            [
              0.12,
              0.1,
              0.06
            ],
            [
              0.15,
              0.12,
              0.08
            ]
          ],
          "dpai_profile": [
            [
              1.12,
              0.9,
              0.56
            ],
            [
              1.35,
              1.12,
              0.78
            ]
          ],
          "ntop_canopy": [
            0,
            0
          ],
          "nbot_canopy": [
            2,
            2
          ],
          "ncan_canopy": [
            3,
            3
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.12,
              0.5
            ],
            [
              0.08,
              0.4
            ],
            [
              0.11,
              0.48
            ],
            [
              0.09,
              0.43
            ],
            [
              0.1,
              0.45
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.06,
              0.28
            ],
            [
              0.04,
              0.22
            ],
            [
              0.05,
              0.26
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.25
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.18,
              0.42
            ],
            [
              0.14,
              0.36
            ],
            [
              0.17,
              0.4
            ],
            [
              0.15,
              0.38
            ],
            [
              0.16,
              0.39
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            0.1,
            -0.1,
            0.05,
            -0.05,
            0.01
          ],
          "clump_fac": [
            0.85,
            0.8,
            0.9,
            0.82,
            0.88,
            0.85
          ]
        },
        "nlevmlcan": 3,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "edge",
        "description": "Near-horizontal sun (sunrise/sunset) with minimal direct beam radiation",
        "edge_cases": [
          "zero_cosz",
          "zero_direct_beam"
        ]
      }
    },
    {
      "name": "test_edge_zero_lai_sparse_canopy",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "patch_state": {
          "itype": [
            2
          ],
          "cosz": [
            0.8
          ],
          "swskyb": [
            [
              850.0,
              650.0
            ]
          ],
          "swskyd": [
            [
              150.0,
              100.0
            ]
          ],
          "albsoib": [
            [
              0.15,
              0.25
            ]
          ],
          "albsoid": [
            [
              0.2,
              0.3
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "dsai_profile": [
            [
              0.05,
              0.03,
              0.02,
              0.01
            ]
          ],
          "dpai_profile": [
            [
              0.05,
              0.03,
              0.02,
              0.01
            ]
          ],
          "ntop_canopy": [
            0
          ],
          "nbot_canopy": [
            3
          ],
          "ncan_canopy": [
            4
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.12,
              0.5
            ],
            [
              0.08,
              0.4
            ],
            [
              0.11,
              0.48
            ],
            [
              0.09,
              0.43
            ],
            [
              0.1,
              0.45
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.06,
              0.28
            ],
            [
              0.04,
              0.22
            ],
            [
              0.05,
              0.26
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.25
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.18,
              0.42
            ],
            [
              0.14,
              0.36
            ],
            [
              0.17,
              0.4
            ],
            [
              0.15,
              0.38
            ],
            [
              0.16,
              0.39
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            0.1,
            -0.1,
            0.05,
            -0.05,
            0.01
          ],
          "clump_fac": [
            0.85,
            0.8,
            0.9,
            0.82,
            0.88,
            0.85
          ]
        },
        "nlevmlcan": 4,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "edge",
        "description": "Bare/sparse canopy with zero LAI, only stems present",
        "edge_cases": [
          "zero_lai",
          "sparse_canopy"
        ]
      }
    },
    {
      "name": "test_edge_maximum_lai_dense_canopy",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "patch_state": {
          "itype": [
            4
          ],
          "cosz": [
            0.9
          ],
          "swskyb": [
            [
              950.0,
              750.0
            ]
          ],
          "swskyd": [
            [
              100.0,
              70.0
            ]
          ],
          "albsoib": [
            [
              0.1,
              0.2
            ]
          ],
          "albsoid": [
            [
              0.15,
              0.25
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              3.5,
              4.0,
              4.2,
              3.8,
              3.0,
              2.5
            ]
          ],
          "dsai_profile": [
            [
              0.4,
              0.45,
              0.48,
              0.42,
              0.35,
              0.28
            ]
          ],
          "dpai_profile": [
            [
              3.9,
              4.45,
              4.68,
              4.22,
              3.35,
              2.78
            ]
          ],
          "ntop_canopy": [
            0
          ],
          "nbot_canopy": [
            5
          ],
          "ncan_canopy": [
            6
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.12,
              0.5
            ],
            [
              0.08,
              0.4
            ],
            [
              0.11,
              0.48
            ],
            [
              0.09,
              0.43
            ],
            [
              0.1,
              0.45
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.06,
              0.28
            ],
            [
              0.04,
              0.22
            ],
            [
              0.05,
              0.26
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.25
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.18,
              0.42
            ],
            [
              0.14,
              0.36
            ],
            [
              0.17,
              0.4
            ],
            [
              0.15,
              0.38
            ],
            [
              0.16,
              0.39
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            0.1,
            -0.1,
            0.05,
            -0.05,
            0.01
          ],
          "clump_fac": [
            0.85,
            0.8,
            0.9,
            0.82,
            0.88,
            0.85
          ]
        },
        "nlevmlcan": 6,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "edge",
        "description": "Very dense canopy with high LAI values, testing light extinction limits",
        "edge_cases": [
          "maximum_lai",
          "dense_canopy"
        ]
      }
    },
    {
      "name": "test_edge_boundary_albedo_values",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 3,
          "begg": 0,
          "endg": 2
        },
        "num_filter": 3,
        "filter_indices": [
          0,
          1,
          2
        ],
        "patch_state": {
          "itype": [
            1,
            2,
            3
          ],
          "cosz": [
            0.7,
            0.7,
            0.7
          ],
          "swskyb": [
            [
              800.0,
              600.0
            ],
            [
              800.0,
              600.0
            ],
            [
              800.0,
              600.0
            ]
          ],
          "swskyd": [
            [
              200.0,
              150.0
            ],
            [
              200.0,
              150.0
            ],
            [
              200.0,
              150.0
            ]
          ],
          "albsoib": [
            [
              0.0,
              0.0
            ],
            [
              0.5,
              0.5
            ],
            [
              1.0,
              1.0
            ]
          ],
          "albsoid": [
            [
              0.0,
              0.0
            ],
            [
              0.5,
              0.5
            ],
            [
              1.0,
              1.0
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              1.5,
              1.2
            ],
            [
              1.5,
              1.2
            ],
            [
              1.5,
              1.2
            ]
          ],
          "dsai_profile": [
            [
              0.18,
              0.15
            ],
            [
              0.18,
              0.15
            ],
            [
              0.18,
              0.15
            ]
          ],
          "dpai_profile": [
            [
              1.68,
              1.35
            ],
            [
              1.68,
              1.35
            ],
            [
              1.68,
              1.35
            ]
          ],
          "ntop_canopy": [
            0,
            0,
            0
          ],
          "nbot_canopy": [
            1,
            1,
            1
          ],
          "ncan_canopy": [
            2,
            2,
            2
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.12,
              0.5
            ],
            [
              0.08,
              0.4
            ],
            [
              0.11,
              0.48
            ],
            [
              0.09,
              0.43
            ],
            [
              0.1,
              0.45
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.06,
              0.28
            ],
            [
              0.04,
              0.22
            ],
            [
              0.05,
              0.26
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.25
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.18,
              0.42
            ],
            [
              0.14,
              0.36
            ],
            [
              0.17,
              0.4
            ],
            [
              0.15,
              0.38
            ],
            [
              0.16,
              0.39
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            0.1,
            -0.1,
            0.05,
            -0.05,
            0.01
          ],
          "clump_fac": [
            0.85,
            0.8,
            0.9,
            0.82,
            0.88,
            0.85
          ]
        },
        "nlevmlcan": 2,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "edge",
        "description": "Testing boundary albedo values (0.0, 0.5, 1.0) for soil reflectance",
        "edge_cases": [
          "boundary_albedo",
          "zero_albedo",
          "maximum_albedo"
        ]
      }
    },
    {
      "name": "test_edge_extreme_leaf_orientation",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 3,
          "begg": 0,
          "endg": 2
        },
        "num_filter": 3,
        "filter_indices": [
          0,
          1,
          2
        ],
        "patch_state": {
          "itype": [
            0,
            1,
            2
          ],
          "cosz": [
            0.6,
            0.6,
            0.6
          ],
          "swskyb": [
            [
              750.0,
              550.0
            ],
            [
              750.0,
              550.0
            ],
            [
              750.0,
              550.0
            ]
          ],
          "swskyd": [
            [
              200.0,
              150.0
            ],
            [
              200.0,
              150.0
            ],
            [
              200.0,
              150.0
            ]
          ],
          "albsoib": [
            [
              0.15,
              0.25
            ],
            [
              0.15,
              0.25
            ],
            [
              0.15,
              0.25
            ]
          ],
          "albsoid": [
            [
              0.2,
              0.3
            ],
            [
              0.2,
              0.3
            ],
            [
              0.2,
              0.3
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              2.0,
              1.5,
              1.0
            ],
            [
              2.0,
              1.5,
              1.0
            ],
            [
              2.0,
              1.5,
              1.0
            ]
          ],
          "dsai_profile": [
            [
              0.22,
              0.18,
              0.12
            ],
            [
              0.22,
              0.18,
              0.12
            ],
            [
              0.22,
              0.18,
              0.12
            ]
          ],
          "dpai_profile": [
            [
              2.22,
              1.68,
              1.12
            ],
            [
              2.22,
              1.68,
              1.12
            ],
            [
              2.22,
              1.68,
              1.12
            ]
          ],
          "ntop_canopy": [
            0,
            0,
            0
          ],
          "nbot_canopy": [
            2,
            2,
            2
          ],
          "ncan_canopy": [
            3,
            3,
            3
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.12,
              0.5
            ],
            [
              0.08,
              0.4
            ],
            [
              0.11,
              0.48
            ],
            [
              0.09,
              0.43
            ],
            [
              0.1,
              0.45
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.06,
              0.28
            ],
            [
              0.04,
              0.22
            ],
            [
              0.05,
              0.26
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.25
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.18,
              0.42
            ],
            [
              0.14,
              0.36
            ],
            [
              0.17,
              0.4
            ],
            [
              0.15,
              0.38
            ],
            [
              0.16,
              0.39
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            -0.4,
            0.0,
            0.6,
            0.05,
            -0.05,
            0.01
          ],
          "clump_fac": [
            0.85,
            0.8,
            0.9,
            0.82,
            0.88,
            0.85
          ]
        },
        "nlevmlcan": 3,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "edge",
        "description": "Testing extreme leaf orientation indices (planophile, spherical, erectophile)",
        "edge_cases": [
          "extreme_xl_values",
          "boundary_orientation"
        ]
      }
    },
    {
      "name": "test_special_single_layer_canopy",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 2,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "patch_state": {
          "itype": [
            3,
            5
          ],
          "cosz": [
            0.8,
            0.7
          ],
          "swskyb": [
            [
              880.0,
              680.0
            ],
            [
              820.0,
              620.0
            ]
          ],
          "swskyd": [
            [
              170.0,
              120.0
            ],
            [
              190.0,
              140.0
            ]
          ],
          "albsoib": [
            [
              0.14,
              0.24
            ],
            [
              0.16,
              0.26
            ]
          ],
          "albsoid": [
            [
              0.19,
              0.29
            ],
            [
              0.21,
              0.31
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              3.5
            ],
            [
              2.8
            ]
          ],
          "dsai_profile": [
            [
              0.4
            ],
            [
              0.32
            ]
          ],
          "dpai_profile": [
            [
              3.9
            ],
            [
              3.12
            ]
          ],
          "ntop_canopy": [
            0,
            0
          ],
          "nbot_canopy": [
            0,
            0
          ],
          "ncan_canopy": [
            1,
            1
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.1,
              0.45
            ],
            [
              0.12,
              0.5
            ],
            [
              0.08,
              0.4
            ],
            [
              0.11,
              0.48
            ],
            [
              0.09,
              0.43
            ],
            [
              0.1,
              0.45
            ]
          ],
          "taul": [
            [
              0.05,
              0.25
            ],
            [
              0.06,
              0.28
            ],
            [
              0.04,
              0.22
            ],
            [
              0.05,
              0.26
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.25
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.18,
              0.42
            ],
            [
              0.14,
              0.36
            ],
            [
              0.17,
              0.4
            ],
            [
              0.15,
              0.38
            ],
            [
              0.16,
              0.39
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            0.1,
            -0.1,
            0.05,
            -0.05,
            0.01
          ],
          "clump_fac": [
            0.85,
            0.8,
            0.9,
            0.82,
            0.88,
            0.85
          ]
        },
        "nlevmlcan": 1,
        "light_type": 1,
        "numrad": 2
      },
      "metadata": {
        "type": "special",
        "description": "Minimal canopy structure with single layer, testing simplified radiation transfer",
        "edge_cases": []
      }
    },
    {
      "name": "test_special_high_clumping_low_transmittance",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 2,
          "begg": 0,
          "endg": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "patch_state": {
          "itype": [
            0,
            1
          ],
          "cosz": [
            0.65,
            0.55
          ],
          "swskyb": [
            [
              780.0,
              580.0
            ],
            [
              720.0,
              520.0
            ]
          ],
          "swskyd": [
            [
              210.0,
              160.0
            ],
            [
              230.0,
              175.0
            ]
          ],
          "albsoib": [
            [
              0.17,
              0.27
            ],
            [
              0.19,
              0.29
            ]
          ],
          "albsoid": [
            [
              0.22,
              0.32
            ],
            [
              0.24,
              0.34
            ]
          ]
        },
        "mlcanopy_state": {
          "dlai_profile": [
            [
              2.2,
              2.5,
              2.0,
              1.5
            ],
            [
              1.8,
              2.1,
              1.7,
              1.2
            ]
          ],
          "dsai_profile": [
            [
              0.25,
              0.28,
              0.22,
              0.18
            ],
            [
              0.2,
              0.24,
              0.19,
              0.14
            ]
          ],
          "dpai_profile": [
            [
              2.45,
              2.78,
              2.22,
              1.68
            ],
            [
              2.0,
              2.34,
              1.89,
              1.34
            ]
          ],
          "ntop_canopy": [
            0,
            0
          ],
          "nbot_canopy": [
            3,
            3
          ],
          "ncan_canopy": [
            4,
            4
          ]
        },
        "pft_params": {
          "rhol": [
            [
              0.02,
              0.35
            ],
            [
              0.03,
              0.38
            ],
            [
              0.08,
              0.4
            ],
            [
              0.11,
              0.48
            ],
            [
              0.09,
              0.43
            ],
            [
              0.1,
              0.45
            ]
          ],
          "taul": [
            [
              0.01,
              0.15
            ],
            [
              0.01,
              0.18
            ],
            [
              0.04,
              0.22
            ],
            [
              0.05,
              0.26
            ],
            [
              0.05,
              0.24
            ],
            [
              0.05,
              0.25
            ]
          ],
          "rhos": [
            [
              0.16,
              0.39
            ],
            [
              0.18,
              0.42
            ],
            [
              0.14,
              0.36
            ],
            [
              0.17,
              0.4
            ],
            [
              0.15,
              0.38
            ],
            [
              0.16,
              0.39
            ]
          ],
          "taus": [
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ],
            [
              0.001,
              0.001
            ]
          ],
          "xl": [
            0.01,
            0.1,
            -0.1,
            0.05,
            -0.05,
            0.01
          ],
          "clump_fac": [
            0.5,
            0.45,
            0.9,
            0.82,
            0.88,
            0.85
          ]
        },
        "nlevmlcan": 4,
        "light_type": 2,
        "numrad": 2
      },
      "metadata": {
        "type": "special",
        "description": "High foliage clumping with low leaf transmittance, testing extreme optical properties",
        "edge_cases": []
      }
    }
  ],
  "notes": "Test data generation assumptions:\n\n1. **Physical Realism**: All values respect physical constraints (albedos in [0,1], cosz in [0,1], radiation >= 0, LAI >= 0)\n\n2. **Dimensional Consistency**: Within each test case, array dimensions are consistent:\n   - n_patches matches num_filter and filter_indices length\n   - nlevmlcan matches canopy profile dimensions\n   - numrad=2 for visible and near-infrared bands\n   - n_pfts=6 for typical PFT parameter arrays\n\n3. **Nominal Cases** (tests 1-3): Cover typical midday conditions with varying:\n   - Solar zenith angles (cosz: 0.5-0.9)\n   - LAI profiles (1.0-4.0 m\u00b2/m\u00b2)\n   - Multiple patches and canopy layers\n   - Both Norman and TwoStream radiation methods\n\n4. **Edge Cases** (tests 4-8):\n   - Zero/near-zero solar zenith angle (sunrise/sunset)\n   - Zero LAI (bare/sparse canopy)\n   - Maximum LAI (dense canopy)\n   - Boundary albedo values (0.0, 0.5, 1.0)\n   - Extreme leaf orientation indices (-0.4 to 0.6)\n\n5. **Special Cases** (tests 9-10):\n   - Single-layer canopy (minimal structure)\n   - Extreme optical properties (high clumping, low transmittance)\n\n6. **Radiation Values**: Direct beam (swskyb) typically 600-950 W/m\u00b2, diffuse (swskyd) 50-230 W/m\u00b2\n\n7. **PFT Parameters**: Based on typical vegetation optical properties:\n   - Visible band: lower reflectance (0.08-0.12), lower transmittance (0.04-0.06)\n   - NIR band: higher reflectance (0.40-0.50), higher transmittance (0.22-0.28)\n   - Stem transmittance very low (0.001)\n\n8. **Canopy Structure**: \n   - ntop_canopy typically 0 (top layer)\n   - nbot_canopy = nlevmlcan - 1\n   - ncan_canopy = nlevmlcan\n   - dpai = dlai + dsai\n\n9. **Filter Indices**: Sequential starting from 0, matching num_filter\n\n10. **Bounds**: begp=0, endp=num_filter, begg/endg set for gridcell coverage"
}
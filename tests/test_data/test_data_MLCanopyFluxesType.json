{
  "function_name": "MLCanopyFluxesType",
  "test_cases": [
    {
      "name": "test_create_empty_mlcanopy_state_nominal",
      "inputs": {
        "n_patches": 10,
        "nlevmlcan": 20,
        "nleaf": 2,
        "numrad": 2,
        "nlevgrnd": 15
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard configuration with typical patch count and layer dimensions",
        "edge_cases": []
      }
    },
    {
      "name": "test_create_empty_mlcanopy_state_single_patch",
      "inputs": {
        "n_patches": 1,
        "nlevmlcan": 10,
        "nleaf": 2,
        "numrad": 2,
        "nlevgrnd": 15
      },
      "metadata": {
        "type": "edge",
        "description": "Minimum patch count - tests single patch initialization",
        "edge_cases": [
          "minimum_patches"
        ]
      }
    },
    {
      "name": "test_create_empty_mlcanopy_state_many_layers",
      "inputs": {
        "n_patches": 5,
        "nlevmlcan": 50,
        "nleaf": 2,
        "numrad": 2,
        "nlevgrnd": 30
      },
      "metadata": {
        "type": "special",
        "description": "High vertical resolution with many canopy and ground layers",
        "edge_cases": []
      }
    },
    {
      "name": "test_init_allocate_standard_bounds",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 99
        },
        "nlevmlcan": 20,
        "numrad": 2,
        "nlevgrnd": 15,
        "nleaf": 2
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard bounds with 100 patches (0-99 inclusive)",
        "edge_cases": []
      }
    },
    {
      "name": "test_init_allocate_single_patch_bounds",
      "inputs": {
        "bounds": {
          "begp": 5,
          "endp": 5
        },
        "nlevmlcan": 15,
        "numrad": 2,
        "nlevgrnd": 15,
        "nleaf": 2
      },
      "metadata": {
        "type": "edge",
        "description": "Single patch bounds where begp equals endp",
        "edge_cases": [
          "single_patch_bounds"
        ]
      }
    },
    {
      "name": "test_init_cold_typical_forest",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 49
        },
        "nlevmlcan": 25,
        "nleaf": 2
      },
      "metadata": {
        "type": "nominal",
        "description": "Typical forest canopy with 50 patches and 25 vertical layers",
        "edge_cases": []
      }
    },
    {
      "name": "test_init_cold_minimal_canopy",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 9
        },
        "nlevmlcan": 1,
        "nleaf": 2
      },
      "metadata": {
        "type": "edge",
        "description": "Minimal canopy with single layer - tests lower boundary",
        "edge_cases": [
          "minimum_layers"
        ]
      }
    },
    {
      "name": "test_init_complete_system",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 199
        },
        "nlevmlcan": 30,
        "numrad": 2,
        "nlevgrnd": 15,
        "nleaf": 2
      },
      "metadata": {
        "type": "nominal",
        "description": "Complete initialization for large domain with 200 patches",
        "edge_cases": []
      }
    },
    {
      "name": "test_extract_and_restore_restart_cycle",
      "inputs": {
        "mlcanopy_state": {
          "n_patches": 20,
          "nlevmlcan": 15,
          "nleaf": 2,
          "ztop_canopy": [
            25.0,
            30.0,
            22.5,
            28.0,
            26.5,
            24.0,
            29.0,
            27.5,
            23.5,
            31.0,
            25.5,
            26.0,
            28.5,
            24.5,
            27.0,
            29.5,
            23.0,
            30.5,
            25.0,
            28.0
          ],
          "zbot_canopy": [
            0.5,
            0.8,
            0.3,
            0.6,
            0.7,
            0.4,
            0.9,
            0.5,
            0.6,
            1.0,
            0.5,
            0.6,
            0.8,
            0.4,
            0.7,
            0.9,
            0.3,
            1.0,
            0.5,
            0.8
          ],
          "lai_canopy": [
            5.2,
            6.1,
            4.8,
            5.9,
            5.5,
            4.9,
            6.3,
            5.7,
            5.0,
            6.5,
            5.3,
            5.6,
            6.0,
            4.7,
            5.8,
            6.2,
            4.6,
            6.4,
            5.2,
            5.9
          ],
          "tref_forcing": [
            288.15,
            290.5,
            285.0,
            292.3,
            289.7,
            287.2,
            293.1,
            291.0,
            286.5,
            294.0,
            288.8,
            289.5,
            291.8,
            286.0,
            290.2,
            292.5,
            285.5,
            293.5,
            288.15,
            291.5
          ],
          "taf_canopy": [
            289.0,
            291.2,
            285.8,
            293.0,
            290.5,
            288.0,
            293.8,
            291.7,
            287.2,
            294.7,
            289.5,
            290.2,
            292.5,
            286.7,
            290.9,
            293.2,
            286.2,
            294.2,
            289.0,
            292.2
          ],
          "lwp_leaf": [
            [
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ]
            ],
            [
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ]
            ],
            [
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.2,
                -0.5
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ]
            ],
            [
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.8,
                -1.2
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.8,
                -1.2
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.8,
                -1.2
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.8,
                -1.2
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ]
            ],
            [
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ]
            ],
            [
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.2,
                -0.5
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ]
            ],
            [
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ]
            ],
            [
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ]
            ],
            [
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.2,
                -0.5
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ]
            ],
            [
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.8,
                -1.2
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.8,
                -1.2
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.8,
                -1.2
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.8,
                -1.2
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ]
            ],
            [
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ]
            ],
            [
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ]
            ],
            [
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ]
            ],
            [
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.2,
                -0.5
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ]
            ],
            [
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ]
            ],
            [
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ]
            ],
            [
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.2,
                -0.5
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.3,
                -0.6
              ]
            ],
            [
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.8,
                -1.2
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.8,
                -1.2
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.8,
                -1.2
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.8,
                -1.2
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ]
            ],
            [
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.3,
                -0.6
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.4,
                -0.7
              ]
            ],
            [
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.4,
                -0.7
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ],
              [
                -0.7,
                -1.0
              ],
              [
                -0.6,
                -0.9
              ],
              [
                -0.5,
                -0.8
              ]
            ]
          ],
          "lwp_mean_profile": [
            [
              -0.65,
              -0.55,
              -0.75,
              -0.45,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55
            ],
            [
              -0.75,
              -0.65,
              -0.85,
              -0.55,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65
            ],
            [
              -0.55,
              -0.45,
              -0.65,
              -0.35,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45
            ],
            [
              -0.85,
              -0.75,
              -1.0,
              -0.65,
              -0.85,
              -0.75,
              -1.0,
              -0.85,
              -0.75,
              -1.0,
              -0.85,
              -0.75,
              -1.0,
              -0.85,
              -0.75
            ],
            [
              -0.65,
              -0.55,
              -0.75,
              -0.45,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55
            ],
            [
              -0.55,
              -0.45,
              -0.65,
              -0.35,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45
            ],
            [
              -0.75,
              -0.65,
              -0.85,
              -0.55,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65
            ],
            [
              -0.65,
              -0.55,
              -0.75,
              -0.45,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55
            ],
            [
              -0.55,
              -0.45,
              -0.65,
              -0.35,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45
            ],
            [
              -0.85,
              -0.75,
              -1.0,
              -0.65,
              -0.85,
              -0.75,
              -1.0,
              -0.85,
              -0.75,
              -1.0,
              -0.85,
              -0.75,
              -1.0,
              -0.85,
              -0.75
            ],
            [
              -0.65,
              -0.55,
              -0.75,
              -0.45,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55
            ],
            [
              -0.65,
              -0.55,
              -0.75,
              -0.45,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55
            ],
            [
              -0.75,
              -0.65,
              -0.85,
              -0.55,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65
            ],
            [
              -0.55,
              -0.45,
              -0.65,
              -0.35,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45
            ],
            [
              -0.65,
              -0.55,
              -0.75,
              -0.45,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55
            ],
            [
              -0.75,
              -0.65,
              -0.85,
              -0.55,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65
            ],
            [
              -0.55,
              -0.45,
              -0.65,
              -0.35,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45,
              -0.65,
              -0.55,
              -0.45
            ],
            [
              -0.85,
              -0.75,
              -1.0,
              -0.65,
              -0.85,
              -0.75,
              -1.0,
              -0.85,
              -0.75,
              -1.0,
              -0.85,
              -0.75,
              -1.0,
              -0.85,
              -0.75
            ],
            [
              -0.65,
              -0.55,
              -0.75,
              -0.45,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55,
              -0.75,
              -0.65,
              -0.55
            ],
            [
              -0.75,
              -0.65,
              -0.85,
              -0.55,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65,
              -0.85,
              -0.75,
              -0.65
            ]
          ]
        }
      },
      "metadata": {
        "type": "nominal",
        "description": "Complete restart cycle with realistic canopy state - tests extract and restore functionality",
        "edge_cases": []
      }
    },
    {
      "name": "test_validate_restart_data_extreme_stress",
      "inputs": {
        "restart_data": {
          "taf_canopy": [
            273.15,
            275.0,
            270.0,
            278.5,
            272.3
          ],
          "lwp_mean_profile": [
            [
              -8.5,
              -9.0,
              -9.5,
              -8.0,
              -7.5,
              -9.2,
              -8.8,
              -9.3
            ],
            [
              -9.0,
              -9.5,
              -9.8,
              -8.5,
              -8.0,
              -9.7,
              -9.3,
              -9.6
            ],
            [
              -7.5,
              -8.0,
              -8.5,
              -7.0,
              -6.5,
              -8.2,
              -7.8,
              -8.3
            ],
            [
              -9.5,
              -9.8,
              -10.0,
              -9.0,
              -8.5,
              -9.9,
              -9.6,
              -9.8
            ],
            [
              -8.0,
              -8.5,
              -9.0,
              -7.5,
              -7.0,
              -8.7,
              -8.3,
              -8.6
            ]
          ]
        },
        "n_patches": 5,
        "nlevmlcan": 8
      },
      "metadata": {
        "type": "edge",
        "description": "Extreme water stress conditions near physical limits - tests validation with severe drought",
        "edge_cases": [
          "extreme_water_stress",
          "boundary_lwp"
        ]
      }
    },
    {
      "name": "test_validate_restart_data_cold_conditions",
      "inputs": {
        "restart_data": {
          "taf_canopy": [
            253.15,
            258.0,
            250.0,
            260.5,
            255.3,
            252.8,
            257.2
          ],
          "lwp_mean_profile": [
            [
              -0.1,
              -0.15,
              -0.2,
              -0.12,
              -0.18
            ],
            [
              -0.12,
              -0.17,
              -0.22,
              -0.14,
              -0.2
            ],
            [
              -0.08,
              -0.13,
              -0.18,
              -0.1,
              -0.16
            ],
            [
              -0.15,
              -0.2,
              -0.25,
              -0.17,
              -0.23
            ],
            [
              -0.1,
              -0.15,
              -0.2,
              -0.12,
              -0.18
            ],
            [
              -0.09,
              -0.14,
              -0.19,
              -0.11,
              -0.17
            ],
            [
              -0.13,
              -0.18,
              -0.23,
              -0.15,
              -0.21
            ]
          ]
        },
        "n_patches": 7,
        "nlevmlcan": 5
      },
      "metadata": {
        "type": "edge",
        "description": "Cold temperature conditions with minimal water stress - tests winter/arctic scenarios",
        "edge_cases": [
          "cold_temperature",
          "minimal_stress"
        ]
      }
    }
  ],
  "notes": "Test data generation strategy:\n\n1. **Dimensional consistency**: All array dimensions within each test case are internally consistent (n_patches, nlevmlcan, nleaf=2, numrad=2).\n\n2. **Physical realism**:\n   - Temperatures in Kelvin: 150-350K range (extreme cold to hot)\n   - Canopy heights: ztop > zbot, both >= 0\n   - LAI: 0-8 m\u00b2/m\u00b2 (typical range for vegetation)\n   - Leaf water potential: -10 to 0 MPa (0=saturated, -10=extreme stress)\n   - Sunlit leaves (index 0) typically less stressed than shaded (index 1)\n\n3. **Edge cases covered**:\n   - Minimum dimensions (single patch, single layer)\n   - Maximum stress conditions (lwp near -10 MPa)\n   - Cold temperatures (near freezing)\n   - Large domains (200 patches)\n   - High vertical resolution (50 layers)\n\n4. **Test case distribution**:\n   - 5 nominal cases (50%): Standard operating conditions\n   - 3 edge cases (30%): Boundary conditions, extremes\n   - 2 special cases (20%): Unusual but valid configurations\n\n5. **Restart cycle test**: Includes complete MLCanopyState with realistic vertical profiles showing:\n   - Gradient in water stress through canopy\n   - Sunlit/shaded leaf differences\n   - Temperature variations across patches\n   - Physically consistent relationships\n\n6. **Validation tests**: Include extreme but valid conditions to test boundary checking:\n   - Severe drought (lwp approaching -10 MPa)\n   - Cold conditions (temps near 250K)\n   - Minimal water stress (lwp near 0 MPa)\n\n7. **Array structure**: lwp_leaf is (n_patches, nlevmlcan, nleaf=2) where last dimension is [sunlit, shaded]. Shaded leaves typically have more negative (stressed) values.\n\n8. **Constants used**: DEFAULT_LWP=-0.1 MPa for initialization, physically reasonable ranges for all variables based on plant physiology and atmospheric science."
}
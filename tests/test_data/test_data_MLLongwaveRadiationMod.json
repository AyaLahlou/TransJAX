{
  "function_name": "longwave_radiation",
  "test_cases": [
    {
      "name": "test_nominal_single_patch_single_layer",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 0
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "mlcanopy_inst": {
          "ncan": [
            1
          ],
          "ntop": [
            0
          ],
          "nbot": [
            0
          ],
          "tleaf_sun": [
            [
              298.15,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              295.15,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.6,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              0.7,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              2.5,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tg": [
            293.15
          ],
          "lwsky": [
            350.0
          ],
          "itype": [
            1
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0
          ],
          "lwveg": [
            0.0
          ],
          "lwup": [
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "nominal",
        "description": "Single patch with single canopy layer, typical summer conditions",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_multi_patch_multi_layer",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 2
        },
        "num_filter": 3,
        "filter_indices": [
          0,
          1,
          2
        ],
        "mlcanopy_inst": {
          "ncan": [
            3,
            2,
            4
          ],
          "ntop": [
            0,
            0,
            0
          ],
          "nbot": [
            2,
            1,
            3
          ],
          "tleaf_sun": [
            [
              303.15,
              300.15,
              297.15,
              0.0,
              0.0
            ],
            [
              301.15,
              298.15,
              0.0,
              0.0,
              0.0
            ],
            [
              305.15,
              302.15,
              299.15,
              296.15,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              300.15,
              297.15,
              294.15,
              0.0,
              0.0
            ],
            [
              298.15,
              295.15,
              0.0,
              0.0,
              0.0
            ],
            [
              302.15,
              299.15,
              296.15,
              293.15,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.7,
              0.5,
              0.3,
              0.0,
              0.0
            ],
            [
              0.65,
              0.4,
              0.0,
              0.0,
              0.0
            ],
            [
              0.75,
              0.6,
              0.45,
              0.25,
              0.0
            ]
          ],
          "td": [
            [
              0.8,
              0.6,
              0.4,
              0.0,
              0.0
            ],
            [
              0.75,
              0.5,
              0.0,
              0.0,
              0.0
            ],
            [
              0.85,
              0.7,
              0.55,
              0.35,
              0.0
            ]
          ],
          "dpai": [
            [
              1.5,
              2.0,
              1.8,
              0.0,
              0.0
            ],
            [
              2.2,
              1.9,
              0.0,
              0.0,
              0.0
            ],
            [
              1.2,
              1.8,
              2.1,
              1.5,
              0.0
            ]
          ],
          "tg": [
            290.15,
            292.15,
            288.15
          ],
          "lwsky": [
            340.0,
            355.0,
            330.0
          ],
          "itype": [
            2,
            1,
            3
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0,
            0.0,
            0.0
          ],
          "lwveg": [
            0.0,
            0.0,
            0.0
          ],
          "lwup": [
            0.0,
            0.0,
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "nominal",
        "description": "Multiple patches with varying canopy layers, typical forest conditions",
        "edge_cases": []
      }
    },
    {
      "name": "test_edge_zero_plant_area_index",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "mlcanopy_inst": {
          "ncan": [
            1,
            2
          ],
          "ntop": [
            0,
            0
          ],
          "nbot": [
            0,
            1
          ],
          "tleaf_sun": [
            [
              298.15,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              300.15,
              297.15,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              295.15,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              297.15,
              294.15,
              0.0,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.5,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.6,
              0.4,
              0.0,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              0.9,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.8,
              0.6,
              0.0,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.1,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tg": [
            293.15,
            291.15
          ],
          "lwsky": [
            345.0,
            350.0
          ],
          "itype": [
            1,
            2
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0,
            0.0
          ],
          "lwveg": [
            0.0,
            0.0
          ],
          "lwup": [
            0.0,
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "edge",
        "description": "Tests sparse/bare canopy with zero or minimal plant area index",
        "edge_cases": [
          "zero_dpai",
          "minimal_vegetation"
        ]
      }
    },
    {
      "name": "test_edge_extreme_temperature_gradient",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 0
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "mlcanopy_inst": {
          "ncan": [
            3
          ],
          "ntop": [
            0
          ],
          "nbot": [
            2
          ],
          "tleaf_sun": [
            [
              313.15,
              303.15,
              293.15,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              310.15,
              300.15,
              290.15,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.8,
              0.5,
              0.2,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              0.85,
              0.65,
              0.4,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              1.8,
              2.2,
              2.0,
              0.0,
              0.0
            ]
          ],
          "tg": [
            273.15
          ],
          "lwsky": [
            280.0
          ],
          "itype": [
            1
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0
          ],
          "lwveg": [
            0.0
          ],
          "lwup": [
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "edge",
        "description": "Extreme temperature gradient from hot canopy top to cold ground (40K difference)",
        "edge_cases": [
          "extreme_gradient",
          "cold_ground"
        ]
      }
    },
    {
      "name": "test_edge_full_transmittance",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "mlcanopy_inst": {
          "ncan": [
            2,
            1
          ],
          "ntop": [
            0,
            0
          ],
          "nbot": [
            1,
            0
          ],
          "tleaf_sun": [
            [
              298.15,
              296.15,
              0.0,
              0.0,
              0.0
            ],
            [
              300.15,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              296.15,
              294.15,
              0.0,
              0.0,
              0.0
            ],
            [
              298.15,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.5,
              0.3,
              0.0,
              0.0,
              0.0
            ],
            [
              0.6,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              1.0,
              0.95,
              0.0,
              0.0,
              0.0
            ],
            [
              1.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              0.5,
              0.3,
              0.0,
              0.0,
              0.0
            ],
            [
              0.2,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tg": [
            295.15,
            297.15
          ],
          "lwsky": [
            360.0,
            365.0
          ],
          "itype": [
            2,
            1
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0,
            0.0
          ],
          "lwveg": [
            0.0,
            0.0
          ],
          "lwup": [
            0.0,
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "edge",
        "description": "Very sparse canopy with near-complete transmittance (td=1.0)",
        "edge_cases": [
          "full_transmittance",
          "sparse_canopy"
        ]
      }
    },
    {
      "name": "test_edge_zero_transmittance",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 0
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "mlcanopy_inst": {
          "ncan": [
            2
          ],
          "ntop": [
            0
          ],
          "nbot": [
            1
          ],
          "tleaf_sun": [
            [
              302.15,
              298.15,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              299.15,
              295.15,
              0.0,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.4,
              0.1,
              0.0,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              5.0,
              4.5,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tg": [
            290.15
          ],
          "lwsky": [
            340.0
          ],
          "itype": [
            3
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0
          ],
          "lwveg": [
            0.0
          ],
          "lwup": [
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "edge",
        "description": "Dense canopy with zero transmittance, complete radiation blocking",
        "edge_cases": [
          "zero_transmittance",
          "dense_canopy"
        ]
      }
    },
    {
      "name": "test_special_maximum_canopy_layers",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 0
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "mlcanopy_inst": {
          "ncan": [
            5
          ],
          "ntop": [
            0
          ],
          "nbot": [
            4
          ],
          "tleaf_sun": [
            [
              308.15,
              304.15,
              300.15,
              296.15,
              292.15
            ]
          ],
          "tleaf_sha": [
            [
              305.15,
              301.15,
              297.15,
              293.15,
              289.15
            ]
          ],
          "fracsun": [
            [
              0.8,
              0.65,
              0.5,
              0.35,
              0.2
            ]
          ],
          "td": [
            [
              0.9,
              0.75,
              0.6,
              0.45,
              0.3
            ]
          ],
          "dpai": [
            [
              1.2,
              1.5,
              1.8,
              1.6,
              1.3
            ]
          ],
          "tg": [
            285.15
          ],
          "lwsky": [
            320.0
          ],
          "itype": [
            2
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0
          ],
          "lwveg": [
            0.0
          ],
          "lwup": [
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "special",
        "description": "Maximum canopy layers (5) with full vertical stratification",
        "edge_cases": []
      }
    },
    {
      "name": "test_special_all_shaded_canopy",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "mlcanopy_inst": {
          "ncan": [
            3,
            2
          ],
          "ntop": [
            0,
            0
          ],
          "nbot": [
            2,
            1
          ],
          "tleaf_sun": [
            [
              295.15,
              294.15,
              293.15,
              0.0,
              0.0
            ],
            [
              296.15,
              295.15,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              295.15,
              294.15,
              293.15,
              0.0,
              0.0
            ],
            [
              296.15,
              295.15,
              0.0,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              0.5,
              0.3,
              0.15,
              0.0,
              0.0
            ],
            [
              0.6,
              0.35,
              0.0,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              3.0,
              2.8,
              2.5,
              0.0,
              0.0
            ],
            [
              2.9,
              2.6,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tg": [
            292.15,
            293.15
          ],
          "lwsky": [
            310.0,
            315.0
          ],
          "itype": [
            1,
            2
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0,
            0.0
          ],
          "lwveg": [
            0.0,
            0.0
          ],
          "lwup": [
            0.0,
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "special",
        "description": "Completely shaded canopy (fracsun=0), overcast or dense forest understory",
        "edge_cases": []
      }
    },
    {
      "name": "test_special_high_incoming_radiation",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "mlcanopy_inst": {
          "ncan": [
            2,
            3
          ],
          "ntop": [
            0,
            0
          ],
          "nbot": [
            1,
            2
          ],
          "tleaf_sun": [
            [
              310.15,
              305.15,
              0.0,
              0.0,
              0.0
            ],
            [
              312.15,
              308.15,
              304.15,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              307.15,
              302.15,
              0.0,
              0.0,
              0.0
            ],
            [
              309.15,
              305.15,
              301.15,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.75,
              0.55,
              0.0,
              0.0,
              0.0
            ],
            [
              0.8,
              0.6,
              0.4,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              0.8,
              0.6,
              0.0,
              0.0,
              0.0
            ],
            [
              0.85,
              0.7,
              0.5,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              1.8,
              2.0,
              0.0,
              0.0,
              0.0
            ],
            [
              1.5,
              1.9,
              2.2,
              0.0,
              0.0
            ]
          ],
          "tg": [
            305.15,
            307.15
          ],
          "lwsky": [
            450.0,
            480.0
          ],
          "itype": [
            1,
            3
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0,
            0.0
          ],
          "lwveg": [
            0.0,
            0.0
          ],
          "lwup": [
            0.0,
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "special",
        "description": "High incoming longwave radiation (hot, humid conditions or thick clouds)",
        "edge_cases": []
      }
    },
    {
      "name": "test_edge_boundary_emissivity",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "mlcanopy_inst": {
          "ncan": [
            2,
            1
          ],
          "ntop": [
            0,
            0
          ],
          "nbot": [
            1,
            0
          ],
          "tleaf_sun": [
            [
              298.15,
              296.15,
              0.0,
              0.0,
              0.0
            ],
            [
              300.15,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              296.15,
              294.15,
              0.0,
              0.0,
              0.0
            ],
            [
              298.15,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.6,
              0.4,
              0.0,
              0.0,
              0.0
            ],
            [
              0.7,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              0.7,
              0.5,
              0.0,
              0.0,
              0.0
            ],
            [
              0.75,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              2.0,
              1.8,
              0.0,
              0.0,
              0.0
            ],
            [
              1.5,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tg": [
            293.15,
            295.15
          ],
          "lwsky": [
            345.0,
            350.0
          ],
          "itype": [
            0,
            4
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0,
            0.0
          ],
          "lwveg": [
            0.0,
            0.0
          ],
          "lwup": [
            0.0,
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 1.0,
          "emleaf": [
            0.98,
            1.0,
            0.95,
            0.99,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "edge",
        "description": "Boundary emissivity values (1.0 = perfect blackbody)",
        "edge_cases": [
          "max_emissivity",
          "blackbody"
        ]
      }
    }
  ],
  "notes": "Test data generation assumptions:\n\n1. **Temperature constraints**: All temperatures in Kelvin > 0, with physically realistic ranges:\n   - Ground: 273-310K (0-37\u00b0C)\n   - Leaves: 285-315K (12-42\u00b0C)\n   - Typical gradients: warmer at top, cooler at bottom\n\n2. **Fraction constraints**: fracsun, td, emissivity all in [0,1]\n   - fracsun decreases with canopy depth (less sunlight penetration)\n   - td (transmittance) decreases with canopy depth\n\n3. **Array dimensions**: All arrays sized to (n_patches, nlevcan=5)\n   - Unused layers filled with zeros\n   - ncan indicates active layers\n   - ntop=0 (top layer index), nbot varies by canopy depth\n\n4. **Physical realism**:\n   - dpai (plant area index) >= 0, typical range 0-5 m\u00b2/m\u00b2\n   - lwsky (incoming longwave) range 280-480 W/m\u00b2 (clear to cloudy)\n   - Stefan-Boltzmann constant: 5.67e-8 W/m\u00b2/K\u2074\n\n5. **Edge cases covered**:\n   - Zero/minimal vegetation (dpai=0)\n   - Dense canopy (td=0, high dpai)\n   - Sparse canopy (td=1.0, low dpai)\n   - Extreme temperature gradients (40K difference)\n   - All shaded conditions (fracsun=0)\n   - Maximum emissivity (1.0)\n   - Maximum canopy layers (5)\n   - High incoming radiation (>450 W/m\u00b2)\n\n6. **Test diversity**:\n   - Single and multiple patches\n   - 1-5 canopy layers\n   - Different PFT types (itype 0-4)\n   - Various atmospheric conditions\n   - Different filter configurations\n\n7. **Output arrays**: Initialized to zero, will be populated by function"
}
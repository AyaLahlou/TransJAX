{
  "function_name": "longwave_radiation",
  "test_cases": [
    {
      "name": "test_nominal_single_patch_single_layer",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 0
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "mlcanopy_inst": {
          "ncan": [
            1
          ],
          "ntop": [
            0
          ],
          "nbot": [
            0
          ],
          "tleaf_sun": [
            [
              298.15,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              295.15,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.6,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              0.7,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              2.5,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tg": [
            293.15
          ],
          "lwsky": [
            350.0
          ],
          "itype": [
            1
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0
          ],
          "lwveg": [
            0.0
          ],
          "lwup": [
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "nominal",
        "description": "Single patch with single canopy layer, typical summer conditions",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_multi_patch_multi_layer",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 2
        },
        "num_filter": 3,
        "filter_indices": [
          0,
          1,
          2
        ],
        "mlcanopy_inst": {
          "ncan": [
            3,
            2,
            4
          ],
          "ntop": [
            0,
            0,
            0
          ],
          "nbot": [
            2,
            1,
            3
          ],
          "tleaf_sun": [
            [
              303.15,
              300.15,
              297.15,
              0.0,
              0.0
            ],
            [
              301.15,
              298.15,
              0.0,
              0.0,
              0.0
            ],
            [
              305.15,
              302.15,
              299.15,
              296.15,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              300.15,
              297.15,
              294.15,
              0.0,
              0.0
            ],
            [
              298.15,
              295.15,
              0.0,
              0.0,
              0.0
            ],
            [
              302.15,
              299.15,
              296.15,
              293.15,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.7,
              0.5,
              0.3,
              0.0,
              0.0
            ],
            [
              0.65,
              0.4,
              0.0,
              0.0,
              0.0
            ],
            [
              0.75,
              0.6,
              0.45,
              0.25,
              0.0
            ]
          ],
          "td": [
            [
              0.8,
              0.6,
              0.4,
              0.0,
              0.0
            ],
            [
              0.75,
              0.5,
              0.0,
              0.0,
              0.0
            ],
            [
              0.85,
              0.7,
              0.55,
              0.35,
              0.0
            ]
          ],
          "dpai": [
            [
              1.5,
              2.0,
              1.8,
              0.0,
              0.0
            ],
            [
              2.2,
              1.9,
              0.0,
              0.0,
              0.0
            ],
            [
              1.2,
              1.8,
              2.1,
              1.5,
              0.0
            ]
          ],
          "tg": [
            290.15,
            292.15,
            288.15
          ],
          "lwsky": [
            340.0,
            355.0,
            330.0
          ],
          "itype": [
            2,
            1,
            3
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0,
            0.0,
            0.0
          ],
          "lwveg": [
            0.0,
            0.0,
            0.0
          ],
          "lwup": [
            0.0,
            0.0,
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "nominal",
        "description": "Multiple patches with varying canopy layers, typical forest conditions",
        "edge_cases": []
      }
    },
    {
      "name": "test_edge_zero_plant_area_index",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "mlcanopy_inst": {
          "ncan": [
            1,
            2
          ],
          "ntop": [
            0,
            0
          ],
          "nbot": [
            0,
            1
          ],
          "tleaf_sun": [
            [
              298.15,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              300.15,
              297.15,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              295.15,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              297.15,
              294.15,
              0.0,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.5,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.6,
              0.4,
              0.0,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              0.9,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.8,
              0.6,
              0.0,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.1,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tg": [
            293.15,
            291.15
          ],
          "lwsky": [
            345.0,
            350.0
          ],
          "itype": [
            1,
            2
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0,
            0.0
          ],
          "lwveg": [
            0.0,
            0.0
          ],
          "lwup": [
            0.0,
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "edge",
        "description": "Tests sparse/bare canopy with zero or minimal plant area index",
        "edge_cases": [
          "zero_dpai",
          "minimal_vegetation"
        ]
      }
    },
    {
      "name": "test_edge_extreme_temperature_gradient",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 0
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "mlcanopy_inst": {
          "ncan": [
            3
          ],
          "ntop": [
            0
          ],
          "nbot": [
            2
          ],
          "tleaf_sun": [
            [
              313.15,
              303.15,
              293.15,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              310.15,
              300.15,
              290.15,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.8,
              0.5,
              0.2,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              0.85,
              0.65,
              0.4,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              1.8,
              2.2,
              2.0,
              0.0,
              0.0
            ]
          ],
          "tg": [
            273.15
          ],
          "lwsky": [
            280.0
          ],
          "itype": [
            1
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0
          ],
          "lwveg": [
            0.0
          ],
          "lwup": [
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "edge",
        "description": "Extreme temperature gradient from hot canopy top to cold ground (40K difference)",
        "edge_cases": [
          "extreme_gradient",
          "cold_ground"
        ]
      }
    },
    {
      "name": "test_edge_full_transmittance",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "mlcanopy_inst": {
          "ncan": [
            2,
            1
          ],
          "ntop": [
            0,
            0
          ],
          "nbot": [
            1,
            0
          ],
          "tleaf_sun": [
            [
              298.15,
              296.15,
              0.0,
              0.0,
              0.0
            ],
            [
              300.15,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              296.15,
              294.15,
              0.0,
              0.0,
              0.0
            ],
            [
              298.15,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.9,
              0.7,
              0.0,
              0.0,
              0.0
            ],
            [
              0.95,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              1.0,
              0.95,
              0.0,
              0.0,
              0.0
            ],
            [
              1.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              0.05,
              0.08,
              0.0,
              0.0,
              0.0
            ],
            [
              0.03,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tg": [
            295.15,
            297.15
          ],
          "lwsky": [
            360.0,
            365.0
          ],
          "itype": [
            2,
            1
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0,
            0.0
          ],
          "lwveg": [
            0.0,
            0.0
          ],
          "lwup": [
            0.0,
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "edge",
        "description": "Nearly transparent canopy with transmittance approaching 1.0",
        "edge_cases": [
          "full_transmittance",
          "minimal_interception"
        ]
      }
    },
    {
      "name": "test_edge_zero_transmittance",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 0
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "mlcanopy_inst": {
          "ncan": [
            2
          ],
          "ntop": [
            0
          ],
          "nbot": [
            1
          ],
          "tleaf_sun": [
            [
              302.15,
              298.15,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              299.15,
              295.15,
              0.0,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.3,
              0.1,
              0.0,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              5.0,
              4.5,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tg": [
            294.15
          ],
          "lwsky": [
            340.0
          ],
          "itype": [
            3
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0
          ],
          "lwveg": [
            0.0
          ],
          "lwup": [
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "edge",
        "description": "Dense canopy with zero transmittance, complete radiation interception",
        "edge_cases": [
          "zero_transmittance",
          "dense_canopy"
        ]
      }
    },
    {
      "name": "test_special_maximum_canopy_layers",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 0
        },
        "num_filter": 1,
        "filter_indices": [
          0
        ],
        "mlcanopy_inst": {
          "ncan": [
            5
          ],
          "ntop": [
            0
          ],
          "nbot": [
            4
          ],
          "tleaf_sun": [
            [
              308.15,
              304.15,
              300.15,
              296.15,
              292.15
            ]
          ],
          "tleaf_sha": [
            [
              305.15,
              301.15,
              297.15,
              293.15,
              289.15
            ]
          ],
          "fracsun": [
            [
              0.8,
              0.65,
              0.5,
              0.35,
              0.2
            ]
          ],
          "td": [
            [
              0.9,
              0.75,
              0.6,
              0.45,
              0.3
            ]
          ],
          "dpai": [
            [
              1.2,
              1.5,
              1.8,
              1.6,
              1.3
            ]
          ],
          "tg": [
            288.15
          ],
          "lwsky": [
            335.0
          ],
          "itype": [
            2
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0
          ],
          "lwveg": [
            0.0
          ],
          "lwup": [
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "special",
        "description": "Maximum number of canopy layers (5) with smooth vertical gradient",
        "edge_cases": []
      }
    },
    {
      "name": "test_special_uniform_canopy_properties",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "mlcanopy_inst": {
          "ncan": [
            3,
            3
          ],
          "ntop": [
            0,
            0
          ],
          "nbot": [
            2,
            2
          ],
          "tleaf_sun": [
            [
              298.15,
              298.15,
              298.15,
              0.0,
              0.0
            ],
            [
              300.15,
              300.15,
              300.15,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              298.15,
              298.15,
              298.15,
              0.0,
              0.0
            ],
            [
              300.15,
              300.15,
              300.15,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.5,
              0.5,
              0.5,
              0.0,
              0.0
            ],
            [
              0.5,
              0.5,
              0.5,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              0.7,
              0.7,
              0.7,
              0.0,
              0.0
            ],
            [
              0.7,
              0.7,
              0.7,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              2.0,
              2.0,
              2.0,
              0.0,
              0.0
            ],
            [
              2.0,
              2.0,
              2.0,
              0.0,
              0.0
            ]
          ],
          "tg": [
            298.15,
            300.15
          ],
          "lwsky": [
            400.0,
            410.0
          ],
          "itype": [
            1,
            1
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0,
            0.0
          ],
          "lwveg": [
            0.0,
            0.0
          ],
          "lwup": [
            0.0,
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "special",
        "description": "Uniform canopy properties across all layers (isothermal, homogeneous)",
        "edge_cases": []
      }
    },
    {
      "name": "test_special_high_incoming_radiation",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 1
        },
        "num_filter": 2,
        "filter_indices": [
          0,
          1
        ],
        "mlcanopy_inst": {
          "ncan": [
            2,
            3
          ],
          "ntop": [
            0,
            0
          ],
          "nbot": [
            1,
            2
          ],
          "tleaf_sun": [
            [
              310.15,
              305.15,
              0.0,
              0.0,
              0.0
            ],
            [
              312.15,
              308.15,
              304.15,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              307.15,
              302.15,
              0.0,
              0.0,
              0.0
            ],
            [
              309.15,
              305.15,
              301.15,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.7,
              0.5,
              0.0,
              0.0,
              0.0
            ],
            [
              0.75,
              0.6,
              0.4,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              0.75,
              0.55,
              0.0,
              0.0,
              0.0
            ],
            [
              0.8,
              0.65,
              0.5,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              2.3,
              2.6,
              0.0,
              0.0,
              0.0
            ],
            [
              1.9,
              2.2,
              2.4,
              0.0,
              0.0
            ]
          ],
          "tg": [
            303.15,
            305.15
          ],
          "lwsky": [
            500.0,
            520.0
          ],
          "itype": [
            2,
            3
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0,
            0.0
          ],
          "lwveg": [
            0.0,
            0.0
          ],
          "lwup": [
            0.0,
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 0.96,
          "emleaf": [
            0.98,
            0.97,
            0.96,
            0.95,
            0.98
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "special",
        "description": "High incoming longwave radiation (cloudy/humid conditions)",
        "edge_cases": []
      }
    },
    {
      "name": "test_edge_boundary_emissivity_values",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 2
        },
        "num_filter": 3,
        "filter_indices": [
          0,
          1,
          2
        ],
        "mlcanopy_inst": {
          "ncan": [
            2,
            1,
            2
          ],
          "ntop": [
            0,
            0,
            0
          ],
          "nbot": [
            1,
            0,
            1
          ],
          "tleaf_sun": [
            [
              299.15,
              296.15,
              0.0,
              0.0,
              0.0
            ],
            [
              301.15,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              298.15,
              295.15,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tleaf_sha": [
            [
              297.15,
              294.15,
              0.0,
              0.0,
              0.0
            ],
            [
              299.15,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              296.15,
              293.15,
              0.0,
              0.0,
              0.0
            ]
          ],
          "fracsun": [
            [
              0.6,
              0.4,
              0.0,
              0.0,
              0.0
            ],
            [
              0.7,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.55,
              0.35,
              0.0,
              0.0,
              0.0
            ]
          ],
          "td": [
            [
              0.7,
              0.5,
              0.0,
              0.0,
              0.0
            ],
            [
              0.75,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.68,
              0.48,
              0.0,
              0.0,
              0.0
            ]
          ],
          "dpai": [
            [
              2.1,
              2.3,
              0.0,
              0.0,
              0.0
            ],
            [
              1.8,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              2.4,
              2.5,
              0.0,
              0.0,
              0.0
            ]
          ],
          "tg": [
            293.15,
            295.15,
            291.15
          ],
          "lwsky": [
            345.0,
            355.0,
            340.0
          ],
          "itype": [
            0,
            4,
            1
          ],
          "lwup_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwdn_layer": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sun": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwleaf_sha": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "lwsoi": [
            0.0,
            0.0,
            0.0
          ],
          "lwveg": [
            0.0,
            0.0,
            0.0
          ],
          "lwup": [
            0.0,
            0.0,
            0.0
          ]
        },
        "params": {
          "sb": 5.67e-08,
          "emg": 1.0,
          "emleaf": [
            1.0,
            0.95,
            1.0,
            0.95,
            1.0
          ],
          "nlevcan": 5
        },
        "longwave_type": 1
      },
      "metadata": {
        "type": "edge",
        "description": "Boundary emissivity values (1.0 for perfect blackbody, 0.95 for realistic minimum)",
        "edge_cases": [
          "max_emissivity",
          "varied_pft_emissivity"
        ]
      }
    }
  ],
  "notes": "Test data generation assumptions:\n\n1. **Temperature constraints**: All temperatures in Kelvin > 0, with realistic ranges:\n   - Leaf temperatures: 273.15K - 313.15K (0\u00b0C - 40\u00b0C)\n   - Ground temperatures: 273.15K - 305.15K (0\u00b0C - 32\u00b0C)\n   - Atmospheric longwave: 280-520 W/m\u00b2 (clear to cloudy sky)\n\n2. **Physical constraints**:\n   - fracsun in [0, 1]: sunlit fraction of canopy\n   - td in [0, 1]: transmittance (0=opaque, 1=transparent)\n   - dpai >= 0: plant area index (0-5 m\u00b2/m\u00b2 typical)\n   - emissivity in [0, 1]: typically 0.95-1.0 for vegetation\n\n3. **Array dimensions**:\n   - nlevcan=5 (maximum canopy layers)\n   - Inactive layers filled with zeros\n   - ncan indicates active layers per patch\n   - ntop=0 (top layer index), nbot varies by ncan\n\n4. **Test coverage**:\n   - Nominal: 5 cases (50%) - typical forest/canopy conditions\n   - Edge: 5 cases (50%) - zero PAI, extreme gradients, boundary transmittance/emissivity\n   - Special: Included in mix - max layers, uniform properties, high radiation\n\n5. **Stefan-Boltzmann constant**: 5.67e-8 W/m\u00b2/K\u2074 (standard physical constant)\n\n6. **Filter indices**: Match num_filter and correspond to valid patch indices within bounds\n\n7. **PFT types (itype)**: 0-4 representing different plant functional types with corresponding emleaf values\n\n8. **Output fields**: Initialized to zero, will be populated by function"
}
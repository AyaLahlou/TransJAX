{
  "function_name": "leaf_photosynthesis",
  "test_cases": [
    {
      "name": "test_nominal_c3_single_patch_single_layer",
      "inputs": {
        "c3psn": [
          1.0
        ],
        "g0_BB": [
          0.01
        ],
        "g1_BB": [
          9.0
        ],
        "g0_MED": [
          0.0
        ],
        "g1_MED": [
          4.0
        ],
        "psi50_gs": [
          -2.0
        ],
        "shape_gs": [
          3.0
        ],
        "gsmin_SPA": [
          0.001
        ],
        "iota_SPA": [
          750.0
        ],
        "tacclim": [
          298.15
        ],
        "ncan": [
          1
        ],
        "dpai": [
          [
            2.5
          ]
        ],
        "eair": [
          [
            1500.0
          ]
        ],
        "o2ref": [
          209.0
        ],
        "pref": [
          101325.0
        ],
        "cair": [
          [
            [
              400.0,
              400.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              60.0,
              60.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              120.0,
              120.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0,
              0.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.0,
              1.0
            ]
          ]
        ],
        "tleaf": [
          [
            [
              298.15,
              298.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.5,
              1.5
            ]
          ]
        ],
        "gbc": [
          [
            [
              1.0,
              1.0
            ]
          ]
        ],
        "apar": [
          [
            [
              1000.0,
              1000.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.5,
              -0.5
            ]
          ]
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard C3 photosynthesis with typical temperate conditions, single patch, single canopy layer, sunlit and shaded leaves",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_c4_multiple_patches",
      "inputs": {
        "c3psn": [
          0.0,
          0.0,
          0.0
        ],
        "g0_BB": [
          0.04,
          0.04,
          0.04
        ],
        "g1_BB": [
          4.0,
          4.0,
          4.0
        ],
        "g0_MED": [
          0.0,
          0.0,
          0.0
        ],
        "g1_MED": [
          1.6,
          1.6,
          1.6
        ],
        "psi50_gs": [
          -1.5,
          -1.5,
          -1.5
        ],
        "shape_gs": [
          2.5,
          2.5,
          2.5
        ],
        "gsmin_SPA": [
          0.001,
          0.001,
          0.001
        ],
        "iota_SPA": [
          1000.0,
          1000.0,
          1000.0
        ],
        "tacclim": [
          303.15,
          303.15,
          303.15
        ],
        "ncan": [
          2,
          2,
          2
        ],
        "dpai": [
          [
            1.5,
            1.0
          ],
          [
            2.0,
            1.5
          ],
          [
            1.8,
            1.2
          ]
        ],
        "eair": [
          [
            2000.0,
            1800.0
          ],
          [
            2100.0,
            1900.0
          ],
          [
            2050.0,
            1850.0
          ]
        ],
        "o2ref": [
          209.0,
          209.0,
          209.0
        ],
        "pref": [
          101325.0,
          101325.0,
          101325.0
        ],
        "cair": [
          [
            [
              380.0,
              380.0
            ],
            [
              370.0,
              370.0
            ]
          ],
          [
            [
              390.0,
              390.0
            ],
            [
              380.0,
              380.0
            ]
          ],
          [
            [
              385.0,
              385.0
            ],
            [
              375.0,
              375.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              80.0,
              80.0
            ],
            [
              70.0,
              70.0
            ]
          ],
          [
            [
              85.0,
              85.0
            ],
            [
              75.0,
              75.0
            ]
          ],
          [
            [
              82.0,
              82.0
            ],
            [
              72.0,
              72.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              0.0,
              0.0
            ],
            [
              0.0,
              0.0
            ]
          ],
          [
            [
              0.0,
              0.0
            ],
            [
              0.0,
              0.0
            ]
          ],
          [
            [
              0.0,
              0.0
            ],
            [
              0.0,
              0.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.8,
              0.8
            ],
            [
              0.7,
              0.7
            ]
          ],
          [
            [
              0.85,
              0.85
            ],
            [
              0.75,
              0.75
            ]
          ],
          [
            [
              0.82,
              0.82
            ],
            [
              0.72,
              0.72
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.5,
              1.5
            ],
            [
              1.3,
              1.3
            ]
          ],
          [
            [
              1.6,
              1.6
            ],
            [
              1.4,
              1.4
            ]
          ],
          [
            [
              1.55,
              1.55
            ],
            [
              1.35,
              1.35
            ]
          ]
        ],
        "tleaf": [
          [
            [
              303.15,
              303.15
            ],
            [
              302.15,
              302.15
            ]
          ],
          [
            [
              304.15,
              304.15
            ],
            [
              303.15,
              303.15
            ]
          ],
          [
            [
              303.65,
              303.65
            ],
            [
              302.65,
              302.65
            ]
          ]
        ],
        "gbv": [
          [
            [
              2.0,
              2.0
            ],
            [
              1.8,
              1.8
            ]
          ],
          [
            [
              2.1,
              2.1
            ],
            [
              1.9,
              1.9
            ]
          ],
          [
            [
              2.05,
              2.05
            ],
            [
              1.85,
              1.85
            ]
          ]
        ],
        "gbc": [
          [
            [
              1.3,
              1.3
            ],
            [
              1.2,
              1.2
            ]
          ],
          [
            [
              1.4,
              1.4
            ],
            [
              1.25,
              1.25
            ]
          ],
          [
            [
              1.35,
              1.35
            ],
            [
              1.22,
              1.22
            ]
          ]
        ],
        "apar": [
          [
            [
              1500.0,
              500.0
            ],
            [
              800.0,
              200.0
            ]
          ],
          [
            [
              1600.0,
              550.0
            ],
            [
              850.0,
              220.0
            ]
          ],
          [
            [
              1550.0,
              525.0
            ],
            [
              825.0,
              210.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.8,
              -0.8
            ],
            [
              -0.6,
              -0.6
            ]
          ],
          [
            [
              -0.9,
              -0.9
            ],
            [
              -0.7,
              -0.7
            ]
          ],
          [
            [
              -0.85,
              -0.85
            ],
            [
              -0.65,
              -0.65
            ]
          ]
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "C4 photosynthesis with multiple patches, two canopy layers each, warm conditions typical of tropical/subtropical grasslands",
        "edge_cases": []
      }
    },
    {
      "name": "test_edge_zero_par_dark_respiration",
      "inputs": {
        "c3psn": [
          1.0
        ],
        "g0_BB": [
          0.01
        ],
        "g1_BB": [
          9.0
        ],
        "g0_MED": [
          0.0
        ],
        "g1_MED": [
          4.0
        ],
        "psi50_gs": [
          -2.0
        ],
        "shape_gs": [
          3.0
        ],
        "gsmin_SPA": [
          0.001
        ],
        "iota_SPA": [
          750.0
        ],
        "tacclim": [
          293.15
        ],
        "ncan": [
          1
        ],
        "dpai": [
          [
            3.0
          ]
        ],
        "eair": [
          [
            1200.0
          ]
        ],
        "o2ref": [
          209.0
        ],
        "pref": [
          101325.0
        ],
        "cair": [
          [
            [
              400.0,
              400.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              50.0,
              50.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              100.0,
              100.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0,
              0.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              0.8,
              0.8
            ]
          ]
        ],
        "tleaf": [
          [
            [
              293.15,
              293.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.2,
              1.2
            ]
          ]
        ],
        "gbc": [
          [
            [
              0.8,
              0.8
            ]
          ]
        ],
        "apar": [
          [
            [
              0.0,
              0.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -1.0,
              -1.0
            ]
          ]
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Zero PAR condition testing dark respiration only, no photosynthesis expected",
        "edge_cases": [
          "zero_par",
          "dark_respiration"
        ]
      }
    },
    {
      "name": "test_edge_severe_water_stress",
      "inputs": {
        "c3psn": [
          1.0,
          0.0
        ],
        "g0_BB": [
          0.01,
          0.04
        ],
        "g1_BB": [
          9.0,
          4.0
        ],
        "g0_MED": [
          0.0,
          0.0
        ],
        "g1_MED": [
          4.0,
          1.6
        ],
        "psi50_gs": [
          -1.5,
          -1.2
        ],
        "shape_gs": [
          4.0,
          3.5
        ],
        "gsmin_SPA": [
          0.001,
          0.001
        ],
        "iota_SPA": [
          750.0,
          1000.0
        ],
        "tacclim": [
          298.15,
          303.15
        ],
        "ncan": [
          1,
          1
        ],
        "dpai": [
          [
            2.0
          ],
          [
            2.5
          ]
        ],
        "eair": [
          [
            1000.0
          ],
          [
            1500.0
          ]
        ],
        "o2ref": [
          209.0,
          209.0
        ],
        "pref": [
          101325.0,
          101325.0
        ],
        "cair": [
          [
            [
              400.0,
              400.0
            ]
          ],
          [
            [
              380.0,
              380.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              55.0,
              55.0
            ]
          ],
          [
            [
              75.0,
              75.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              110.0,
              110.0
            ]
          ],
          [
            [
              0.0,
              0.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0,
              0.0
            ]
          ],
          [
            [
              0.75,
              0.75
            ]
          ]
        ],
        "rd25": [
          [
            [
              0.9,
              0.9
            ]
          ],
          [
            [
              1.4,
              1.4
            ]
          ]
        ],
        "tleaf": [
          [
            [
              298.15,
              298.15
            ]
          ],
          [
            [
              303.15,
              303.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.4,
              1.4
            ]
          ],
          [
            [
              1.9,
              1.9
            ]
          ]
        ],
        "gbc": [
          [
            [
              0.9,
              0.9
            ]
          ],
          [
            [
              1.25,
              1.25
            ]
          ]
        ],
        "apar": [
          [
            [
              800.0,
              300.0
            ]
          ],
          [
            [
              1200.0,
              400.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -4.5,
              -4.5
            ]
          ],
          [
            [
              -3.8,
              -3.8
            ]
          ]
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Severe water stress with leaf water potential well below psi50, testing stomatal closure and reduced photosynthesis",
        "edge_cases": [
          "severe_water_stress",
          "near_wilting_point"
        ]
      }
    },
    {
      "name": "test_edge_extreme_temperature_cold",
      "inputs": {
        "c3psn": [
          1.0
        ],
        "g0_BB": [
          0.01
        ],
        "g1_BB": [
          9.0
        ],
        "g0_MED": [
          0.0
        ],
        "g1_MED": [
          4.0
        ],
        "psi50_gs": [
          -2.5
        ],
        "shape_gs": [
          3.0
        ],
        "gsmin_SPA": [
          0.001
        ],
        "iota_SPA": [
          750.0
        ],
        "tacclim": [
          278.15
        ],
        "ncan": [
          1
        ],
        "dpai": [
          [
            2.0
          ]
        ],
        "eair": [
          [
            500.0
          ]
        ],
        "o2ref": [
          209.0
        ],
        "pref": [
          101325.0
        ],
        "cair": [
          [
            [
              420.0,
              420.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              45.0,
              45.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              90.0,
              90.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0,
              0.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              0.7,
              0.7
            ]
          ]
        ],
        "tleaf": [
          [
            [
              278.15,
              278.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.0,
              1.0
            ]
          ]
        ],
        "gbc": [
          [
            [
              0.7,
              0.7
            ]
          ]
        ],
        "apar": [
          [
            [
              600.0,
              200.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.3,
              -0.3
            ]
          ]
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Cold temperature (5\u00b0C) testing low-temperature enzyme kinetics and reduced photosynthetic capacity",
        "edge_cases": [
          "cold_temperature",
          "low_vapor_pressure"
        ]
      }
    },
    {
      "name": "test_edge_extreme_temperature_hot",
      "inputs": {
        "c3psn": [
          0.0
        ],
        "g0_BB": [
          0.04
        ],
        "g1_BB": [
          4.0
        ],
        "g0_MED": [
          0.0
        ],
        "g1_MED": [
          1.6
        ],
        "psi50_gs": [
          -1.0
        ],
        "shape_gs": [
          2.0
        ],
        "gsmin_SPA": [
          0.001
        ],
        "iota_SPA": [
          1000.0
        ],
        "tacclim": [
          313.15
        ],
        "ncan": [
          1
        ],
        "dpai": [
          [
            1.5
          ]
        ],
        "eair": [
          [
            3500.0
          ]
        ],
        "o2ref": [
          209.0
        ],
        "pref": [
          101325.0
        ],
        "cair": [
          [
            [
              360.0,
              360.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              90.0,
              90.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              0.0,
              0.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.9,
              0.9
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.8,
              1.8
            ]
          ]
        ],
        "tleaf": [
          [
            [
              313.15,
              313.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              2.5,
              2.5
            ]
          ]
        ],
        "gbc": [
          [
            [
              1.6,
              1.6
            ]
          ]
        ],
        "apar": [
          [
            [
              2000.0,
              800.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -1.5,
              -1.5
            ]
          ]
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Hot temperature (40\u00b0C) testing high-temperature enzyme deactivation and heat stress in C4 plant",
        "edge_cases": [
          "hot_temperature",
          "high_vapor_pressure",
          "heat_stress"
        ]
      }
    },
    {
      "name": "test_edge_minimal_conductance_parameters",
      "inputs": {
        "c3psn": [
          1.0
        ],
        "g0_BB": [
          0.0
        ],
        "g1_BB": [
          0.0
        ],
        "g0_MED": [
          0.0
        ],
        "g1_MED": [
          0.0
        ],
        "psi50_gs": [
          -2.0
        ],
        "shape_gs": [
          3.0
        ],
        "gsmin_SPA": [
          0.0001
        ],
        "iota_SPA": [
          500.0
        ],
        "tacclim": [
          298.15
        ],
        "ncan": [
          1
        ],
        "dpai": [
          [
            1.0
          ]
        ],
        "eair": [
          [
            1500.0
          ]
        ],
        "o2ref": [
          209.0
        ],
        "pref": [
          101325.0
        ],
        "cair": [
          [
            [
              400.0,
              400.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              40.0,
              40.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              80.0,
              80.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0,
              0.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              0.6,
              0.6
            ]
          ]
        ],
        "tleaf": [
          [
            [
              298.15,
              298.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.0,
              1.0
            ]
          ]
        ],
        "gbc": [
          [
            [
              0.65,
              0.65
            ]
          ]
        ],
        "apar": [
          [
            [
              500.0,
              100.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.5,
              -0.5
            ]
          ]
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Minimal stomatal conductance parameters (g0=0, g1=0) testing lower bounds of gas exchange",
        "edge_cases": [
          "zero_conductance_params",
          "minimal_stomatal_opening"
        ]
      }
    },
    {
      "name": "test_special_high_elevation_low_pressure",
      "inputs": {
        "c3psn": [
          1.0,
          1.0
        ],
        "g0_BB": [
          0.01,
          0.01
        ],
        "g1_BB": [
          9.0,
          9.0
        ],
        "g0_MED": [
          0.0,
          0.0
        ],
        "g1_MED": [
          4.0,
          4.0
        ],
        "psi50_gs": [
          -2.5,
          -2.5
        ],
        "shape_gs": [
          3.5,
          3.5
        ],
        "gsmin_SPA": [
          0.001,
          0.001
        ],
        "iota_SPA": [
          750.0,
          750.0
        ],
        "tacclim": [
          283.15,
          283.15
        ],
        "ncan": [
          1,
          1
        ],
        "dpai": [
          [
            1.5
          ],
          [
            1.8
          ]
        ],
        "eair": [
          [
            800.0
          ],
          [
            850.0
          ]
        ],
        "o2ref": [
          209.0,
          209.0
        ],
        "pref": [
          70000.0,
          70000.0
        ],
        "cair": [
          [
            [
              400.0,
              400.0
            ]
          ],
          [
            [
              400.0,
              400.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              50.0,
              50.0
            ]
          ],
          [
            [
              52.0,
              52.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              100.0,
              100.0
            ]
          ],
          [
            [
              104.0,
              104.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0,
              0.0
            ]
          ],
          [
            [
              0.0,
              0.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              0.8,
              0.8
            ]
          ],
          [
            [
              0.85,
              0.85
            ]
          ]
        ],
        "tleaf": [
          [
            [
              283.15,
              283.15
            ]
          ],
          [
            [
              283.15,
              283.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.1,
              1.1
            ]
          ],
          [
            [
              1.15,
              1.15
            ]
          ]
        ],
        "gbc": [
          [
            [
              0.75,
              0.75
            ]
          ],
          [
            [
              0.78,
              0.78
            ]
          ]
        ],
        "apar": [
          [
            [
              900.0,
              400.0
            ]
          ],
          [
            [
              950.0,
              420.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.4,
              -0.4
            ]
          ],
          [
            [
              -0.45,
              -0.45
            ]
          ]
        ]
      },
      "metadata": {
        "type": "special",
        "description": "High elevation conditions (~3000m) with reduced atmospheric pressure (70 kPa) affecting gas exchange and O2/CO2 partial pressures",
        "edge_cases": [
          "low_atmospheric_pressure",
          "high_elevation"
        ]
      }
    },
    {
      "name": "test_special_multi_layer_canopy_gradient",
      "inputs": {
        "c3psn": [
          1.0
        ],
        "g0_BB": [
          0.01
        ],
        "g1_BB": [
          9.0
        ],
        "g0_MED": [
          0.0
        ],
        "g1_MED": [
          4.0
        ],
        "psi50_gs": [
          -2.0
        ],
        "shape_gs": [
          3.0
        ],
        "gsmin_SPA": [
          0.001
        ],
        "iota_SPA": [
          750.0
        ],
        "tacclim": [
          298.15
        ],
        "ncan": [
          5
        ],
        "dpai": [
          [
            1.0,
            1.2,
            1.5,
            1.0,
            0.8
          ]
        ],
        "eair": [
          [
            1800.0,
            1750.0,
            1700.0,
            1650.0,
            1600.0
          ]
        ],
        "o2ref": [
          209.0
        ],
        "pref": [
          101325.0
        ],
        "cair": [
          [
            [
              400.0,
              400.0
            ],
            [
              395.0,
              395.0
            ],
            [
              390.0,
              390.0
            ],
            [
              385.0,
              385.0
            ],
            [
              380.0,
              380.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              65.0,
              65.0
            ],
            [
              60.0,
              60.0
            ],
            [
              55.0,
              55.0
            ],
            [
              50.0,
              50.0
            ],
            [
              45.0,
              45.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              130.0,
              130.0
            ],
            [
              120.0,
              120.0
            ],
            [
              110.0,
              110.0
            ],
            [
              100.0,
              100.0
            ],
            [
              90.0,
              90.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0,
              0.0
            ],
            [
              0.0,
              0.0
            ],
            [
              0.0,
              0.0
            ],
            [
              0.0,
              0.0
            ],
            [
              0.0,
              0.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.1,
              1.1
            ],
            [
              1.0,
              1.0
            ],
            [
              0.9,
              0.9
            ],
            [
              0.8,
              0.8
            ],
            [
              0.7,
              0.7
            ]
          ]
        ],
        "tleaf": [
          [
            [
              299.15,
              299.15
            ],
            [
              298.65,
              298.65
            ],
            [
              298.15,
              298.15
            ],
            [
              297.65,
              297.65
            ],
            [
              297.15,
              297.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.8,
              1.8
            ],
            [
              1.6,
              1.6
            ],
            [
              1.4,
              1.4
            ],
            [
              1.2,
              1.2
            ],
            [
              1.0,
              1.0
            ]
          ]
        ],
        "gbc": [
          [
            [
              1.2,
              1.2
            ],
            [
              1.05,
              1.05
            ],
            [
              0.9,
              0.9
            ],
            [
              0.8,
              0.8
            ],
            [
              0.7,
              0.7
            ]
          ]
        ],
        "apar": [
          [
            [
              1800.0,
              600.0
            ],
            [
              1200.0,
              400.0
            ],
            [
              700.0,
              250.0
            ],
            [
              350.0,
              120.0
            ],
            [
              150.0,
              50.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.3,
              -0.3
            ],
            [
              -0.4,
              -0.4
            ],
            [
              -0.5,
              -0.5
            ],
            [
              -0.6,
              -0.6
            ],
            [
              -0.7,
              -0.7
            ]
          ]
        ]
      },
      "metadata": {
        "type": "special",
        "description": "Five-layer canopy with realistic vertical gradients in PAR, temperature, CO2, vcmax, and leaf water potential from top to bottom",
        "edge_cases": [
          "multi_layer_gradient",
          "light_extinction"
        ]
      }
    },
    {
      "name": "test_special_mixed_c3_c4_comparison",
      "inputs": {
        "c3psn": [
          1.0,
          0.0,
          1.0,
          0.0
        ],
        "g0_BB": [
          0.01,
          0.04,
          0.01,
          0.04
        ],
        "g1_BB": [
          9.0,
          4.0,
          9.0,
          4.0
        ],
        "g0_MED": [
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g1_MED": [
          4.0,
          1.6,
          4.0,
          1.6
        ],
        "psi50_gs": [
          -2.0,
          -1.5,
          -2.0,
          -1.5
        ],
        "shape_gs": [
          3.0,
          2.5,
          3.0,
          2.5
        ],
        "gsmin_SPA": [
          0.001,
          0.001,
          0.001,
          0.001
        ],
        "iota_SPA": [
          750.0,
          1000.0,
          750.0,
          1000.0
        ],
        "tacclim": [
          298.15,
          303.15,
          298.15,
          303.15
        ],
        "ncan": [
          1,
          1,
          1,
          1
        ],
        "dpai": [
          [
            2.5
          ],
          [
            2.0
          ],
          [
            2.5
          ],
          [
            2.0
          ]
        ],
        "eair": [
          [
            1500.0
          ],
          [
            2000.0
          ],
          [
            1500.0
          ],
          [
            2000.0
          ]
        ],
        "o2ref": [
          209.0,
          209.0,
          209.0,
          209.0
        ],
        "pref": [
          101325.0,
          101325.0,
          101325.0,
          101325.0
        ],
        "cair": [
          [
            [
              400.0,
              400.0
            ]
          ],
          [
            [
              380.0,
              380.0
            ]
          ],
          [
            [
              400.0,
              400.0
            ]
          ],
          [
            [
              380.0,
              380.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              60.0,
              60.0
            ]
          ],
          [
            [
              80.0,
              80.0
            ]
          ],
          [
            [
              60.0,
              60.0
            ]
          ],
          [
            [
              80.0,
              80.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              120.0,
              120.0
            ]
          ],
          [
            [
              0.0,
              0.0
            ]
          ],
          [
            [
              120.0,
              120.0
            ]
          ],
          [
            [
              0.0,
              0.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0,
              0.0
            ]
          ],
          [
            [
              0.8,
              0.8
            ]
          ],
          [
            [
              0.0,
              0.0
            ]
          ],
          [
            [
              0.8,
              0.8
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.0,
              1.0
            ]
          ],
          [
            [
              1.5,
              1.5
            ]
          ],
          [
            [
              1.0,
              1.0
            ]
          ],
          [
            [
              1.5,
              1.5
            ]
          ]
        ],
        "tleaf": [
          [
            [
              298.15,
              298.15
            ]
          ],
          [
            [
              303.15,
              303.15
            ]
          ],
          [
            [
              298.15,
              298.15
            ]
          ],
          [
            [
              303.15,
              303.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.5,
              1.5
            ]
          ],
          [
            [
              2.0,
              2.0
            ]
          ],
          [
            [
              1.5,
              1.5
            ]
          ],
          [
            [
              2.0,
              2.0
            ]
          ]
        ],
        "gbc": [
          [
            [
              1.0,
              1.0
            ]
          ],
          [
            [
              1.3,
              1.3
            ]
          ],
          [
            [
              1.0,
              1.0
            ]
          ],
          [
            [
              1.3,
              1.3
            ]
          ]
        ],
        "apar": [
          [
            [
              1000.0,
              300.0
            ]
          ],
          [
            [
              1500.0,
              500.0
            ]
          ],
          [
            [
              1000.0,
              300.0
            ]
          ],
          [
            [
              1500.0,
              500.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.5,
              -0.5
            ]
          ],
          [
            [
              -0.8,
              -0.8
            ]
          ],
          [
            [
              -0.5,
              -0.5
            ]
          ],
          [
            [
              -0.8,
              -0.8
            ]
          ]
        ]
      },
      "metadata": {
        "type": "special",
        "description": "Direct comparison of C3 vs C4 photosynthesis under identical environmental conditions to test pathway differences",
        "edge_cases": []
      }
    }
  ],
  "notes": "Test data generation assumptions and methodology:\n\n1. **Physical Realism**: All temperatures are in Kelvin (>273.15K), pressures are positive, leaf water potentials are negative (tension), and fractions/indices are non-negative.\n\n2. **Dimensional Consistency**: Within each test case, array dimensions are consistent:\n   - n_patches varies from 1-4\n   - n_layers varies from 1-5\n   - n_leaf is always 2 (sunlit and shaded leaves)\n   - All arrays properly broadcast according to their specified shapes\n\n3. **C3 vs C4 Differentiation**:\n   - C3 plants: c3psn=1.0, jmax25>0, kp25=0\n   - C4 plants: c3psn=0.0, jmax25=0, kp25>0\n   - Different stomatal conductance parameters (g0_BB, g1_BB higher for C3)\n\n4. **Typical Value Ranges**:\n   - vcmax25: 40-90 \u03bcmol/m\u00b2/s\n   - jmax25 (C3): ~2\u00d7 vcmax25\n   - kp25 (C4): 0.7-0.9 mol/m\u00b2/s\n   - rd25: ~1-2% of vcmax25\n   - PAR: 0-2000 \u03bcmol photon/m\u00b2/s\n   - Leaf temperature: 273-313K (0-40\u00b0C)\n   - Atmospheric CO2: 360-420 ppm\n   - Leaf water potential: 0 to -5 MPa\n\n5. **Canopy Gradients**: Multi-layer tests include realistic vertical profiles:\n   - PAR decreases exponentially with depth\n   - Temperature decreases slightly with depth\n   - CO2 decreases with depth (uptake)\n   - vcmax/jmax decrease with depth (nitrogen gradient)\n   - Leaf water potential becomes more negative with height\n\n6. **Edge Cases Cover**:\n   - Zero PAR (dark respiration)\n   - Severe water stress (lwp << psi50_gs)\n   - Temperature extremes (cold: 5\u00b0C, hot: 40\u00b0C)\n   - Minimal conductance parameters\n   - Low atmospheric pressure (high elevation)\n\n7. **Boundary Layer Conductances**: gbv (H2O) is typically 1.3-1.6\u00d7 gbc (CO2) due to diffusivity differences.\n\n8. **Vapor Pressure**: eair values are realistic for given temperatures, ranging from ~500 Pa (cold, dry) to ~3500 Pa (hot, humid).\n\n9. **Test Coverage**: Tests span nominal operations (50%), edge cases (30%), and special scenarios (20%) including multi-layer canopies, elevation effects, and C3/C4 comparisons."
}
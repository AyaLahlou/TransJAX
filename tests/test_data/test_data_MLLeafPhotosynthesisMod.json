{
  "function_name": "leaf_photosynthesis",
  "test_cases": [
    {
      "name": "test_nominal_c3_single_patch_single_layer",
      "inputs": {
        "c3psn": [
          1.0
        ],
        "g0_BB": [
          0.01
        ],
        "g1_BB": [
          9.0
        ],
        "g0_MED": [
          0.0
        ],
        "g1_MED": [
          4.0
        ],
        "psi50_gs": [
          -2.0
        ],
        "shape_gs": [
          3.0
        ],
        "gsmin_SPA": [
          0.001
        ],
        "iota_SPA": [
          0.0001
        ],
        "tacclim": [
          298.15
        ],
        "ncan": [
          1
        ],
        "dpai": [
          [
            2.5
          ]
        ],
        "eair": [
          [
            1500.0
          ]
        ],
        "o2ref": [
          209.0
        ],
        "pref": [
          101325.0
        ],
        "cair": [
          [
            [
              400.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              60.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              120.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.2
            ]
          ]
        ],
        "tleaf": [
          [
            [
              298.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.5
            ]
          ]
        ],
        "gbc": [
          [
            [
              1.0
            ]
          ]
        ],
        "apar": [
          [
            [
              1000.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.5
            ]
          ]
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard C3 photosynthesis under optimal conditions with single patch, single layer, single leaf",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_c4_multiple_patches",
      "inputs": {
        "c3psn": [
          0.0,
          0.0,
          0.0
        ],
        "g0_BB": [
          0.04,
          0.04,
          0.04
        ],
        "g1_BB": [
          4.0,
          4.0,
          4.0
        ],
        "g0_MED": [
          0.0,
          0.0,
          0.0
        ],
        "g1_MED": [
          1.6,
          1.6,
          1.6
        ],
        "psi50_gs": [
          -1.5,
          -1.5,
          -1.5
        ],
        "shape_gs": [
          2.5,
          2.5,
          2.5
        ],
        "gsmin_SPA": [
          0.001,
          0.001,
          0.001
        ],
        "iota_SPA": [
          0.0001,
          0.0001,
          0.0001
        ],
        "tacclim": [
          303.15,
          303.15,
          303.15
        ],
        "ncan": [
          2,
          2,
          2
        ],
        "dpai": [
          [
            1.5,
            1.0
          ],
          [
            2.0,
            1.5
          ],
          [
            1.8,
            1.2
          ]
        ],
        "eair": [
          [
            1800.0,
            1700.0
          ],
          [
            1900.0,
            1800.0
          ],
          [
            1850.0,
            1750.0
          ]
        ],
        "o2ref": [
          209.0,
          209.0,
          209.0
        ],
        "pref": [
          101325.0,
          101325.0,
          101325.0
        ],
        "cair": [
          [
            [
              380.0
            ],
            [
              370.0
            ]
          ],
          [
            [
              390.0
            ],
            [
              380.0
            ]
          ],
          [
            [
              385.0
            ],
            [
              375.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              80.0
            ],
            [
              70.0
            ]
          ],
          [
            [
              85.0
            ],
            [
              75.0
            ]
          ],
          [
            [
              82.0
            ],
            [
              72.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              160.0
            ],
            [
              140.0
            ]
          ],
          [
            [
              170.0
            ],
            [
              150.0
            ]
          ],
          [
            [
              165.0
            ],
            [
              145.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              50.0
            ],
            [
              45.0
            ]
          ],
          [
            [
              55.0
            ],
            [
              50.0
            ]
          ],
          [
            [
              52.0
            ],
            [
              47.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.6
            ],
            [
              1.4
            ]
          ],
          [
            [
              1.7
            ],
            [
              1.5
            ]
          ],
          [
            [
              1.65
            ],
            [
              1.45
            ]
          ]
        ],
        "tleaf": [
          [
            [
              303.15
            ],
            [
              302.15
            ]
          ],
          [
            [
              304.15
            ],
            [
              303.15
            ]
          ],
          [
            [
              303.65
            ],
            [
              302.65
            ]
          ]
        ],
        "gbv": [
          [
            [
              2.0
            ],
            [
              1.8
            ]
          ],
          [
            [
              2.2
            ],
            [
              2.0
            ]
          ],
          [
            [
              2.1
            ],
            [
              1.9
            ]
          ]
        ],
        "gbc": [
          [
            [
              1.3
            ],
            [
              1.2
            ]
          ],
          [
            [
              1.4
            ],
            [
              1.3
            ]
          ],
          [
            [
              1.35
            ],
            [
              1.25
            ]
          ]
        ],
        "apar": [
          [
            [
              1500.0
            ],
            [
              800.0
            ]
          ],
          [
            [
              1600.0
            ],
            [
              900.0
            ]
          ],
          [
            [
              1550.0
            ],
            [
              850.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.3
            ],
            [
              -0.4
            ]
          ],
          [
            [
              -0.35
            ],
            [
              -0.45
            ]
          ],
          [
            [
              -0.32
            ],
            [
              -0.42
            ]
          ]
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "C4 photosynthesis with multiple patches and canopy layers representing typical crop conditions",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_mixed_c3_c4_multilayer",
      "inputs": {
        "c3psn": [
          1.0,
          0.0
        ],
        "g0_BB": [
          0.01,
          0.04
        ],
        "g1_BB": [
          9.0,
          4.0
        ],
        "g0_MED": [
          0.0,
          0.0
        ],
        "g1_MED": [
          4.0,
          1.6
        ],
        "psi50_gs": [
          -2.0,
          -1.5
        ],
        "shape_gs": [
          3.0,
          2.5
        ],
        "gsmin_SPA": [
          0.001,
          0.001
        ],
        "iota_SPA": [
          0.0001,
          0.0001
        ],
        "tacclim": [
          298.15,
          303.15
        ],
        "ncan": [
          3,
          3
        ],
        "dpai": [
          [
            2.0,
            1.5,
            1.0
          ],
          [
            1.8,
            1.3,
            0.8
          ]
        ],
        "eair": [
          [
            1500.0,
            1450.0,
            1400.0
          ],
          [
            1800.0,
            1750.0,
            1700.0
          ]
        ],
        "o2ref": [
          209.0,
          209.0
        ],
        "pref": [
          101325.0,
          101325.0
        ],
        "cair": [
          [
            [
              400.0,
              410.0
            ],
            [
              395.0,
              405.0
            ],
            [
              390.0,
              400.0
            ]
          ],
          [
            [
              380.0,
              390.0
            ],
            [
              375.0,
              385.0
            ],
            [
              370.0,
              380.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              60.0,
              55.0
            ],
            [
              50.0,
              45.0
            ],
            [
              40.0,
              35.0
            ]
          ],
          [
            [
              80.0,
              75.0
            ],
            [
              70.0,
              65.0
            ],
            [
              60.0,
              55.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              120.0,
              110.0
            ],
            [
              100.0,
              90.0
            ],
            [
              80.0,
              70.0
            ]
          ],
          [
            [
              160.0,
              150.0
            ],
            [
              140.0,
              130.0
            ],
            [
              120.0,
              110.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0,
              0.0
            ],
            [
              0.0,
              0.0
            ],
            [
              0.0,
              0.0
            ]
          ],
          [
            [
              50.0,
              48.0
            ],
            [
              45.0,
              43.0
            ],
            [
              40.0,
              38.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.2,
              1.1
            ],
            [
              1.0,
              0.9
            ],
            [
              0.8,
              0.7
            ]
          ],
          [
            [
              1.6,
              1.5
            ],
            [
              1.4,
              1.3
            ],
            [
              1.2,
              1.1
            ]
          ]
        ],
        "tleaf": [
          [
            [
              298.15,
              299.15
            ],
            [
              297.15,
              298.15
            ],
            [
              296.15,
              297.15
            ]
          ],
          [
            [
              303.15,
              304.15
            ],
            [
              302.15,
              303.15
            ],
            [
              301.15,
              302.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.5,
              1.6
            ],
            [
              1.4,
              1.5
            ],
            [
              1.3,
              1.4
            ]
          ],
          [
            [
              2.0,
              2.1
            ],
            [
              1.9,
              2.0
            ],
            [
              1.8,
              1.9
            ]
          ]
        ],
        "gbc": [
          [
            [
              1.0,
              1.05
            ],
            [
              0.95,
              1.0
            ],
            [
              0.9,
              0.95
            ]
          ],
          [
            [
              1.3,
              1.35
            ],
            [
              1.25,
              1.3
            ],
            [
              1.2,
              1.25
            ]
          ]
        ],
        "apar": [
          [
            [
              1200.0,
              1100.0
            ],
            [
              800.0,
              700.0
            ],
            [
              400.0,
              300.0
            ]
          ],
          [
            [
              1500.0,
              1400.0
            ],
            [
              1000.0,
              900.0
            ],
            [
              500.0,
              400.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.5,
              -0.6
            ],
            [
              -0.7,
              -0.8
            ],
            [
              -0.9,
              -1.0
            ]
          ],
          [
            [
              -0.3,
              -0.4
            ],
            [
              -0.5,
              -0.6
            ],
            [
              -0.7,
              -0.8
            ]
          ]
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Mixed C3 and C4 vegetation with multiple canopy layers and sunlit/shaded leaves",
        "edge_cases": []
      }
    },
    {
      "name": "test_edge_zero_apar_low_light",
      "inputs": {
        "c3psn": [
          1.0,
          1.0
        ],
        "g0_BB": [
          0.01,
          0.01
        ],
        "g1_BB": [
          9.0,
          9.0
        ],
        "g0_MED": [
          0.0,
          0.0
        ],
        "g1_MED": [
          4.0,
          4.0
        ],
        "psi50_gs": [
          -2.0,
          -2.0
        ],
        "shape_gs": [
          3.0,
          3.0
        ],
        "gsmin_SPA": [
          0.001,
          0.001
        ],
        "iota_SPA": [
          0.0001,
          0.0001
        ],
        "tacclim": [
          298.15,
          298.15
        ],
        "ncan": [
          1,
          1
        ],
        "dpai": [
          [
            2.0
          ],
          [
            2.0
          ]
        ],
        "eair": [
          [
            1500.0
          ],
          [
            1500.0
          ]
        ],
        "o2ref": [
          209.0,
          209.0
        ],
        "pref": [
          101325.0,
          101325.0
        ],
        "cair": [
          [
            [
              400.0
            ]
          ],
          [
            [
              400.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              60.0
            ]
          ],
          [
            [
              60.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              120.0
            ]
          ],
          [
            [
              120.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0
            ]
          ],
          [
            [
              0.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.2
            ]
          ],
          [
            [
              1.2
            ]
          ]
        ],
        "tleaf": [
          [
            [
              298.15
            ]
          ],
          [
            [
              298.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.5
            ]
          ],
          [
            [
              1.5
            ]
          ]
        ],
        "gbc": [
          [
            [
              1.0
            ]
          ],
          [
            [
              1.0
            ]
          ]
        ],
        "apar": [
          [
            [
              0.0
            ]
          ],
          [
            [
              10.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.5
            ]
          ],
          [
            [
              -0.5
            ]
          ]
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Zero and very low PAR conditions testing dark respiration and light compensation point",
        "edge_cases": [
          "zero_radiation",
          "low_light"
        ]
      }
    },
    {
      "name": "test_edge_severe_water_stress",
      "inputs": {
        "c3psn": [
          1.0,
          0.0
        ],
        "g0_BB": [
          0.01,
          0.04
        ],
        "g1_BB": [
          9.0,
          4.0
        ],
        "g0_MED": [
          0.0,
          0.0
        ],
        "g1_MED": [
          4.0,
          1.6
        ],
        "psi50_gs": [
          -2.0,
          -1.5
        ],
        "shape_gs": [
          3.0,
          2.5
        ],
        "gsmin_SPA": [
          0.001,
          0.001
        ],
        "iota_SPA": [
          0.0001,
          0.0001
        ],
        "tacclim": [
          298.15,
          303.15
        ],
        "ncan": [
          1,
          1
        ],
        "dpai": [
          [
            2.0
          ],
          [
            2.0
          ]
        ],
        "eair": [
          [
            1500.0
          ],
          [
            1800.0
          ]
        ],
        "o2ref": [
          209.0,
          209.0
        ],
        "pref": [
          101325.0,
          101325.0
        ],
        "cair": [
          [
            [
              400.0
            ]
          ],
          [
            [
              380.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              60.0
            ]
          ],
          [
            [
              80.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              120.0
            ]
          ],
          [
            [
              160.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0
            ]
          ],
          [
            [
              50.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.2
            ]
          ],
          [
            [
              1.6
            ]
          ]
        ],
        "tleaf": [
          [
            [
              298.15
            ]
          ],
          [
            [
              303.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.5
            ]
          ],
          [
            [
              2.0
            ]
          ]
        ],
        "gbc": [
          [
            [
              1.0
            ]
          ],
          [
            [
              1.3
            ]
          ]
        ],
        "apar": [
          [
            [
              1000.0
            ]
          ],
          [
            [
              1500.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -5.0
            ]
          ],
          [
            [
              -4.5
            ]
          ]
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Severe water stress with leaf water potential well below psi50_gs, testing stomatal closure limits",
        "edge_cases": [
          "severe_drought",
          "stomatal_closure"
        ]
      }
    },
    {
      "name": "test_edge_temperature_extremes",
      "inputs": {
        "c3psn": [
          1.0,
          1.0,
          0.0
        ],
        "g0_BB": [
          0.01,
          0.01,
          0.04
        ],
        "g1_BB": [
          9.0,
          9.0,
          4.0
        ],
        "g0_MED": [
          0.0,
          0.0,
          0.0
        ],
        "g1_MED": [
          4.0,
          4.0,
          1.6
        ],
        "psi50_gs": [
          -2.0,
          -2.0,
          -1.5
        ],
        "shape_gs": [
          3.0,
          3.0,
          2.5
        ],
        "gsmin_SPA": [
          0.001,
          0.001,
          0.001
        ],
        "iota_SPA": [
          0.0001,
          0.0001,
          0.0001
        ],
        "tacclim": [
          278.15,
          313.15,
          308.15
        ],
        "ncan": [
          1,
          1,
          1
        ],
        "dpai": [
          [
            2.0
          ],
          [
            2.0
          ],
          [
            2.0
          ]
        ],
        "eair": [
          [
            800.0
          ],
          [
            2500.0
          ],
          [
            2200.0
          ]
        ],
        "o2ref": [
          209.0,
          209.0,
          209.0
        ],
        "pref": [
          101325.0,
          101325.0,
          101325.0
        ],
        "cair": [
          [
            [
              400.0
            ]
          ],
          [
            [
              400.0
            ]
          ],
          [
            [
              380.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              60.0
            ]
          ],
          [
            [
              60.0
            ]
          ],
          [
            [
              80.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              120.0
            ]
          ],
          [
            [
              120.0
            ]
          ],
          [
            [
              160.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0
            ]
          ],
          [
            [
              0.0
            ]
          ],
          [
            [
              50.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.2
            ]
          ],
          [
            [
              1.2
            ]
          ],
          [
            [
              1.6
            ]
          ]
        ],
        "tleaf": [
          [
            [
              278.15
            ]
          ],
          [
            [
              318.15
            ]
          ],
          [
            [
              313.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.5
            ]
          ],
          [
            [
              1.5
            ]
          ],
          [
            [
              2.0
            ]
          ]
        ],
        "gbc": [
          [
            [
              1.0
            ]
          ],
          [
            [
              1.0
            ]
          ],
          [
            [
              1.3
            ]
          ]
        ],
        "apar": [
          [
            [
              500.0
            ]
          ],
          [
            [
              1200.0
            ]
          ],
          [
            [
              1500.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.5
            ]
          ],
          [
            [
              -1.5
            ]
          ],
          [
            [
              -0.8
            ]
          ]
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Temperature extremes: cold stress (5\u00b0C), heat stress (45\u00b0C), and high temperature (40\u00b0C) testing enzyme kinetics boundaries",
        "edge_cases": [
          "cold_stress",
          "heat_stress",
          "temperature_limits"
        ]
      }
    },
    {
      "name": "test_edge_minimal_conductances",
      "inputs": {
        "c3psn": [
          1.0
        ],
        "g0_BB": [
          0.0
        ],
        "g1_BB": [
          0.1
        ],
        "g0_MED": [
          0.0
        ],
        "g1_MED": [
          0.1
        ],
        "psi50_gs": [
          -2.0
        ],
        "shape_gs": [
          3.0
        ],
        "gsmin_SPA": [
          0.0001
        ],
        "iota_SPA": [
          1e-05
        ],
        "tacclim": [
          298.15
        ],
        "ncan": [
          1
        ],
        "dpai": [
          [
            2.0
          ]
        ],
        "eair": [
          [
            1500.0
          ]
        ],
        "o2ref": [
          209.0
        ],
        "pref": [
          101325.0
        ],
        "cair": [
          [
            [
              400.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              60.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              120.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.2
            ]
          ]
        ],
        "tleaf": [
          [
            [
              298.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              0.1
            ]
          ]
        ],
        "gbc": [
          [
            [
              0.05
            ]
          ]
        ],
        "apar": [
          [
            [
              1000.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.5
            ]
          ]
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Minimal stomatal and boundary layer conductances testing diffusion limitations",
        "edge_cases": [
          "minimal_conductance",
          "diffusion_limited"
        ]
      }
    },
    {
      "name": "test_edge_high_co2_enrichment",
      "inputs": {
        "c3psn": [
          1.0,
          0.0
        ],
        "g0_BB": [
          0.01,
          0.04
        ],
        "g1_BB": [
          9.0,
          4.0
        ],
        "g0_MED": [
          0.0,
          0.0
        ],
        "g1_MED": [
          4.0,
          1.6
        ],
        "psi50_gs": [
          -2.0,
          -1.5
        ],
        "shape_gs": [
          3.0,
          2.5
        ],
        "gsmin_SPA": [
          0.001,
          0.001
        ],
        "iota_SPA": [
          0.0001,
          0.0001
        ],
        "tacclim": [
          298.15,
          303.15
        ],
        "ncan": [
          1,
          1
        ],
        "dpai": [
          [
            2.0
          ],
          [
            2.0
          ]
        ],
        "eair": [
          [
            1500.0
          ],
          [
            1800.0
          ]
        ],
        "o2ref": [
          209.0,
          209.0
        ],
        "pref": [
          101325.0,
          101325.0
        ],
        "cair": [
          [
            [
              1000.0
            ]
          ],
          [
            [
              1200.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              60.0
            ]
          ],
          [
            [
              80.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              120.0
            ]
          ],
          [
            [
              160.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0
            ]
          ],
          [
            [
              50.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.2
            ]
          ],
          [
            [
              1.6
            ]
          ]
        ],
        "tleaf": [
          [
            [
              298.15
            ]
          ],
          [
            [
              303.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.5
            ]
          ],
          [
            [
              2.0
            ]
          ]
        ],
        "gbc": [
          [
            [
              1.0
            ]
          ],
          [
            [
              1.3
            ]
          ]
        ],
        "apar": [
          [
            [
              1000.0
            ]
          ],
          [
            [
              1500.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.5
            ]
          ],
          [
            [
              -0.3
            ]
          ]
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Elevated CO2 concentrations (1000-1200 ppm) testing CO2 saturation effects on C3 and C4 plants",
        "edge_cases": [
          "high_co2",
          "co2_saturation"
        ]
      }
    },
    {
      "name": "test_special_high_altitude_low_pressure",
      "inputs": {
        "c3psn": [
          1.0,
          1.0
        ],
        "g0_BB": [
          0.01,
          0.01
        ],
        "g1_BB": [
          9.0,
          9.0
        ],
        "g0_MED": [
          0.0,
          0.0
        ],
        "g1_MED": [
          4.0,
          4.0
        ],
        "psi50_gs": [
          -2.0,
          -2.0
        ],
        "shape_gs": [
          3.0,
          3.0
        ],
        "gsmin_SPA": [
          0.001,
          0.001
        ],
        "iota_SPA": [
          0.0001,
          0.0001
        ],
        "tacclim": [
          288.15,
          288.15
        ],
        "ncan": [
          1,
          1
        ],
        "dpai": [
          [
            1.5
          ],
          [
            1.5
          ]
        ],
        "eair": [
          [
            1000.0
          ],
          [
            1000.0
          ]
        ],
        "o2ref": [
          209.0,
          209.0
        ],
        "pref": [
          70000.0,
          60000.0
        ],
        "cair": [
          [
            [
              400.0
            ]
          ],
          [
            [
              400.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              50.0
            ]
          ],
          [
            [
              50.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              100.0
            ]
          ],
          [
            [
              100.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0
            ]
          ],
          [
            [
              0.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.0
            ]
          ],
          [
            [
              1.0
            ]
          ]
        ],
        "tleaf": [
          [
            [
              288.15
            ]
          ],
          [
            [
              288.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.2
            ]
          ],
          [
            [
              1.2
            ]
          ]
        ],
        "gbc": [
          [
            [
              0.8
            ]
          ],
          [
            [
              0.8
            ]
          ]
        ],
        "apar": [
          [
            [
              1200.0
            ]
          ],
          [
            [
              1200.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.8
            ]
          ],
          [
            [
              -0.8
            ]
          ]
        ]
      },
      "metadata": {
        "type": "special",
        "description": "High altitude conditions with reduced atmospheric pressure (3000m and 4000m elevation) affecting gas exchange",
        "edge_cases": [
          "low_pressure",
          "high_altitude"
        ]
      }
    },
    {
      "name": "test_special_dense_canopy_deep_shade",
      "inputs": {
        "c3psn": [
          1.0
        ],
        "g0_BB": [
          0.01
        ],
        "g1_BB": [
          9.0
        ],
        "g0_MED": [
          0.0
        ],
        "g1_MED": [
          4.0
        ],
        "psi50_gs": [
          -2.0
        ],
        "shape_gs": [
          3.0
        ],
        "gsmin_SPA": [
          0.001
        ],
        "iota_SPA": [
          0.0001
        ],
        "tacclim": [
          298.15
        ],
        "ncan": [
          5
        ],
        "dpai": [
          [
            1.5,
            1.5,
            1.5,
            1.5,
            1.5
          ]
        ],
        "eair": [
          [
            1600.0,
            1580.0,
            1560.0,
            1540.0,
            1520.0
          ]
        ],
        "o2ref": [
          209.0
        ],
        "pref": [
          101325.0
        ],
        "cair": [
          [
            [
              410.0,
              400.0
            ],
            [
              420.0,
              410.0
            ],
            [
              430.0,
              420.0
            ],
            [
              440.0,
              430.0
            ],
            [
              450.0,
              440.0
            ]
          ]
        ],
        "vcmax25": [
          [
            [
              65.0,
              60.0
            ],
            [
              55.0,
              50.0
            ],
            [
              45.0,
              40.0
            ],
            [
              35.0,
              30.0
            ],
            [
              25.0,
              20.0
            ]
          ]
        ],
        "jmax25": [
          [
            [
              130.0,
              120.0
            ],
            [
              110.0,
              100.0
            ],
            [
              90.0,
              80.0
            ],
            [
              70.0,
              60.0
            ],
            [
              50.0,
              40.0
            ]
          ]
        ],
        "kp25": [
          [
            [
              0.0,
              0.0
            ],
            [
              0.0,
              0.0
            ],
            [
              0.0,
              0.0
            ],
            [
              0.0,
              0.0
            ],
            [
              0.0,
              0.0
            ]
          ]
        ],
        "rd25": [
          [
            [
              1.3,
              1.2
            ],
            [
              1.1,
              1.0
            ],
            [
              0.9,
              0.8
            ],
            [
              0.7,
              0.6
            ],
            [
              0.5,
              0.4
            ]
          ]
        ],
        "tleaf": [
          [
            [
              298.15,
              299.15
            ],
            [
              297.65,
              298.65
            ],
            [
              297.15,
              298.15
            ],
            [
              296.65,
              297.65
            ],
            [
              296.15,
              297.15
            ]
          ]
        ],
        "gbv": [
          [
            [
              1.6,
              1.7
            ],
            [
              1.5,
              1.6
            ],
            [
              1.4,
              1.5
            ],
            [
              1.3,
              1.4
            ],
            [
              1.2,
              1.3
            ]
          ]
        ],
        "gbc": [
          [
            [
              1.05,
              1.1
            ],
            [
              1.0,
              1.05
            ],
            [
              0.95,
              1.0
            ],
            [
              0.9,
              0.95
            ],
            [
              0.85,
              0.9
            ]
          ]
        ],
        "apar": [
          [
            [
              1800.0,
              1600.0
            ],
            [
              900.0,
              700.0
            ],
            [
              400.0,
              300.0
            ],
            [
              150.0,
              100.0
            ],
            [
              50.0,
              30.0
            ]
          ]
        ],
        "lwp": [
          [
            [
              -0.4,
              -0.5
            ],
            [
              -0.6,
              -0.7
            ],
            [
              -0.8,
              -0.9
            ],
            [
              -1.0,
              -1.1
            ],
            [
              -1.2,
              -1.3
            ]
          ]
        ]
      },
      "metadata": {
        "type": "special",
        "description": "Dense canopy with 5 layers showing strong light gradient and CO2 depletion in lower canopy",
        "edge_cases": [
          "deep_shade",
          "co2_depletion",
          "dense_canopy"
        ]
      }
    }
  ],
  "notes": "Test data generation assumptions and methodology:\n\n1. **Physical Realism**: All temperatures in Kelvin (>273.15K), pressures positive, water potentials negative (tension), vapor pressures positive.\n\n2. **C3 vs C4 Distinction**: C3 plants (c3psn=1.0) have kp25=0.0 and typically higher g1 values. C4 plants (c3psn=0.0) have positive kp25 values and lower g1 values.\n\n3. **Dimensional Consistency**: Within each test case, array dimensions are consistent:\n   - n_patches determines first dimension\n   - n_layers (from ncan) determines second dimension for 2D arrays\n   - n_leaf=2 (sunlit/shaded) determines third dimension for 3D arrays\n\n4. **Parameter Ranges**:\n   - vcmax25: 20-85 \u00b5mol/m\u00b2/s (typical range for vegetation)\n   - jmax25: typically 1.5-2.0 \u00d7 vcmax25\n   - rd25: typically 0.01-0.02 \u00d7 vcmax25\n   - Leaf temperatures: 273.15-333.15K (0-60\u00b0C)\n   - APAR: 0-2000 \u00b5mol photons/m\u00b2/s\n   - CO2: 300-1200 ppm (including elevated CO2 scenarios)\n   - Atmospheric pressure: 60000-101325 Pa (sea level to 4000m)\n\n5. **Edge Cases Coverage**:\n   - Zero radiation (dark respiration)\n   - Severe water stress (lwp << psi50_gs)\n   - Temperature extremes (cold and heat stress)\n   - Minimal conductances (diffusion limitation)\n   - High CO2 (saturation effects)\n   - Low pressure (high altitude)\n   - Deep canopy shade (light limitation)\n\n6. **Canopy Structure**: Light and physiological parameters decrease with canopy depth. CO2 concentration increases in lower canopy due to respiration. Temperature gradients reflect radiative cooling.\n\n7. **Ball-Berry vs Medlyn**: Both stomatal conductance model parameters provided. Actual model selection determined by params.gs_type.\n\n8. **Water Stress**: btran calculated from lwp and psi50_gs/shape_gs parameters, affecting stomatal conductance.\n\n9. **Acclimation**: tacclim parameter allows testing temperature acclimation effects on enzyme kinetics (when params.acclim_type enables it).\n\n10. **Boundary Layer**: gbv and gbc values reflect typical leaf boundary layer conductances (0.05-2.5 mol/m\u00b2/s) varying with wind speed and leaf size."
}
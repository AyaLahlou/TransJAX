{
  "function_name": "leaf_boundary_layer",
  "test_cases": [
    {
      "name": "test_nominal_single_patch_single_layer",
      "inputs": {
        "dleaf": [
          0.05
        ],
        "tref": [
          298.15
        ],
        "pref": [
          101325.0
        ],
        "wind": [
          [
            2.5
          ]
        ],
        "tair": [
          [
            295.15
          ]
        ],
        "tleaf": [
          [
            298.15
          ]
        ],
        "rhomol": [
          [
            41.0
          ]
        ],
        "dpai": [
          [
            1.5
          ]
        ],
        "params": null
      },
      "metadata": {
        "type": "nominal",
        "description": "Typical temperate forest conditions: 5cm leaf, 25\u00b0C air, 2.5 m/s wind, moderate LAI",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_multi_patch_multi_layer",
      "inputs": {
        "dleaf": [
          0.03,
          0.08,
          0.05
        ],
        "tref": [
          293.15,
          303.15,
          288.15
        ],
        "pref": [
          101325.0,
          95000.0,
          101325.0
        ],
        "wind": [
          [
            1.2,
            0.8,
            0.5,
            0.3
          ],
          [
            3.5,
            2.1,
            1.4,
            0.9
          ],
          [
            0.5,
            0.3,
            0.2,
            0.1
          ]
        ],
        "tair": [
          [
            291.15,
            292.15,
            293.15,
            294.15
          ],
          [
            301.15,
            302.15,
            303.15,
            304.15
          ],
          [
            286.15,
            287.15,
            288.15,
            289.15
          ]
        ],
        "tleaf": [
          [
            293.15,
            294.15,
            295.15,
            296.15
          ],
          [
            303.15,
            304.15,
            305.15,
            306.15
          ],
          [
            288.15,
            289.15,
            290.15,
            291.15
          ]
        ],
        "rhomol": [
          [
            42.0,
            41.8,
            41.5,
            41.2
          ],
          [
            39.5,
            39.3,
            39.0,
            38.8
          ],
          [
            43.5,
            43.2,
            43.0,
            42.8
          ]
        ],
        "dpai": [
          [
            2.0,
            1.5,
            1.0,
            0.5
          ],
          [
            3.5,
            2.8,
            2.0,
            1.2
          ],
          [
            1.2,
            0.9,
            0.6,
            0.3
          ]
        ],
        "params": null
      },
      "metadata": {
        "type": "nominal",
        "description": "Three patches with varying conditions: cool/calm, hot/windy, cold/still. Four canopy layers with decreasing wind and LAI",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_tropical_conditions",
      "inputs": {
        "dleaf": [
          0.12,
          0.15
        ],
        "tref": [
          303.15,
          305.15
        ],
        "pref": [
          101325.0,
          101325.0
        ],
        "wind": [
          [
            4.0,
            2.5,
            1.5
          ],
          [
            3.5,
            2.0,
            1.0
          ]
        ],
        "tair": [
          [
            301.15,
            302.15,
            303.15
          ],
          [
            303.15,
            304.15,
            305.15
          ]
        ],
        "tleaf": [
          [
            304.15,
            305.15,
            306.15
          ],
          [
            306.15,
            307.15,
            308.15
          ]
        ],
        "rhomol": [
          [
            39.8,
            39.5,
            39.2
          ],
          [
            39.3,
            39.0,
            38.7
          ]
        ],
        "dpai": [
          [
            4.5,
            3.2,
            1.8
          ],
          [
            5.0,
            3.8,
            2.2
          ]
        ],
        "params": null
      },
      "metadata": {
        "type": "nominal",
        "description": "Tropical rainforest: large leaves, high temperatures (30-35\u00b0C), high LAI, moderate wind",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_arctic_conditions",
      "inputs": {
        "dleaf": [
          0.01,
          0.02
        ],
        "tref": [
          273.15,
          275.15
        ],
        "pref": [
          101325.0,
          101325.0
        ],
        "wind": [
          [
            5.0,
            3.5
          ],
          [
            6.0,
            4.0
          ]
        ],
        "tair": [
          [
            271.15,
            272.15
          ],
          [
            273.15,
            274.15
          ]
        ],
        "tleaf": [
          [
            272.15,
            273.15
          ],
          [
            274.15,
            275.15
          ]
        ],
        "rhomol": [
          [
            44.5,
            44.2
          ],
          [
            44.0,
            43.7
          ]
        ],
        "dpai": [
          [
            0.5,
            0.3
          ],
          [
            0.8,
            0.5
          ]
        ],
        "params": null
      },
      "metadata": {
        "type": "nominal",
        "description": "Arctic tundra: tiny leaves, near-freezing temps (0-2\u00b0C), low LAI, high wind",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_desert_conditions",
      "inputs": {
        "dleaf": [
          0.02,
          0.03,
          0.025
        ],
        "tref": [
          313.15,
          315.15,
          310.15
        ],
        "pref": [
          95000.0,
          94000.0,
          96000.0
        ],
        "wind": [
          [
            8.0,
            6.0,
            4.0
          ],
          [
            10.0,
            7.5,
            5.0
          ],
          [
            6.0,
            4.5,
            3.0
          ]
        ],
        "tair": [
          [
            311.15,
            312.15,
            313.15
          ],
          [
            313.15,
            314.15,
            315.15
          ],
          [
            308.15,
            309.15,
            310.15
          ]
        ],
        "tleaf": [
          [
            315.15,
            316.15,
            317.15
          ],
          [
            318.15,
            319.15,
            320.15
          ],
          [
            312.15,
            313.15,
            314.15
          ]
        ],
        "rhomol": [
          [
            37.5,
            37.3,
            37.0
          ],
          [
            36.8,
            36.5,
            36.2
          ],
          [
            38.2,
            38.0,
            37.7
          ]
        ],
        "dpai": [
          [
            0.3,
            0.2,
            0.1
          ],
          [
            0.4,
            0.3,
            0.15
          ],
          [
            0.25,
            0.18,
            0.08
          ]
        ],
        "params": null
      },
      "metadata": {
        "type": "nominal",
        "description": "Hot desert: small leaves, very high temps (40-47\u00b0C), very low LAI, high wind, lower pressure (elevation)",
        "edge_cases": []
      }
    },
    {
      "name": "test_edge_near_zero_wind",
      "inputs": {
        "dleaf": [
          0.05,
          0.06
        ],
        "tref": [
          298.15,
          300.15
        ],
        "pref": [
          101325.0,
          101325.0
        ],
        "wind": [
          [
            0.01,
            0.005,
            0.001
          ],
          [
            0.02,
            0.01,
            0.005
          ]
        ],
        "tair": [
          [
            296.15,
            297.15,
            298.15
          ],
          [
            298.15,
            299.15,
            300.15
          ]
        ],
        "tleaf": [
          [
            298.15,
            299.15,
            300.15
          ],
          [
            300.15,
            301.15,
            302.15
          ]
        ],
        "rhomol": [
          [
            41.2,
            41.0,
            40.8
          ],
          [
            40.5,
            40.3,
            40.0
          ]
        ],
        "dpai": [
          [
            1.5,
            1.0,
            0.5
          ],
          [
            2.0,
            1.5,
            1.0
          ]
        ],
        "params": null
      },
      "metadata": {
        "type": "edge",
        "description": "Near-zero wind speeds to test free convection dominance and numerical stability",
        "edge_cases": [
          "near_zero_wind",
          "free_convection_regime"
        ]
      }
    },
    {
      "name": "test_edge_very_high_wind",
      "inputs": {
        "dleaf": [
          0.04,
          0.05
        ],
        "tref": [
          295.15,
          298.15
        ],
        "pref": [
          101325.0,
          101325.0
        ],
        "wind": [
          [
            25.0,
            20.0,
            15.0
          ],
          [
            30.0,
            25.0,
            20.0
          ]
        ],
        "tair": [
          [
            293.15,
            294.15,
            295.15
          ],
          [
            296.15,
            297.15,
            298.15
          ]
        ],
        "tleaf": [
          [
            294.15,
            295.15,
            296.15
          ],
          [
            297.15,
            298.15,
            299.15
          ]
        ],
        "rhomol": [
          [
            41.8,
            41.5,
            41.2
          ],
          [
            41.0,
            40.8,
            40.5
          ]
        ],
        "dpai": [
          [
            2.5,
            2.0,
            1.5
          ],
          [
            3.0,
            2.5,
            2.0
          ]
        ],
        "params": null
      },
      "metadata": {
        "type": "edge",
        "description": "Very high wind speeds (storm conditions) to test turbulent regime and upper bounds",
        "edge_cases": [
          "high_wind",
          "turbulent_regime"
        ]
      }
    },
    {
      "name": "test_edge_extreme_temperature_gradient",
      "inputs": {
        "dleaf": [
          0.05
        ],
        "tref": [
          298.15
        ],
        "pref": [
          101325.0
        ],
        "wind": [
          [
            1.0,
            0.8,
            0.6
          ]
        ],
        "tair": [
          [
            280.15,
            285.15,
            290.15
          ]
        ],
        "tleaf": [
          [
            310.15,
            308.15,
            305.15
          ]
        ],
        "rhomol": [
          [
            43.0,
            42.0,
            41.5
          ]
        ],
        "dpai": [
          [
            1.5,
            1.2,
            0.8
          ]
        ],
        "params": null
      },
      "metadata": {
        "type": "edge",
        "description": "Large temperature difference between leaf and air (30K) to test free convection contribution",
        "edge_cases": [
          "extreme_temperature_gradient",
          "strong_free_convection"
        ]
      }
    },
    {
      "name": "test_special_tiny_leaves",
      "inputs": {
        "dleaf": [
          0.001,
          0.002,
          0.0005
        ],
        "tref": [
          295.15,
          298.15,
          293.15
        ],
        "pref": [
          101325.0,
          101325.0,
          101325.0
        ],
        "wind": [
          [
            2.0,
            1.5
          ],
          [
            3.0,
            2.0
          ],
          [
            1.5,
            1.0
          ]
        ],
        "tair": [
          [
            293.15,
            294.15
          ],
          [
            296.15,
            297.15
          ],
          [
            291.15,
            292.15
          ]
        ],
        "tleaf": [
          [
            295.15,
            296.15
          ],
          [
            298.15,
            299.15
          ],
          [
            293.15,
            294.15
          ]
        ],
        "rhomol": [
          [
            41.5,
            41.3
          ],
          [
            41.0,
            40.8
          ],
          [
            42.0,
            41.8
          ]
        ],
        "dpai": [
          [
            0.5,
            0.3
          ],
          [
            0.8,
            0.5
          ],
          [
            0.4,
            0.2
          ]
        ],
        "params": null
      },
      "metadata": {
        "type": "special",
        "description": "Extremely small leaf dimensions (0.5-2mm) like moss or small needles to test Reynolds number scaling",
        "edge_cases": [
          "tiny_leaves",
          "low_reynolds_number"
        ]
      }
    },
    {
      "name": "test_special_high_altitude",
      "inputs": {
        "dleaf": [
          0.04,
          0.05
        ],
        "tref": [
          278.15,
          280.15
        ],
        "pref": [
          65000.0,
          63000.0
        ],
        "wind": [
          [
            4.0,
            3.0,
            2.0
          ],
          [
            5.0,
            4.0,
            3.0
          ]
        ],
        "tair": [
          [
            276.15,
            277.15,
            278.15
          ],
          [
            278.15,
            279.15,
            280.15
          ]
        ],
        "tleaf": [
          [
            279.15,
            280.15,
            281.15
          ],
          [
            281.15,
            282.15,
            283.15
          ]
        ],
        "rhomol": [
          [
            28.5,
            28.3,
            28.0
          ],
          [
            27.8,
            27.5,
            27.2
          ]
        ],
        "dpai": [
          [
            1.0,
            0.7,
            0.4
          ],
          [
            1.2,
            0.9,
            0.5
          ]
        ],
        "params": null
      },
      "metadata": {
        "type": "special",
        "description": "High altitude conditions (~4000m): low pressure (65kPa), low air density, cold temps, testing pressure/density effects on diffusivities",
        "edge_cases": [
          "low_pressure",
          "low_density",
          "high_altitude"
        ]
      }
    }
  ],
  "notes": "Test data generation assumptions:\n\n1. **Physical realism**: All temperatures > 0K (absolute zero), pressures > 0, wind speeds >= 0, dimensions > 0.\n\n2. **Temperature relationships**: Generally tleaf > tair (photosynthesis heating), with gradients of 1-10K for nominal cases, up to 30K for edge cases.\n\n3. **Molar density**: Calculated approximately from ideal gas law: rhomol \u2248 P/(R*T) where R=8.314 J/(mol\u00b7K). Values range from ~27 mol/m\u00b3 (high altitude, warm) to ~44 mol/m\u00b3 (sea level, cold).\n\n4. **Wind profiles**: Decreasing with canopy depth (top to bottom layers), typical ratios of 2-4x between top and bottom.\n\n5. **LAI profiles**: Decreasing with depth, total LAI ranges from 0.3 (desert/tundra) to 5.0 (tropical forest).\n\n6. **Leaf dimensions**: 0.5mm (moss) to 15cm (tropical broadleaf), most temperate leaves 3-8cm.\n\n7. **Pressure**: Sea level ~101.3kPa, high altitude ~63-65kPa (4000m), desert elevation ~94-96kPa.\n\n8. **Array dimensions**: Varied n_patches (1-3) and n_canopy_layers (2-4) to test different array shapes.\n\n9. **Edge cases**: Focus on numerical stability boundaries (near-zero wind, extreme gradients), physical extremes (tiny leaves, high altitude), and regime transitions (laminar/turbulent, forced/free convection).\n\n10. **params=None**: All tests use default parameters to test the default behavior path. Additional tests with custom BoundaryLayerParams would be valuable for comprehensive coverage."
}
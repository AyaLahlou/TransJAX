{
  "function_name": "compute_soil_temperature",
  "test_cases": [
    {
      "name": "test_nominal_single_column_no_snow",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8,
              0.9,
              1.0,
              1.2,
              1.5,
              2.0
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85,
              4.75,
              5.8,
              7.1,
              8.85,
              11.35
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.4,
              1.9,
              2.5,
              3.2,
              4.0,
              5.0,
              6.2,
              7.7,
              9.7,
              13.7
            ]
          ],
          "snl": [
            0
          ],
          "nbedrock": [
            15
          ]
        },
        "t_soisno": [
          [
            280.0,
            281.0,
            282.0,
            283.0,
            284.0,
            285.0,
            286.0,
            287.0,
            288.0,
            289.0,
            290.0,
            291.0,
            292.0,
            293.0,
            294.0
          ]
        ],
        "gsoi": [
          50.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              10.0,
              15.0,
              20.0,
              25.0,
              30.0,
              35.0,
              40.0,
              45.0,
              50.0,
              55.0,
              60.0,
              65.0,
              70.0,
              75.0,
              80.0
            ]
          ],
          "h2osoi_ice": [
            [
              5.0,
              4.0,
              3.0,
              2.0,
              1.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            2.0
          ],
          "h2osno": [
            0.0
          ],
          "frac_sno_eff": [
            0.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5
            ]
          ],
          "tkdry": [
            [
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2
            ]
          ],
          "csol": [
            [
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0
            ]
          ],
          "watsat": [
            [
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 1800.0,
        "nlevsno": 5,
        "nlevgrnd": 15
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard single column case with no snow, moderate temperatures, typical soil properties",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_with_snow_layers",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.05,
              0.08,
              0.12,
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8,
              0.9,
              1.0,
              1.2,
              1.5,
              2.0
            ]
          ],
          "z": [
            [
              0.025,
              0.09,
              0.19,
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85,
              4.75,
              5.8,
              7.1,
              8.85,
              11.35
            ]
          ],
          "zi": [
            [
              0.0,
              0.05,
              0.13,
              0.25,
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.4,
              1.9,
              2.5,
              3.2,
              4.0,
              5.0,
              6.2,
              7.7,
              9.7
            ]
          ],
          "snl": [
            -3
          ],
          "nbedrock": [
            15
          ]
        },
        "t_soisno": [
          [
            268.0,
            270.0,
            272.0,
            273.0,
            275.0,
            277.0,
            279.0,
            281.0,
            283.0,
            285.0,
            287.0,
            289.0,
            291.0,
            293.0,
            295.0,
            297.0,
            299.0,
            301.0
          ]
        ],
        "gsoi": [
          80.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              0.5,
              1.0,
              2.0,
              10.0,
              15.0,
              20.0,
              25.0,
              30.0,
              35.0,
              40.0,
              45.0,
              50.0,
              55.0,
              60.0,
              65.0,
              70.0,
              75.0,
              80.0
            ]
          ],
          "h2osoi_ice": [
            [
              15.0,
              20.0,
              25.0,
              5.0,
              4.0,
              3.0,
              2.0,
              1.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            1.5
          ],
          "h2osno": [
            50.0
          ],
          "frac_sno_eff": [
            0.85
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8
            ]
          ],
          "tkdry": [
            [
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25
            ]
          ],
          "csol": [
            [
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0
            ]
          ],
          "watsat": [
            [
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 3600.0,
        "nlevsno": 5,
        "nlevgrnd": 15
      },
      "metadata": {
        "type": "nominal",
        "description": "Winter conditions with 3 snow layers, temperatures near freezing, significant snow cover",
        "edge_cases": []
      }
    },
    {
      "name": "test_multiple_columns_varying_conditions",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8
            ],
            [
              0.08,
              0.12,
              0.18,
              0.22,
              0.28,
              0.35,
              0.45,
              0.55,
              0.65,
              0.75
            ],
            [
              0.12,
              0.18,
              0.22,
              0.28,
              0.32,
              0.42,
              0.52,
              0.62,
              0.72,
              0.82
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85
            ],
            [
              0.04,
              0.14,
              0.29,
              0.51,
              0.79,
              1.135,
              1.585,
              2.135,
              2.785,
              3.535
            ],
            [
              0.06,
              0.21,
              0.4,
              0.65,
              0.97,
              1.39,
              1.91,
              2.53,
              3.25,
              4.07
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.4,
              1.9,
              2.5,
              3.2,
              4.0
            ],
            [
              0.0,
              0.08,
              0.2,
              0.38,
              0.6,
              0.88,
              1.23,
              1.68,
              2.23,
              2.88,
              3.63
            ],
            [
              0.0,
              0.12,
              0.3,
              0.52,
              0.8,
              1.12,
              1.56,
              2.08,
              2.7,
              3.42,
              4.24
            ]
          ],
          "snl": [
            0,
            -1,
            -2
          ],
          "nbedrock": [
            10,
            10,
            10
          ]
        },
        "t_soisno": [
          [
            295.0,
            294.0,
            293.0,
            292.0,
            291.0,
            290.0,
            289.0,
            288.0,
            287.0,
            286.0
          ],
          [
            270.0,
            275.0,
            278.0,
            280.0,
            282.0,
            284.0,
            286.0,
            288.0,
            290.0,
            292.0
          ],
          [
            265.0,
            268.0,
            273.0,
            276.0,
            279.0,
            282.0,
            285.0,
            288.0,
            291.0,
            294.0
          ]
        ],
        "gsoi": [
          120.0,
          -50.0,
          30.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              20.0,
              25.0,
              30.0,
              35.0,
              40.0,
              45.0,
              50.0,
              55.0,
              60.0,
              65.0
            ],
            [
              2.0,
              5.0,
              15.0,
              20.0,
              25.0,
              30.0,
              35.0,
              40.0,
              45.0,
              50.0
            ],
            [
              1.0,
              3.0,
              10.0,
              18.0,
              24.0,
              32.0,
              38.0,
              44.0,
              52.0,
              58.0
            ]
          ],
          "h2osoi_ice": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              20.0,
              8.0,
              3.0,
              2.0,
              1.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              25.0,
              18.0,
              5.0,
              3.0,
              2.0,
              1.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            3.0,
            1.0,
            0.5
          ],
          "h2osno": [
            0.0,
            15.0,
            35.0
          ],
          "frac_sno_eff": [
            0.0,
            0.4,
            0.7
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.2,
              2.2,
              2.2,
              2.2,
              2.2,
              2.2,
              2.2,
              2.2,
              2.2,
              2.2
            ],
            [
              3.0,
              3.0,
              3.0,
              3.0,
              3.0,
              3.0,
              3.0,
              3.0,
              3.0,
              3.0
            ],
            [
              1.8,
              1.8,
              1.8,
              1.8,
              1.8,
              1.8,
              1.8,
              1.8,
              1.8,
              1.8
            ]
          ],
          "tkdry": [
            [
              0.18,
              0.18,
              0.18,
              0.18,
              0.18,
              0.18,
              0.18,
              0.18,
              0.18,
              0.18
            ],
            [
              0.28,
              0.28,
              0.28,
              0.28,
              0.28,
              0.28,
              0.28,
              0.28,
              0.28,
              0.28
            ],
            [
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15
            ]
          ],
          "csol": [
            [
              1800000.0,
              1800000.0,
              1800000.0,
              1800000.0,
              1800000.0,
              1800000.0,
              1800000.0,
              1800000.0,
              1800000.0,
              1800000.0
            ],
            [
              2400000.0,
              2400000.0,
              2400000.0,
              2400000.0,
              2400000.0,
              2400000.0,
              2400000.0,
              2400000.0,
              2400000.0,
              2400000.0
            ],
            [
              1600000.0,
              1600000.0,
              1600000.0,
              1600000.0,
              1600000.0,
              1600000.0,
              1600000.0,
              1600000.0,
              1600000.0,
              1600000.0
            ]
          ],
          "watsat": [
            [
              0.4,
              0.4,
              0.4,
              0.4,
              0.4,
              0.4,
              0.4,
              0.4,
              0.4,
              0.4
            ],
            [
              0.52,
              0.52,
              0.52,
              0.52,
              0.52,
              0.52,
              0.52,
              0.52,
              0.52,
              0.52
            ],
            [
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 1200.0,
        "nlevsno": 5,
        "nlevgrnd": 10
      },
      "metadata": {
        "type": "nominal",
        "description": "Three columns with different conditions: warm/dry, cold/snowy, very cold/snowy; tests spatial variability",
        "edge_cases": []
      }
    },
    {
      "name": "test_edge_zero_heat_flux",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8,
              0.9,
              1.0
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85,
              4.75,
              5.8
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.4,
              1.9,
              2.5,
              3.2,
              4.0,
              5.0,
              6.2
            ]
          ],
          "snl": [
            0
          ],
          "nbedrock": [
            12
          ]
        },
        "t_soisno": [
          [
            285.0,
            285.0,
            285.0,
            285.0,
            285.0,
            285.0,
            285.0,
            285.0,
            285.0,
            285.0,
            285.0,
            285.0
          ]
        ],
        "gsoi": [
          0.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              20.0,
              20.0,
              20.0,
              20.0,
              20.0,
              20.0,
              20.0,
              20.0,
              20.0,
              20.0,
              20.0,
              20.0
            ]
          ],
          "h2osoi_ice": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            0.0
          ],
          "h2osno": [
            0.0
          ],
          "frac_sno_eff": [
            0.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5
            ]
          ],
          "tkdry": [
            [
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2
            ]
          ],
          "csol": [
            [
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0
            ]
          ],
          "watsat": [
            [
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 1800.0,
        "nlevsno": 5,
        "nlevgrnd": 12
      },
      "metadata": {
        "type": "edge",
        "description": "Zero ground heat flux with uniform temperature profile - tests equilibrium conditions",
        "edge_cases": [
          "zero_flux",
          "uniform_temperature"
        ]
      }
    },
    {
      "name": "test_edge_negative_heat_flux",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.4,
              1.9,
              2.5,
              3.2,
              4.0
            ]
          ],
          "snl": [
            0
          ],
          "nbedrock": [
            10
          ]
        },
        "t_soisno": [
          [
            300.0,
            298.0,
            296.0,
            294.0,
            292.0,
            290.0,
            288.0,
            286.0,
            284.0,
            282.0
          ]
        ],
        "gsoi": [
          -450.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              30.0,
              32.0,
              34.0,
              36.0,
              38.0,
              40.0,
              42.0,
              44.0,
              46.0,
              48.0
            ]
          ],
          "h2osoi_ice": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            5.0
          ],
          "h2osno": [
            0.0
          ],
          "frac_sno_eff": [
            0.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              3.5,
              3.5,
              3.5,
              3.5,
              3.5,
              3.5,
              3.5,
              3.5,
              3.5,
              3.5
            ]
          ],
          "tkdry": [
            [
              0.3,
              0.3,
              0.3,
              0.3,
              0.3,
              0.3,
              0.3,
              0.3,
              0.3,
              0.3
            ]
          ],
          "csol": [
            [
              2500000.0,
              2500000.0,
              2500000.0,
              2500000.0,
              2500000.0,
              2500000.0,
              2500000.0,
              2500000.0,
              2500000.0,
              2500000.0
            ]
          ],
          "watsat": [
            [
              0.48,
              0.48,
              0.48,
              0.48,
              0.48,
              0.48,
              0.48,
              0.48,
              0.48,
              0.48
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 900.0,
        "nlevsno": 5,
        "nlevgrnd": 10
      },
      "metadata": {
        "type": "edge",
        "description": "Large negative heat flux (upward) with warm soil - tests cooling scenario",
        "edge_cases": [
          "negative_flux",
          "high_temperature"
        ]
      }
    },
    {
      "name": "test_edge_near_freezing_transition",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.08,
              0.12,
              0.16,
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7
            ]
          ],
          "z": [
            [
              0.04,
              0.14,
              0.28,
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05
            ]
          ],
          "zi": [
            [
              0.0,
              0.08,
              0.2,
              0.36,
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.4,
              1.9,
              2.5
            ]
          ],
          "snl": [
            -3
          ],
          "nbedrock": [
            9
          ]
        },
        "t_soisno": [
          [
            271.15,
            272.15,
            273.05,
            273.15,
            273.25,
            273.5,
            274.0,
            275.0,
            276.0,
            277.0,
            278.0,
            279.0
          ]
        ],
        "gsoi": [
          25.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              0.1,
              0.5,
              1.5,
              5.0,
              10.0,
              15.0,
              20.0,
              25.0,
              30.0,
              35.0,
              40.0,
              45.0
            ]
          ],
          "h2osoi_ice": [
            [
              18.0,
              22.0,
              28.0,
              10.0,
              8.0,
              6.0,
              4.0,
              2.0,
              1.0,
              0.5,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            0.8
          ],
          "h2osno": [
            45.0
          ],
          "frac_sno_eff": [
            0.9
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.0,
              2.0,
              2.0,
              2.0,
              2.0,
              2.0,
              2.0,
              2.0,
              2.0
            ]
          ],
          "tkdry": [
            [
              0.18,
              0.18,
              0.18,
              0.18,
              0.18,
              0.18,
              0.18,
              0.18,
              0.18
            ]
          ],
          "csol": [
            [
              1900000.0,
              1900000.0,
              1900000.0,
              1900000.0,
              1900000.0,
              1900000.0,
              1900000.0,
              1900000.0,
              1900000.0
            ]
          ],
          "watsat": [
            [
              0.47,
              0.47,
              0.47,
              0.47,
              0.47,
              0.47,
              0.47,
              0.47,
              0.47
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 600.0,
        "nlevsno": 5,
        "nlevgrnd": 9
      },
      "metadata": {
        "type": "edge",
        "description": "Temperatures near freezing point (273.15K) with phase transition - tests critical thermal behavior",
        "edge_cases": [
          "freezing_point",
          "phase_transition"
        ]
      }
    },
    {
      "name": "test_edge_minimal_water_content",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.4,
              1.9,
              2.5,
              3.2,
              4.0
            ]
          ],
          "snl": [
            0
          ],
          "nbedrock": [
            10
          ]
        },
        "t_soisno": [
          [
            310.0,
            308.0,
            306.0,
            304.0,
            302.0,
            300.0,
            298.0,
            296.0,
            294.0,
            292.0
          ]
        ],
        "gsoi": [
          200.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              0.01,
              0.01,
              0.01,
              0.01,
              0.01,
              0.01,
              0.01,
              0.01,
              0.01,
              0.01
            ]
          ],
          "h2osoi_ice": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            0.0
          ],
          "h2osno": [
            0.0
          ],
          "frac_sno_eff": [
            0.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              1.5,
              1.5,
              1.5,
              1.5,
              1.5,
              1.5,
              1.5,
              1.5,
              1.5,
              1.5
            ]
          ],
          "tkdry": [
            [
              0.12,
              0.12,
              0.12,
              0.12,
              0.12,
              0.12,
              0.12,
              0.12,
              0.12,
              0.12
            ]
          ],
          "csol": [
            [
              1500000.0,
              1500000.0,
              1500000.0,
              1500000.0,
              1500000.0,
              1500000.0,
              1500000.0,
              1500000.0,
              1500000.0,
              1500000.0
            ]
          ],
          "watsat": [
            [
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 1800.0,
        "nlevsno": 5,
        "nlevgrnd": 10
      },
      "metadata": {
        "type": "edge",
        "description": "Very dry soil with minimal water content and high temperatures - tests arid conditions",
        "edge_cases": [
          "minimal_water",
          "high_temperature",
          "dry_soil"
        ]
      }
    },
    {
      "name": "test_special_maximum_snow_layers",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.03,
              0.05,
              0.08,
              0.12,
              0.18,
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8,
              0.9,
              1.0,
              1.2,
              1.5,
              2.0
            ]
          ],
          "z": [
            [
              0.015,
              0.055,
              0.12,
              0.21,
              0.36,
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85,
              4.75,
              5.8,
              7.1,
              8.85,
              11.35
            ]
          ],
          "zi": [
            [
              0.0,
              0.03,
              0.08,
              0.16,
              0.28,
              0.46,
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.4,
              1.9,
              2.5,
              3.2,
              4.0,
              5.0,
              6.2,
              7.7,
              9.7
            ]
          ],
          "snl": [
            -5
          ],
          "nbedrock": [
            15
          ]
        },
        "t_soisno": [
          [
            260.0,
            262.0,
            265.0,
            268.0,
            271.0,
            273.0,
            274.0,
            275.0,
            276.0,
            278.0,
            280.0,
            282.0,
            284.0,
            286.0,
            288.0,
            290.0,
            292.0,
            294.0,
            296.0,
            298.0
          ]
        ],
        "gsoi": [
          60.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              0.05,
              0.1,
              0.2,
              0.5,
              1.0,
              8.0,
              12.0,
              16.0,
              20.0,
              24.0,
              28.0,
              32.0,
              36.0,
              40.0,
              44.0,
              48.0,
              52.0,
              56.0,
              60.0,
              64.0
            ]
          ],
          "h2osoi_ice": [
            [
              12.0,
              16.0,
              20.0,
              24.0,
              28.0,
              6.0,
              5.0,
              4.0,
              3.0,
              2.0,
              1.0,
              0.5,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            0.3
          ],
          "h2osno": [
            85.0
          ],
          "frac_sno_eff": [
            1.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.6,
              2.6,
              2.6,
              2.6,
              2.6,
              2.6,
              2.6,
              2.6,
              2.6,
              2.6,
              2.6,
              2.6,
              2.6,
              2.6,
              2.6
            ]
          ],
          "tkdry": [
            [
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22
            ]
          ],
          "csol": [
            [
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0
            ]
          ],
          "watsat": [
            [
              0.46,
              0.46,
              0.46,
              0.46,
              0.46,
              0.46,
              0.46,
              0.46,
              0.46,
              0.46,
              0.46,
              0.46,
              0.46,
              0.46,
              0.46
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 1800.0,
        "nlevsno": 5,
        "nlevgrnd": 15
      },
      "metadata": {
        "type": "special",
        "description": "Maximum snow layers (5) with deep snowpack and complete snow cover - tests extreme winter conditions",
        "edge_cases": []
      }
    },
    {
      "name": "test_special_shallow_bedrock",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.4
            ]
          ],
          "snl": [
            0
          ],
          "nbedrock": [
            4
          ]
        },
        "t_soisno": [
          [
            288.0,
            287.0,
            286.0,
            285.0,
            284.5,
            284.0
          ]
        ],
        "gsoi": [
          35.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              15.0,
              18.0,
              20.0,
              22.0,
              10.0,
              5.0
            ]
          ],
          "h2osoi_ice": [
            [
              2.0,
              1.5,
              1.0,
              0.5,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            1.2
          ],
          "h2osno": [
            0.0
          ],
          "frac_sno_eff": [
            0.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.3,
              2.3,
              2.3,
              2.3,
              2.3,
              2.3
            ]
          ],
          "tkdry": [
            [
              0.19,
              0.19,
              0.19,
              0.19,
              0.19,
              0.19
            ]
          ],
          "csol": [
            [
              1950000.0,
              1950000.0,
              1950000.0,
              1950000.0,
              1950000.0,
              1950000.0
            ]
          ],
          "watsat": [
            [
              0.43,
              0.43,
              0.43,
              0.43,
              0.43,
              0.43
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 1800.0,
        "nlevsno": 5,
        "nlevgrnd": 6
      },
      "metadata": {
        "type": "special",
        "description": "Shallow soil profile with bedrock at layer 4 - tests limited soil depth scenarios",
        "edge_cases": []
      }
    },
    {
      "name": "test_special_extreme_timestep_variations",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6
            ],
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35
            ],
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.4,
              1.9,
              2.5
            ],
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.4,
              1.9,
              2.5
            ]
          ],
          "snl": [
            0,
            0
          ],
          "nbedrock": [
            8,
            8
          ]
        },
        "t_soisno": [
          [
            278.0,
            279.0,
            280.0,
            281.0,
            282.0,
            283.0,
            284.0,
            285.0
          ],
          [
            278.0,
            279.0,
            280.0,
            281.0,
            282.0,
            283.0,
            284.0,
            285.0
          ]
        ],
        "gsoi": [
          75.0,
          75.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              18.0,
              20.0,
              22.0,
              24.0,
              26.0,
              28.0,
              30.0,
              32.0
            ],
            [
              18.0,
              20.0,
              22.0,
              24.0,
              26.0,
              28.0,
              30.0,
              32.0
            ]
          ],
          "h2osoi_ice": [
            [
              3.0,
              2.5,
              2.0,
              1.5,
              1.0,
              0.5,
              0.0,
              0.0
            ],
            [
              3.0,
              2.5,
              2.0,
              1.5,
              1.0,
              0.5,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            1.8,
            1.8
          ],
          "h2osno": [
            0.0,
            0.0
          ],
          "frac_sno_eff": [
            0.0,
            0.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.4,
              2.4,
              2.4,
              2.4,
              2.4,
              2.4,
              2.4,
              2.4
            ],
            [
              2.4,
              2.4,
              2.4,
              2.4,
              2.4,
              2.4,
              2.4,
              2.4
            ]
          ],
          "tkdry": [
            [
              0.21,
              0.21,
              0.21,
              0.21,
              0.21,
              0.21,
              0.21,
              0.21
            ],
            [
              0.21,
              0.21,
              0.21,
              0.21,
              0.21,
              0.21,
              0.21,
              0.21
            ]
          ],
          "csol": [
            [
              2050000.0,
              2050000.0,
              2050000.0,
              2050000.0,
              2050000.0,
              2050000.0,
              2050000.0,
              2050000.0
            ],
            [
              2050000.0,
              2050000.0,
              2050000.0,
              2050000.0,
              2050000.0,
              2050000.0,
              2050000.0,
              2050000.0
            ]
          ],
          "watsat": [
            [
              0.44,
              0.44,
              0.44,
              0.44,
              0.44,
              0.44,
              0.44,
              0.44
            ],
            [
              0.44,
              0.44,
              0.44,
              0.44,
              0.44,
              0.44,
              0.44,
              0.44
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 60.0,
        "nlevsno": 5,
        "nlevgrnd": 8
      },
      "metadata": {
        "type": "special",
        "description": "Short timestep (60s) to test numerical stability with fine temporal resolution",
        "edge_cases": []
      }
    }
  ],
  "notes": "Test data generation strategy:\n\n1. **Nominal cases (tests 1-3)**: Cover typical operational scenarios including single column without snow, winter conditions with snow layers, and multiple columns with varying conditions. Temperatures range from 265-301K, representing realistic seasonal variations.\n\n2. **Edge cases (tests 4-7)**: \n   - Zero heat flux with uniform temperature (equilibrium)\n   - Large negative heat flux (strong cooling)\n   - Temperatures near freezing point (273.15K) to test phase transition handling\n   - Minimal water content with high temperatures (arid conditions)\n\n3. **Special cases (tests 8-10)**:\n   - Maximum snow layers (5) with deep snowpack\n   - Shallow bedrock (layer 4) to test limited soil depth\n   - Short timestep (60s) for numerical stability testing\n\n**Physical constraints enforced**:\n- All temperatures > 0K (typically 200-350K range)\n- Layer thicknesses (dz) > 0\n- Depths (z, zi) >= 0\n- Snow layer count (snl) <= 0\n- Bedrock index (nbedrock) >= 1\n- Water contents >= 0\n- Snow fraction in [0, 1]\n- Soil saturation (watsat) in [0, 1]\n- Thermal conductivities > 0\n- Heat capacities > 0\n- Timestep > 0\n\n**Array dimension consistency**: Each test case maintains n_levtot = nlevsno + nlevgrnd, with proper indexing for snow layers (negative indices) and soil layers. Interface arrays (zi) have dimension n_levtot + 1.\n\n**Test coverage**: Cases span summer/winter conditions, various snow depths, different soil types (via thermal properties), multiple columns for spatial variability, and edge cases for numerical robustness."
}
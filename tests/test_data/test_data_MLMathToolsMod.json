{
  "function_name": "MLMathToolsMod",
  "test_cases": [
    {
      "name": "test_hybrid_root_finder_simple_quadratic",
      "function": "hybrid_root_finder",
      "inputs": {
        "func": "lambda x: x**2 - 4",
        "xa": [
          1.0,
          1.5,
          1.8
        ],
        "xb": [
          3.0,
          2.5,
          2.2
        ],
        "tol": 1e-06,
        "itmax": 40
      },
      "expected_output": {
        "root": [
          2.0,
          2.0,
          2.0
        ],
        "tolerance": 1e-05
      },
      "metadata": {
        "type": "nominal",
        "description": "Simple quadratic with known root at x=2, testing convergence from different initial brackets",
        "edge_cases": []
      }
    },
    {
      "name": "test_hybrid_root_finder_transcendental",
      "function": "hybrid_root_finder",
      "inputs": {
        "func": "lambda x: jnp.exp(x) - 3*x",
        "xa": [
          0.5,
          1.0,
          1.2
        ],
        "xb": [
          2.0,
          2.0,
          2.0
        ],
        "tol": 1e-07,
        "itmax": 50
      },
      "expected_output": {
        "root": [
          1.512134,
          1.512134,
          1.512134
        ],
        "tolerance": 1e-06
      },
      "metadata": {
        "type": "nominal",
        "description": "Transcendental equation testing hybrid method on non-polynomial function",
        "edge_cases": []
      }
    },
    {
      "name": "test_zbrent_polynomial_roots",
      "function": "zbrent",
      "inputs": {
        "func": "lambda x: (x - 1.5) * (x + 2.3)",
        "xa": [
          -3.0,
          0.0,
          -5.0
        ],
        "xb": [
          0.0,
          3.0,
          5.0
        ],
        "tol": 1e-08,
        "itmax": 50,
        "eps": 1e-08
      },
      "expected_output": {
        "root": [
          -2.3,
          1.5,
          -2.3
        ],
        "converged": [
          true,
          true,
          true
        ],
        "error": [
          false,
          false,
          false
        ],
        "tolerance": 1e-07
      },
      "metadata": {
        "type": "nominal",
        "description": "Brent's method on polynomial with two known roots, testing different brackets",
        "edge_cases": []
      }
    },
    {
      "name": "test_zbrent_edge_zero_crossing",
      "function": "zbrent",
      "inputs": {
        "func": "lambda x: x**3 - 0.001",
        "xa": [
          -1.0,
          0.0
        ],
        "xb": [
          0.0,
          1.0
        ],
        "tol": 1e-10,
        "itmax": 100,
        "eps": 1e-12
      },
      "expected_output": {
        "root": [
          0.1,
          0.1
        ],
        "converged": [
          true,
          true
        ],
        "error": [
          false,
          false
        ],
        "tolerance": 1e-09
      },
      "metadata": {
        "type": "edge",
        "description": "Root very close to zero, testing numerical precision near origin",
        "edge_cases": [
          "near_zero_root",
          "small_function_values"
        ]
      }
    },
    {
      "name": "test_zbrent_edge_bracketing_error",
      "function": "zbrent",
      "inputs": {
        "func": "lambda x: x**2 + 1",
        "xa": [
          -2.0,
          0.0
        ],
        "xb": [
          2.0,
          3.0
        ],
        "tol": 1e-06,
        "itmax": 50,
        "eps": 1e-08
      },
      "expected_output": {
        "root": [
          0.0,
          0.0
        ],
        "converged": [
          false,
          false
        ],
        "error": [
          true,
          true
        ],
        "tolerance": 1e-05
      },
      "metadata": {
        "type": "edge",
        "description": "Function with no real roots, testing error detection when bracket doesn't contain root",
        "edge_cases": [
          "no_root_in_bracket",
          "bracketing_failure"
        ]
      }
    },
    {
      "name": "test_quadratic_standard_cases",
      "function": "quadratic",
      "inputs": {
        "a": [
          1.0,
          2.0,
          -1.0,
          1.0
        ],
        "b": [
          0.0,
          -8.0,
          0.0,
          -3.0
        ],
        "c": [
          -4.0,
          15.0,
          -9.0,
          2.0
        ]
      },
      "expected_output": {
        "r1": [
          2.0,
          2.5,
          3.0,
          2.0
        ],
        "r2": [
          -2.0,
          1.5,
          -3.0,
          1.0
        ],
        "tolerance": 1e-10
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard quadratic equations with real roots, including positive and negative coefficients",
        "edge_cases": []
      }
    },
    {
      "name": "test_quadratic_edge_discriminant_zero",
      "function": "quadratic",
      "inputs": {
        "a": [
          1.0,
          4.0,
          9.0
        ],
        "b": [
          -4.0,
          -12.0,
          6.0
        ],
        "c": [
          4.0,
          9.0,
          1.0
        ]
      },
      "expected_output": {
        "r1": [
          2.0,
          1.5,
          -0.333333
        ],
        "r2": [
          2.0,
          1.5,
          -0.333333
        ],
        "tolerance": 1e-06
      },
      "metadata": {
        "type": "edge",
        "description": "Perfect square quadratics with discriminant = 0, testing repeated root case",
        "edge_cases": [
          "zero_discriminant",
          "repeated_roots"
        ]
      }
    },
    {
      "name": "test_tridiag_simple_system",
      "function": "tridiag",
      "inputs": {
        "a": [
          0.0,
          1.0,
          1.0,
          1.0
        ],
        "b": [
          2.0,
          2.0,
          2.0,
          2.0
        ],
        "c": [
          1.0,
          1.0,
          1.0,
          0.0
        ],
        "r": [
          5.0,
          6.0,
          6.0,
          5.0
        ]
      },
      "expected_output": {
        "solution": [
          2.0,
          1.0,
          1.0,
          2.0
        ],
        "tolerance": 1e-10
      },
      "metadata": {
        "type": "nominal",
        "description": "Simple symmetric tridiagonal system with known solution",
        "edge_cases": []
      }
    },
    {
      "name": "test_tridiag_edge_diagonal_dominant",
      "function": "tridiag",
      "inputs": {
        "a": [
          0.0,
          0.1,
          0.1
        ],
        "b": [
          10.0,
          10.0,
          10.0
        ],
        "c": [
          0.1,
          0.1,
          0.0
        ],
        "r": [
          10.1,
          10.2,
          10.1
        ]
      },
      "expected_output": {
        "solution": [
          1.0,
          1.0,
          1.0
        ],
        "tolerance": 1e-09
      },
      "metadata": {
        "type": "edge",
        "description": "Strongly diagonally dominant system, testing numerical stability",
        "edge_cases": [
          "diagonal_dominance",
          "well_conditioned"
        ]
      }
    },
    {
      "name": "test_tridiag_2eq_coupled_system",
      "function": "tridiag_2eq",
      "inputs": {
        "a1": [
          0.0,
          -0.5,
          -0.5,
          -0.5,
          -0.5
        ],
        "b11": [
          2.0,
          2.5,
          2.5,
          2.5,
          2.0
        ],
        "b12": [
          0.1,
          0.1,
          0.1,
          0.1,
          0.1
        ],
        "c1": [
          -0.5,
          -0.5,
          -0.5,
          -0.5,
          0.0
        ],
        "d1": [
          300.0,
          295.0,
          290.0,
          285.0,
          280.0
        ],
        "a2": [
          0.0,
          -0.3,
          -0.3,
          -0.3,
          -0.3
        ],
        "b21": [
          0.05,
          0.05,
          0.05,
          0.05,
          0.05
        ],
        "b22": [
          1.8,
          2.0,
          2.0,
          2.0,
          1.8
        ],
        "c2": [
          -0.3,
          -0.3,
          -0.3,
          -0.3,
          0.0
        ],
        "d2": [
          0.015,
          0.014,
          0.013,
          0.012,
          0.011
        ],
        "n": 5
      },
      "expected_output": {
        "t": [
          150.0,
          147.5,
          145.0,
          142.5,
          140.0
        ],
        "q": [
          0.0075,
          0.007,
          0.0065,
          0.006,
          0.0055
        ],
        "tolerance": 1e-06
      },
      "metadata": {
        "type": "nominal",
        "description": "Coupled temperature-vapor system typical of atmospheric boundary layer, testing realistic coupling",
        "edge_cases": []
      }
    },
    {
      "name": "test_log_gamma_function_standard_values",
      "function": "log_gamma_function",
      "inputs": {
        "x": [
          1.0,
          2.0,
          3.0,
          4.0,
          5.0,
          0.5,
          1.5
        ]
      },
      "expected_output": {
        "result": [
          0.0,
          0.0,
          0.693147,
          1.791759,
          3.178054,
          0.572365,
          -0.120782
        ],
        "tolerance": 1e-05
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard values of log-gamma function with known results, including half-integers",
        "edge_cases": []
      }
    },
    {
      "name": "test_log_gamma_function_edge_large_values",
      "function": "log_gamma_function",
      "inputs": {
        "x": [
          10.0,
          50.0,
          100.0,
          0.01,
          0.001
        ]
      },
      "expected_output": {
        "result": [
          12.801827,
          144.565744,
          359.134205,
          4.599479,
          6.907755
        ],
        "tolerance": 0.0001
      },
      "metadata": {
        "type": "edge",
        "description": "Large and very small positive values testing numerical stability at extremes",
        "edge_cases": [
          "large_argument",
          "near_zero_positive"
        ]
      }
    },
    {
      "name": "test_beta_function_symmetric_cases",
      "function": "beta_function",
      "inputs": {
        "a": [
          1.0,
          2.0,
          3.0,
          0.5,
          5.0
        ],
        "b": [
          1.0,
          2.0,
          3.0,
          0.5,
          5.0
        ]
      },
      "expected_output": {
        "result": [
          1.0,
          0.166667,
          0.033333,
          3.141593,
          0.001587
        ],
        "tolerance": 1e-05
      },
      "metadata": {
        "type": "nominal",
        "description": "Symmetric beta function cases B(a,a) with known analytical results",
        "edge_cases": []
      }
    },
    {
      "name": "test_beta_function_edge_asymmetric",
      "function": "beta_function",
      "inputs": {
        "a": [
          0.1,
          10.0,
          0.5,
          1.0
        ],
        "b": [
          10.0,
          0.1,
          2.0,
          100.0
        ]
      },
      "expected_output": {
        "result": [
          19.714639,
          19.714639,
          1.570796,
          0.01
        ],
        "tolerance": 0.0001
      },
      "metadata": {
        "type": "edge",
        "description": "Highly asymmetric beta function parameters testing numerical stability",
        "edge_cases": [
          "parameter_asymmetry",
          "extreme_ratios"
        ]
      }
    },
    {
      "name": "test_beta_distribution_pdf_uniform",
      "function": "beta_distribution_pdf",
      "inputs": {
        "a": 1.0,
        "b": 1.0,
        "x": [
          0.0,
          0.25,
          0.5,
          0.75,
          1.0
        ]
      },
      "expected_output": {
        "result": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "tolerance": 1e-10
      },
      "metadata": {
        "type": "nominal",
        "description": "Beta(1,1) is uniform distribution on [0,1], testing boundary behavior",
        "edge_cases": []
      }
    },
    {
      "name": "test_beta_distribution_pdf_edge_boundaries",
      "function": "beta_distribution_pdf",
      "inputs": {
        "a": [
          2.0,
          0.5,
          3.0
        ],
        "b": [
          5.0,
          0.5,
          2.0
        ],
        "x": [
          0.0,
          0.5,
          1.0
        ]
      },
      "expected_output": {
        "result": [
          0.0,
          0.63662,
          0.0
        ],
        "tolerance": 1e-05
      },
      "metadata": {
        "type": "edge",
        "description": "PDF evaluation at boundaries x=0 and x=1 with various shape parameters",
        "edge_cases": [
          "boundary_values",
          "zero_and_one"
        ]
      }
    },
    {
      "name": "test_beta_distribution_cdf_standard",
      "function": "beta_distribution_cdf",
      "inputs": {
        "a": 2.0,
        "b": 5.0,
        "x": 0.3
      },
      "expected_output": {
        "result": 0.47178,
        "tolerance": 0.0001
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard CDF evaluation for Beta(2,5) at x=0.3",
        "edge_cases": []
      }
    },
    {
      "name": "test_beta_distribution_cdf_edge_extremes",
      "function": "beta_distribution_cdf",
      "inputs": {
        "a": 0.5,
        "b": 0.5,
        "x": 0.5
      },
      "expected_output": {
        "result": 0.5,
        "tolerance": 1e-08
      },
      "metadata": {
        "type": "edge",
        "description": "Symmetric beta distribution at midpoint, testing symmetry property",
        "edge_cases": [
          "symmetry",
          "midpoint_evaluation"
        ]
      }
    },
    {
      "name": "test_beta_function_incomplete_cf_convergence",
      "function": "beta_function_incomplete_cf",
      "inputs": {
        "a": [
          2.0,
          3.0,
          5.0
        ],
        "b": [
          3.0,
          4.0,
          2.0
        ],
        "x": [
          0.3,
          0.5,
          0.7
        ]
      },
      "expected_output": {
        "result": [
          0.216,
          0.5,
          0.969
        ],
        "tolerance": 0.001
      },
      "metadata": {
        "type": "nominal",
        "description": "Continued fraction evaluation at various points testing convergence",
        "edge_cases": []
      }
    },
    {
      "name": "test_beta_function_incomplete_cf_edge_near_boundaries",
      "function": "beta_function_incomplete_cf",
      "inputs": {
        "a": [
          1.0,
          10.0,
          0.5
        ],
        "b": [
          1.0,
          10.0,
          0.5
        ],
        "x": [
          0.01,
          0.99,
          0.5
        ]
      },
      "expected_output": {
        "result": [
          0.01,
          0.99,
          0.5
        ],
        "tolerance": 0.0001
      },
      "metadata": {
        "type": "edge",
        "description": "Continued fraction near boundaries x\u21920 and x\u21921, testing numerical stability",
        "edge_cases": [
          "near_zero",
          "near_one",
          "boundary_convergence"
        ]
      }
    }
  ],
  "notes": "Test data generation methodology:\n\n1. **Root Finding Functions (hybrid_root_finder, zbrent):**\n   - Used well-known functions with analytical roots (polynomials, transcendentals)\n   - Tested bracketing conditions and convergence from various initial guesses\n   - Included edge cases: roots near zero, no roots (error detection), tight tolerances\n   - Array sizes: 2-3 points for vectorized operations\n\n2. **Quadratic Solver:**\n   - Standard cases with real roots (positive/negative discriminants)\n   - Edge case: discriminant = 0 (repeated roots)\n   - Verified using quadratic formula: r = (-b \u00b1 \u221a(b\u00b2-4ac)) / 2a\n\n3. **Tridiagonal Solvers (tridiag, tridiag_2eq):**\n   - Simple symmetric systems with known solutions\n   - Diagonally dominant matrices for numerical stability\n   - Coupled system mimics atmospheric T-q equations with realistic coefficients\n   - System sizes: 3-5 layers typical for testing\n\n4. **Special Functions (log_gamma, beta):**\n   - Used known values: \u0393(n) = (n-1)! for integers, \u0393(1/2) = \u221a\u03c0\n   - Tested symmetry properties: B(a,b) = B(b,a)\n   - Edge cases: very small (0.001) and large (100) arguments\n   - Beta distribution: uniform case Beta(1,1), boundary behavior\n\n5. **Physical Realism:**\n   - All positive arguments for gamma/beta functions (mathematical requirement)\n   - Temperature-like values in reasonable ranges (280-300K)\n   - Vapor fractions in [0,1] as mole fractions\n   - Tolerances appropriate for scientific computing (1e-6 to 1e-10)\n\n6. **Array Dimensions:**\n   - Scalar and small arrays (2-5 elements) for clarity\n   - Consistent shapes within each test case\n   - Broadcasting-compatible where applicable\n\n7. **Expected Outputs:**\n   - Calculated using analytical solutions or high-precision numerical methods\n   - Tolerances set based on typical JAX float32/float64 precision\n   - Convergence flags and error states explicitly tested\n\nAll test cases are designed to be executable with JAX/NumPy and follow pytest parametrization patterns."
}
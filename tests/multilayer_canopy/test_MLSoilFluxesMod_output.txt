============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-9.0.2, pluggy-1.6.0 -- /burg-archive/home/mck2199/clm-ml-jax/jax-agents/.venv/bin/python3
cachedir: .pytest_cache
rootdir: /burg-archive/home/mck2199/clm-ml-jax
configfile: pytest.ini
plugins: cov-7.0.0, anyio-4.12.0
collecting ... collected 47 items

../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestInputValidation::test_temperature_positivity PASSED [  2%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestInputValidation::test_pressure_positivity PASSED [  4%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestInputValidation::test_relative_humidity_bounds PASSED [  6%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestInputValidation::test_conductance_positivity PASSED [  8%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestInputValidation::test_array_dimensions PASSED [ 10%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestOutputShapesAndTypes::test_output_shapes[test_nominal_daytime_conditions] PASSED [ 12%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestOutputShapesAndTypes::test_output_shapes[test_nominal_nighttime_cooling] PASSED [ 14%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestOutputShapesAndTypes::test_output_shapes[test_nominal_cold_winter_conditions] PASSED [ 17%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestOutputShapesAndTypes::test_output_shapes[test_nominal_hot_arid_conditions] PASSED [ 19%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestOutputShapesAndTypes::test_output_shapes[test_nominal_tropical_humid] PASSED [ 21%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestOutputShapesAndTypes::test_output_shapes[test_edge_zero_net_radiation] PASSED [ 23%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestOutputShapesAndTypes::test_output_shapes[test_edge_extreme_humidity_bounds] PASSED [ 25%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestOutputShapesAndTypes::test_output_shapes[test_edge_minimal_conductances] PASSED [ 27%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestOutputShapesAndTypes::test_output_shapes[test_edge_extreme_temperature_gradient] PASSED [ 29%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestOutputShapesAndTypes::test_output_shapes[test_special_single_layer_canopy] PASSED [ 31%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestOutputShapesAndTypes::test_output_dtypes[test_nominal_daytime_conditions] PASSED [ 34%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestOutputShapesAndTypes::test_output_dtypes[test_edge_extreme_humidity_bounds] PASSED [ 36%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestOutputShapesAndTypes::test_output_dtypes[test_special_single_layer_canopy] PASSED [ 38%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestPhysicalConstraints::test_temperature_output_positivity[test_nominal_daytime_conditions] PASSED [ 40%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestPhysicalConstraints::test_temperature_output_positivity[test_nominal_nighttime_cooling] PASSED [ 42%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestPhysicalConstraints::test_temperature_output_positivity[test_nominal_cold_winter_conditions] PASSED [ 44%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestPhysicalConstraints::test_temperature_output_positivity[test_nominal_hot_arid_conditions] PASSED [ 46%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestPhysicalConstraints::test_temperature_output_positivity[test_nominal_tropical_humid] PASSED [ 48%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestPhysicalConstraints::test_vapor_pressure_positivity[test_nominal_daytime_conditions] PASSED [ 51%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestPhysicalConstraints::test_vapor_pressure_positivity[test_nominal_nighttime_cooling] PASSED [ 53%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestPhysicalConstraints::test_vapor_pressure_positivity[test_edge_extreme_humidity_bounds] PASSED [ 55%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestPhysicalConstraints::test_energy_balance_closure[test_nominal_daytime_conditions] PASSED [ 57%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestPhysicalConstraints::test_energy_balance_closure[test_nominal_nighttime_cooling] PASSED [ 59%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestPhysicalConstraints::test_energy_balance_closure[test_nominal_cold_winter_conditions] PASSED [ 61%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestPhysicalConstraints::test_flux_sign_conventions[test_nominal_daytime_conditions] PASSED [ 63%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestPhysicalConstraints::test_flux_sign_conventions[test_nominal_hot_arid_conditions] PASSED [ 65%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestEdgeCases::test_zero_net_radiation PASSED [ 68%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestEdgeCases::test_extreme_humidity_bounds PASSED [ 70%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestEdgeCases::test_minimal_conductances PASSED [ 72%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestEdgeCases::test_extreme_temperature_gradients PASSED [ 74%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestSpecialCases::test_single_layer_canopy PASSED [ 76%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestSpecialCases::test_multiple_patches_consistency PASSED [ 78%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestNominalBehavior::test_daytime_heating PASSED [ 80%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestNominalBehavior::test_nighttime_cooling PASSED [ 82%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestNominalBehavior::test_cold_winter_conditions PASSED [ 85%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestNominalBehavior::test_hot_arid_conditions PASSED [ 87%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestNominalBehavior::test_tropical_humid_conditions PASSED [ 89%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestIntegration::test_energy_conservation_across_conditions FAILED [ 91%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestIntegration::test_consistency_across_patch_sizes PASSED [ 93%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestDocumentation::test_function_has_docstring PASSED [ 95%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestDocumentation::test_namedtuple_fields PASSED [ 97%]
../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestSummaryStatistics::test_output_ranges_reasonable PASSED [100%]/burg-archive/home/mck2199/clm-ml-jax/jax-agents/.venv/lib64/python3.11/site-packages/coverage/control.py:957: CoverageWarning: No data was collected. (no-data-collected); see https://coverage.readthedocs.io/en/7.13.0/messages.html#warning-no-data-collected
  self._warn("No data was collected.", slug="no-data-collected")


=================================== FAILURES ===================================
__________ TestIntegration.test_energy_conservation_across_conditions __________
../tests/multilayer_canopy/test_MLSoilFluxesMod.py:917: in test_energy_conservation_across_conditions
    assert relative_error < 0.5, \
E   AssertionError: test_nominal_daytime_conditions: Energy balance residual too large (relative error: 0.6525911688804626)
E   assert Array(0.65259117, dtype=float32) < 0.5
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.11.13-final-0 _______________

Name                                                Stmts   Miss  Cover   Missing
---------------------------------------------------------------------------------
src/jax_agents/__init__.py                              6      6     0%   7-14
src/jax_agents/base_agent.py                          114    114     0%   7-386
src/jax_agents/prompts/__init__.py                      3      3     0%   3-6
src/jax_agents/prompts/repair_prompts.py                1      1     0%   11
src/jax_agents/prompts/test_prompts_simplified.py       1      1     0%   8
src/jax_agents/prompts/translation_prompts_v2.py        1      1     0%   3
src/jax_agents/repair_agent.py                        169    169     0%   13-453
src/jax_agents/test_agent.py                          133    133     0%   11-335
src/jax_agents/translator.py                          277    277     0%   8-891
src/jax_agents/utils/__init__.py                        2      2     0%   3-5
src/jax_agents/utils/config_loader.py                  21     21     0%   3-69
---------------------------------------------------------------------------------
TOTAL                                                 728    728     0%
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED ../tests/multilayer_canopy/test_MLSoilFluxesMod.py::TestIntegration::test_energy_conservation_across_conditions - AssertionError: test_nominal_daytime_conditions: Energy balance residual too large (relative error: 0.6525911688804626)
assert Array(0.65259117, dtype=float32) < 0.5
========================= 1 failed, 46 passed in 4.73s =========================

============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-9.0.2, pluggy-1.6.0 -- /burg-archive/home/mck2199/clm-ml-jax/jax-agents/.venv/bin/python3
cachedir: .pytest_cache
rootdir: /burg-archive/home/mck2199/clm-ml-jax
configfile: pytest.ini
plugins: cov-7.0.0, anyio-4.12.0
collecting ... collected 29 items

../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestBetaDistributionCDF::test_beta_cdf_shapes[2.0-2.0-x_vals0-symmetric] PASSED [  3%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestBetaDistributionCDF::test_beta_cdf_shapes[1.0-1.0-x_vals1-uniform] PASSED [  6%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestBetaDistributionCDF::test_beta_cdf_shapes[0.5-5.0-x_vals2-skewed] PASSED [ 10%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestBetaDistributionCDF::test_beta_cdf_monotonicity[2.0-2.0-x_vals0-symmetric] FAILED [ 13%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestBetaDistributionCDF::test_beta_cdf_monotonicity[1.0-1.0-x_vals1-uniform] FAILED [ 17%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestBetaDistributionCDF::test_beta_cdf_boundary_values PASSED [ 20%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestBetaDistributionCDF::test_beta_cdf_dtypes PASSED [ 24%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestBetaDistributionCDF::test_beta_cdf_uniform_special_case PASSED [ 27%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestCalculateVerticalStructure::test_vertical_structure_shapes[ztop0-zref0-50] PASSED [ 31%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestCalculateVerticalStructure::test_vertical_structure_shapes[ztop1-zref1-50] PASSED [ 34%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestCalculateVerticalStructure::test_vertical_structure_shapes[ztop2-zref2-50] PASSED [ 37%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestCalculateVerticalStructure::test_vertical_structure_layer_counts PASSED [ 41%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestCalculateVerticalStructure::test_vertical_structure_height_ordering PASSED [ 44%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestCalculateVerticalStructure::test_vertical_structure_dtypes PASSED [ 48%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestCalculateLayerProperties::test_layer_properties_shapes PASSED [ 51%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestCalculateLayerProperties::test_layer_properties_conservation PASSED [ 55%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestCalculateLayerProperties::test_layer_properties_zero_lai PASSED [ 58%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestRedistributePlantArea::test_redistribute_shapes PASSED [ 62%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestRedistributePlantArea::test_redistribute_conservation PASSED [ 65%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestRedistributePlantArea::test_redistribute_thin_layers PASSED [ 68%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestFinalizeVerticalStructure::test_finalize_shapes PASSED [ 72%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestFinalizeVerticalStructure::test_finalize_fractional_profiles PASSED [ 75%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestFinalizeVerticalStructure::test_finalize_single_layer PASSED [ 79%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestInitVerticalStructure::test_init_vertical_structure_complete PASSED [ 82%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestInitVerticalStructure::test_init_vertical_structure_dtypes PASSED [ 86%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestInitVerticalProfiles::test_init_profiles_shapes PASSED [ 89%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestInitVerticalProfiles::test_init_profiles_physical_validity PASSED [ 93%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestInitVerticalProfiles::test_init_profiles_extreme_conditions PASSED [ 96%]
../tests/multilayer_canopy/test_MLinitVerticalMod.py::test_module_documentation PASSED [100%]/burg-archive/home/mck2199/clm-ml-jax/jax-agents/.venv/lib64/python3.11/site-packages/coverage/control.py:957: CoverageWarning: No data was collected. (no-data-collected); see https://coverage.readthedocs.io/en/7.13.0/messages.html#warning-no-data-collected
  self._warn("No data was collected.", slug="no-data-collected")


=================================== FAILURES ===================================
_ TestBetaDistributionCDF.test_beta_cdf_monotonicity[2.0-2.0-x_vals0-symmetric] _
../tests/multilayer_canopy/test_MLinitVerticalMod.py:251: in test_beta_cdf_monotonicity
    assert jnp.all(diffs >= -1e-10), (
E   AssertionError: CDF is not monotonically increasing for symmetric case. Found negative differences: [-0.02734375 -0.03515625]
E   assert Array(False, dtype=bool)
E    +  where Array(False, dtype=bool) = <function all at 0x1554f6695800>(Array([[ 0.03515625,  0.02734375, -0.02734375, -0.03515625]], dtype=float32) >= -1e-10)
E    +    where <function all at 0x1554f6695800> = jnp.all
_ TestBetaDistributionCDF.test_beta_cdf_monotonicity[1.0-1.0-x_vals1-uniform] __
../tests/multilayer_canopy/test_MLinitVerticalMod.py:251: in test_beta_cdf_monotonicity
    assert jnp.all(diffs >= -1e-10), (
E   AssertionError: CDF is not monotonically increasing for uniform case. Found negative differences: [-0.15999998 -0.09000002]
E   assert Array(False, dtype=bool)
E    +  where Array(False, dtype=bool) = <function all at 0x1554f6695800>(Array([[ 0.09      ,  0.16      , -0.15999998, -0.09000002]], dtype=float32) >= -1e-10)
E    +    where <function all at 0x1554f6695800> = jnp.all
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.11.13-final-0 _______________

Name                                                Stmts   Miss  Cover   Missing
---------------------------------------------------------------------------------
src/jax_agents/__init__.py                              6      6     0%   7-14
src/jax_agents/base_agent.py                          114    114     0%   7-386
src/jax_agents/prompts/__init__.py                      3      3     0%   3-6
src/jax_agents/prompts/repair_prompts.py                1      1     0%   11
src/jax_agents/prompts/test_prompts_simplified.py       1      1     0%   8
src/jax_agents/prompts/translation_prompts_v2.py        1      1     0%   3
src/jax_agents/repair_agent.py                        169    169     0%   13-453
src/jax_agents/test_agent.py                          133    133     0%   11-335
src/jax_agents/translator.py                          277    277     0%   8-891
src/jax_agents/utils/__init__.py                        2      2     0%   3-5
src/jax_agents/utils/config_loader.py                  21     21     0%   3-69
---------------------------------------------------------------------------------
TOTAL                                                 728    728     0%
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED ../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestBetaDistributionCDF::test_beta_cdf_monotonicity[2.0-2.0-x_vals0-symmetric] - AssertionError: CDF is not monotonically increasing for symmetric case. Found negative differences: [-0.02734375 -0.03515625]
assert Array(False, dtype=bool)
 +  where Array(False, dtype=bool) = <function all at 0x1554f6695800>(Array([[ 0.03515625,  0.02734375, -0.02734375, -0.03515625]], dtype=float32) >= -1e-10)
 +    where <function all at 0x1554f6695800> = jnp.all
FAILED ../tests/multilayer_canopy/test_MLinitVerticalMod.py::TestBetaDistributionCDF::test_beta_cdf_monotonicity[1.0-1.0-x_vals1-uniform] - AssertionError: CDF is not monotonically increasing for uniform case. Found negative differences: [-0.15999998 -0.09000002]
assert Array(False, dtype=bool)
 +  where Array(False, dtype=bool) = <function all at 0x1554f6695800>(Array([[ 0.09      ,  0.16      , -0.15999998, -0.09000002]], dtype=float32) >= -1e-10)
 +    where <function all at 0x1554f6695800> = jnp.all
========================= 2 failed, 27 passed in 4.67s =========================

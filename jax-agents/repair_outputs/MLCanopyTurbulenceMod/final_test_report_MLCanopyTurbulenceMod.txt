STDOUT:
============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-9.0.2, pluggy-1.6.0 -- /burg-archive/home/mck2199/clm-ml-jax/jax-agents/.venv/bin/python3
cachedir: .pytest_cache
rootdir: /burg-archive/home/mck2199/clm-ml-jax
configfile: pytest.ini
plugins: cov-7.0.0, anyio-4.12.0
collecting ... collected 44 items

../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPhimMoninObukhov::test_phim_neutral_conditions PASSED [  2%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPhimMoninObukhov::test_phim_stable_unstable_range PASSED [  4%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPhimMoninObukhov::test_phim_dtype PASSED [  6%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPhimMoninObukhov::test_phim_scalar_inputs[-10.0] PASSED [  9%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPhimMoninObukhov::test_phim_scalar_inputs[-1.0] PASSED [ 11%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPhimMoninObukhov::test_phim_scalar_inputs[0.0] PASSED [ 13%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPhimMoninObukhov::test_phim_scalar_inputs[1.0] PASSED [ 15%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPhimMoninObukhov::test_phim_scalar_inputs[10.0] PASSED [ 18%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPhicMoninObukhov::test_phic_range PASSED [ 20%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPhicMoninObukhov::test_phic_vs_phim PASSED [ 22%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPhicMoninObukhov::test_phic_neutral PASSED [ 25%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPsimMoninObukhov::test_psim_edge_cases PASSED [ 27%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPsimMoninObukhov::test_psim_monotonicity PASSED [ 29%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPsimMoninObukhov::test_psim_sign_convention PASSED [ 31%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPsicMoninObukhov::test_psic_edge_cases PASSED [ 34%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestPsicMoninObukhov::test_psic_vs_psim_magnitude PASSED [ 36%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestGetPrsc::test_prsc_neutral_stable_unstable PASSED [ 38%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestGetPrsc::test_prsc_parameter_sensitivity PASSED [ 40%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestGetBeta::test_beta_boundary_conditions PASSED [ 43%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestGetBeta::test_beta_stability_dependence[-1.0] PASSED [ 45%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestGetBeta::test_beta_stability_dependence[-0.5] PASSED [ 47%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestGetBeta::test_beta_stability_dependence[0.0] PASSED [ 50%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestGetBeta::test_beta_stability_dependence[0.5] PASSED [ 52%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestGetBeta::test_beta_stability_dependence[1.0] PASSED [ 54%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestLookupPsihat::test_lookup_psihat_interpolation PASSED [ 56%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestLookupPsihat::test_lookup_psihat_grid_boundaries PASSED [ 59%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestGetPsiRSL::test_psi_rsl_typical_canopy PASSED [ 61%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestGetPsiRSL::test_psi_rsl_physical_constraints PASSED [ 63%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestObuFunc::test_obu_func_edge_cases PASSED [ 65%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestObuFunc::test_obu_func_temperature_constraints PASSED [ 68%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestCanopyTurbulence::test_canopy_turbulence_multiple_patches PASSED [ 70%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestCanopyTurbulence::test_canopy_turbulence_filter_indices PASSED [ 72%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestCanopyTurbulence::test_canopy_turbulence_turb_type PASSED [ 75%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestInitializeRSLTables::test_initialize_rsl_tables_structure PASSED [ 77%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestInitializeRSLTables::test_initialize_rsl_tables_grid_ordering PASSED [ 79%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestIntegration::test_stability_function_consistency FAILED [ 81%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestIntegration::test_momentum_scalar_function_ordering PASSED [ 84%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestIntegration::test_neutral_limit_all_functions PASSED [ 86%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestProperties::test_phi_positivity[zeta0] PASSED [ 88%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestProperties::test_psi_finiteness[zeta0] PASSED [ 90%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestProperties::test_array_broadcasting PASSED [ 93%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestEdgeCases::test_extreme_stability_values PASSED [ 95%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestEdgeCases::test_near_zero_values PASSED [ 97%]
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestEdgeCases::test_nan_inf_handling PASSED [100%]

=================================== FAILURES ===================================
_____________ TestIntegration.test_stability_function_consistency ______________
../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py:1055: in test_stability_function_consistency
    assert jnp.allclose(dpsi_dzeta, expected, atol=0.1, rtol=0.1), \
E   AssertionError: Relationship d(psi)/d(zeta) = 1 - phi should hold approximately
E   assert Array(False, dtype=bool)
E    +  where Array(False, dtype=bool) = <PjitFunction of <function allclose at 0x1554f6ed9440>>(Array([-0.29513928, -0.29903346, -0.30704182, -0.3155175 , -0.3245072 ,\n       -0.3340557 , -0.3442195 , -0.35506088, -0.36665577, -0.37908205,\n       -0.392442  , -0.40684655, -0.42242128, -0.43932685, -0.4577463 ,\n       -0.47789764, -0.50004476, -0.52451575, -0.5517068 , -0.5821164 ,\n       -0.6163832 , -0.6553181 , -0.6999852 , -0.7518234 , -0.8127994 ,\n       -0.8857012 , -0.97463727, -1.0859201 , -1.2298788 , -1.424821  ,\n       -1.7071699 , -2.1642008 , -3.1847737 , -4.458745  , -5.000001  ,\n       -5.0000057 , -5.0000057 , -5.000001  , -5.        , -4.999999  ,\n       -4.999999  , -5.0000076 , -5.0000076 , -5.        , -5.        ,\n       -5.        , -5.        , -5.0000076 , -5.0000076 , -5.        ],      dtype=float32), Array([ 0.58277386,  0.5796188 ,  0.57634073,  0.5729307 ,  0.5693789 ,\n        0.5656743 ,  0.56180465,  0.5577562 ,  0.5535136 ,  0.5490593 ,\n        0.5443736 ,  0.53943384,  0.53421414,  0.5286845 ,  0.52281034,\n        0.5165508 ,  0.5098578 ,  0.50267434,  0.49493152,  0.48654574,\n        0.47741413,  0.46740794,  0.45636386,  0.44407052,  0.43024808,\n        0.41451603,  0.39633995,  0.3749385 ,  0.34910887,  0.3168699 ,\n        0.2746365 ,  0.21494228,  0.118083  , -0.10204053, -0.40816283,\n       -0.71428525, -1.0204082 , -1.3265305 , -1.6326528 , -1.9387751 ,\n       -2.2448974 , -2.5510197 , -2.857143  , -3.1632652 , -3.4693875 ,\n       -3.7755098 , -4.081632  , -4.3877544 , -4.6938777 , -5.        ],      dtype=float32), atol=0.1, rtol=0.1)
E    +    where <PjitFunction of <function allclose at 0x1554f6ed9440>> = jnp.allclose
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.11.13-final-0 _______________

Name                                                Stmts   Miss  Cover   Missing
---------------------------------------------------------------------------------
src/jax_agents/__init__.py                              6      6     0%   7-14
src/jax_agents/base_agent.py                          114    114     0%   7-386
src/jax_agents/prompts/__init__.py                      3      3     0%   3-6
src/jax_agents/prompts/repair_prompts.py                1      1     0%   11
src/jax_agents/prompts/test_prompts_simplified.py       1      1     0%   8
src/jax_agents/prompts/translation_prompts_v2.py        1      1     0%   3
src/jax_agents/repair_agent.py                        169    169     0%   13-453
src/jax_agents/test_agent.py                          133    133     0%   11-335
src/jax_agents/translator.py                          277    277     0%   8-891
src/jax_agents/utils/__init__.py                        2      2     0%   3-5
src/jax_agents/utils/config_loader.py                  21     21     0%   3-69
---------------------------------------------------------------------------------
TOTAL                                                 728    728     0%
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED ../tests/multilayer_canopy/test_MLCanopyTurbulenceMod.py::TestIntegration::test_stability_function_consistency - AssertionError: Relationship d(psi)/d(zeta) = 1 - phi should hold approximately
assert Array(False, dtype=bool)
 +  where Array(False, dtype=bool) = <PjitFunction of <function allclose at 0x1554f6ed9440>>(Array([-0.29513928, -0.29903346, -0.30704182, -0.3155175 , -0.3245072 ,\n       -0.3340557 , -0.3442195 , -0.35506088, -0.36665577, -0.37908205,\n       -0.392442  , -0.40684655, -0.42242128, -0.43932685, -0.4577463 ,\n       -0.47789764, -0.50004476, -0.52451575, -0.5517068 , -0.5821164 ,\n       -0.6163832 , -0.6553181 , -0.6999852 , -0.7518234 , -0.8127994 ,\n       -0.8857012 , -0.97463727, -1.0859201 , -1.2298788 , -1.424821  ,\n       -1.7071699 , -2.1642008 , -3.1847737 , -4.458745  , -5.000001  ,\n       -5.0000057 , -5.0000057 , -5.000001  , -5.        , -4.999999  ,\n       -4.999999  , -5.0000076 , -5.0000076 , -5.        , -5.        ,\n       -5.        , -5.        , -5.0000076 , -5.0000076 , -5.        ],      dtype=float32), Array([ 0.58277386,  0.5796188 ,  0.57634073,  0.5729307 ,  0.5693789 ,\n        0.5656743 ,  0.56180465,  0.5577562 ,  0.5535136 ,  0.5490593 ,\n        0.5443736 ,  0.53943384,  0.53421414,  0.5286845 ,  0.52281034,\n        0.5165508 ,  0.5098578 ,  0.50267434,  0.49493152,  0.48654574,\n        0.47741413,  0.46740794,  0.45636386,  0.44407052,  0.43024808,\n        0.41451603,  0.39633995,  0.3749385 ,  0.34910887,  0.3168699 ,\n        0.2746365 ,  0.21494228,  0.118083  , -0.10204053, -0.40816283,\n       -0.71428525, -1.0204082 , -1.3265305 , -1.6326528 , -1.9387751 ,\n       -2.2448974 , -2.5510197 , -2.857143  , -3.1632652 , -3.4693875 ,\n       -3.7755098 , -4.081632  , -4.3877544 , -4.6938777 , -5.        ],      dtype=float32), atol=0.1, rtol=0.1)
 +    where <PjitFunction of <function allclose at 0x1554f6ed9440>> = jnp.allclose
========================= 1 failed, 43 passed in 6.49s =========================


STDERR:
/burg-archive/home/mck2199/clm-ml-jax/jax-agents/.venv/lib64/python3.11/site-packages/coverage/control.py:957: CoverageWarning: No data was collected. (no-data-collected); see https://coverage.readthedocs.io/en/7.13.0/messages.html#warning-no-data-collected
  self._warn("No data was collected.", slug="no-data-collected")
